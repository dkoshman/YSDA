FIT Profiler Report
Profile stats for: configure_callbacks
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 lightning.py:1199(configure_callbacks)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)



Profile stats for: prepare_data
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:325(prepare_data)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_before_accelerator_backend_setup
         27 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:35(on_before_accelerator_backend_setup)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:63(on_before_accelerator_backend_setup)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)



Profile stats for: setup
         23 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:45(setup)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 base.py:67(setup)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:373(setup)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_sharded_model
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:298(configure_sharded_model)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_configure_sharded_model
         27 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:40(on_configure_sharded_model)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 base.py:60(on_configure_sharded_model)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_optimizers
         140 function calls (138 primitive calls) in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 <ipython-input-27-c9e80d243a57>:35(configure_optimizers)
        1    0.000    0.000    0.000    0.000 adam.py:60(__init__)
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
        6    0.000    0.000    0.000    0.000 module.py:1499(parameters)
        1    0.000    0.000    0.000    0.000 optimizer.py:232(add_param_group)
        6    0.000    0.000    0.000    0.000 module.py:1523(named_parameters)
        6    0.000    0.000    0.000    0.000 module.py:1486(_named_members)
       20    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 optimizer.py:78(_hook_for_profile)
      5/3    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        7    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       20    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        2    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_pretrain_routine_start
         26 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:145(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:64(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 base.py:238(on_pretrain_routine_start)



Profile stats for: on_pretrain_routine_end
         26 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:150(on_pretrain_routine_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:73(on_pretrain_routine_end)
        1    0.000    0.000    0.000    0.000 base.py:242(on_pretrain_routine_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:620(on_train_dataloader)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: train_dataloader
         70 function calls (66 primitive calls) in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 <ipython-input-27-c9e80d243a57>:27(train_dataloader)
        1    0.000    0.000    0.000    0.000 <ipython-input-25-7c502df9f0ea>:5(__init__)
        1    0.000    0.000    0.000    0.000 dataloader.py:162(__init__)
        1    0.000    0.000    0.000    0.000 _tensor.py:25(wrapped)
        1    0.000    0.000    0.000    0.000 {built-in method tensor}
        1    0.000    0.000    0.000    0.000 {method 'prod' of 'torch._C._TensorBase' objects}
      4/1    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 typing.py:1156(__instancecheck__)
    19/18    0.000    0.000    0.000    0.000 dataloader.py:336(__setattr__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
        1    0.000    0.000    0.000    0.000 typing.py:1145(__subclasscheck__)
        2    0.000    0.000    0.000    0.000 typing.py:1227(__new__)
        1    0.000    0.000    0.000    0.000 {method 'round' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 abc.py:196(__subclasscheck__)
        1    0.000    0.000    0.000    0.000 {method 'int' of 'torch._C._TensorBase' objects}
        2    0.000    0.000    0.000    0.000 typing.py:1180(_generic_new)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C.set_vital}
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 <ipython-input-24-45860f993673>:18(shape)
        1    0.000    0.000    0.000    0.000 dataloader.py:311(multiprocessing_context)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 typing.py:1033(_abc_negative_cache_version)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
        1    0.000    0.000    0.000    0.000 dataloader.py:406(check_worker_number_rationality)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
        1    0.000    0.000    0.000    0.000 base.py:80(get_shape)
        1    0.000    0.000    0.000    0.000 typing.py:1089(__eq__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 dataloader.py:361(_auto_collation)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 typing.py:1019(_abc_negative_cache)



Profile stats for: on_train_start
         34 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:135(on_train_start)
        1    0.000    0.000    0.000    0.000 gpu.py:48(on_train_start)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 memory.py:102(empty_cache)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_emptyCache}
        1    0.000    0.000    0.000    0.000 accelerator.py:571(on_train_start)
        1    0.000    0.000    0.000    0.000 __init__.py:146(is_initialized)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:331(on_train_start)
        3    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:40(on_train_start)
        1    0.000    0.000    0.000    0.000 base.py:230(on_train_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)



Profile stats for: run_training_epoch
         46 function calls in 6.433 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    6.433    6.433 base.py:109(run)
        1    0.000    0.000    6.433    6.433 training_epoch_loop.py:133(on_run_start)
        1    0.000    0.000    6.433    6.433 trainer.py:1481(call_hook)
        1    0.000    0.000    6.433    6.433 contextlib.py:79(__enter__)
        1    0.000    0.000    6.433    6.433 {built-in method builtins.next}
        1    0.000    0.000    6.433    6.433 base.py:68(profile)
        1    0.000    0.000    6.433    6.433 advanced.py:61(start)
        1    6.433    6.433    6.433    6.433 {method 'enable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 training_epoch_loop.py:118(reset)
        4    0.000    0.000    0.000    0.000 progress.py:154(reset_on_run)
        1    0.000    0.000    0.000    0.000 progress.py:194(reset_on_run)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 progress.py:101(reset)
        1    0.000    0.000    0.000    0.000 progress.py:263(reset_on_run)
        4    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
        2    0.000    0.000    0.000    0.000 progress.py:77(reset)
        1    0.000    0.000    0.000    0.000 progress.py:230(reset_on_run)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
        1    0.000    0.000    0.000    0.000 contextlib.py:157(helper)
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 base.py:54(trainer)
        1    0.000    0.000    0.000    0.000 base.py:84(skip)
        4    0.000    0.000    0.000    0.000 progress.py:49(reset)
        1    0.000    0.000    0.000    0.000 logger_connector.py:258(on_epoch_start)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)



Profile stats for: on_epoch_start
         26 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:125(on_epoch_start)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 hooks.py:184(on_epoch_start)
        1    0.000    0.000    0.000    0.000 base.py:160(on_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)



Profile stats for: on_train_epoch_start
         26 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:85(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 base.py:122(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:190(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: get_train_batch
         4221 function calls (3819 primitive calls) in 1.468 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  603/402    0.000    0.000    1.467    0.004 contextlib.py:79(__enter__)
  603/402    0.000    0.000    1.467    0.004 {built-in method builtins.next}
      201    0.000    0.000    1.467    0.007 fetching.py:287(apply_profiler)
      201    0.000    0.000    1.466    0.007 base.py:68(profile)
      201    0.000    0.000    1.466    0.007 advanced.py:61(start)
      201    1.466    0.007    1.466    0.007 {method 'enable' of '_lsprof.Profiler' objects}
      603    0.000    0.000    0.001    0.000 contextlib.py:157(helper)
      603    0.001    0.000    0.001    0.000 contextlib.py:59(__init__)
      603    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      201    0.000    0.000    0.000    0.000 fetching.py:238(fetching_context)
      201    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)



Profile stats for: fetch_next_train_batch
         197685 function calls (194469 primitive calls) in 1.463 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
 1005/402    0.001    0.000    1.463    0.004 {built-in method builtins.next}
      201    0.000    0.000    1.462    0.007 supporters.py:544(__next__)
      201    0.000    0.000    1.462    0.007 supporters.py:552(request_next_batch)
      201    0.000    0.000    1.461    0.007 apply_func.py:70(apply_to_collection)
      201    0.002    0.000    1.460    0.007 dataloader.py:517(__next__)
      201    0.000    0.000    1.448    0.007 dataloader.py:559(_next_data)
      201    0.001    0.000    1.408    0.007 fetch.py:47(fetch)
      201    0.002    0.000    1.393    0.007 <ipython-input-24-45860f993673>:33(__getitem__)
      402    0.007    0.000    1.391    0.003 <ipython-input-24-45860f993673>:22(to_sparse_tensor)
      804    0.003    0.000    1.210    0.002 _index.py:32(__getitem__)
      402    0.001    0.000    0.804    0.002 csr.py:328(_get_arrayXslice)
      402    0.075    0.000    0.800    0.002 compressed.py:675(_major_index_fancy)
      402    0.411    0.001    0.411    0.001 {built-in method scipy.sparse._sparsetools.csr_row_index}
7638/7236    0.012    0.000    0.316    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}
      402    0.001    0.000    0.304    0.001 csr.py:322(_get_sliceXarray)
      402    0.006    0.000    0.302    0.001 compressed.py:733(_minor_index_fancy)
      402    0.001    0.000    0.209    0.001 <__array_function__ internals>:2(diff)
      402    0.206    0.001    0.207    0.001 function_base.py:1152(diff)
      402    0.149    0.000    0.149    0.000 {built-in method scipy.sparse._sparsetools.csr_column_index1}
      804    0.004    0.000    0.099    0.000 _index.py:127(_validate_indices)
      402    0.095    0.000    0.095    0.000 {built-in method sparse_coo_tensor}
      804    0.001    0.000    0.085    0.000 fromnumeric.py:52(_wrapfunc)
      804    0.006    0.000    0.080    0.000 compressed.py:27(__init__)
      402    0.005    0.000    0.069    0.000 compressed.py:1013(tocoo)
     3216    0.065    0.000    0.065    0.000 {method 'reduce' of 'numpy.ufunc' objects}
      804    0.004    0.000    0.062    0.000 _index.py:151(_asindices)
      402    0.050    0.000    0.050    0.000 {built-in method scipy.sparse._sparsetools.csr_column_index2}
      402    0.000    0.000    0.046    0.000 <__array_function__ internals>:2(argsort)
      402    0.001    0.000    0.045    0.000 fromnumeric.py:999(argsort)
     1608    0.001    0.000    0.044    0.000 {method 'max' of 'numpy.ndarray' objects}
      402    0.044    0.000    0.044    0.000 {method 'argsort' of 'numpy.ndarray' objects}
     1608    0.001    0.000    0.043    0.000 _methods.py:37(_amax)
      402    0.001    0.000    0.042    0.000 <__array_function__ internals>:2(cumsum)
      804    0.017    0.000    0.042    0.000 compressed.py:135(check_format)
      402    0.003    0.000    0.041    0.000 coo.py:126(__init__)
      402    0.001    0.000    0.041    0.000 fromnumeric.py:2418(cumsum)
      201    0.000    0.000    0.040    0.000 dataloader.py:511(_next_index)
      402    0.040    0.000    0.040    0.000 {method 'cumsum' of 'numpy.ndarray' objects}
      201    0.000    0.000    0.040    0.000 <ipython-input-25-7c502df9f0ea>:20(__iter__)
        1    0.000    0.000    0.038    0.038 <ipython-input-25-7c502df9f0ea>:21(<listcomp>)
        2    0.038    0.019    0.038    0.019 {built-in method randperm}
     2412    0.012    0.000    0.034    0.000 sputils.py:119(get_index_dtype)
    15277    0.029    0.000    0.029    0.000 {built-in method numpy.array}
      402    0.008    0.000    0.026    0.000 coo.py:265(_check)
     9247    0.003    0.000    0.026    0.000 _asarray.py:14(asarray)
     1608    0.001    0.000    0.026    0.000 {method 'min' of 'numpy.ndarray' objects}
     1608    0.001    0.000    0.024    0.000 _methods.py:41(_amin)
      402    0.020    0.000    0.020    0.000 {built-in method scipy.sparse._sparsetools.expandptr}
      804    0.006    0.000    0.019    0.000 _index.py:246(_unpack_index)
     2010    0.005    0.000    0.015    0.000 sputils.py:186(isintlike)
      201    0.000    0.000    0.013    0.000 auto_restart.py:462(_capture_metadata_collate)
      804    0.011    0.000    0.011    0.000 {built-in method numpy.zeros}
      402    0.000    0.000    0.010    0.000 <__array_function__ internals>:2(stack)
      804    0.005    0.000    0.010    0.000 compressed.py:1144(prune)
16483/15277    0.005    0.000    0.010    0.000 {built-in method builtins.isinstance}
     2010    0.002    0.000    0.010    0.000 <__array_function__ internals>:2(ndim)
     4824    0.009    0.000    0.009    0.000 getlimits.py:498(__init__)
      402    0.002    0.000    0.008    0.000 shape_base.py:358(stack)
 1005/201    0.003    0.000    0.008    0.000 collate.py:16(default_convert)
     3216    0.002    0.000    0.007    0.000 <__array_function__ internals>:2(can_cast)
     2010    0.001    0.000    0.007    0.000 _index.py:355(_compatible_boolean_index)
     1206    0.005    0.000    0.007    0.000 sputils.py:265(check_shape)
      201    0.001    0.000    0.006    0.000 collate.py:29(<dictcomp>)
     2010    0.002    0.000    0.006    0.000 fromnumeric.py:3075(ndim)
     2010    0.005    0.000    0.005    0.000 {built-in method numpy.empty}
     1206    0.003    0.000    0.005    0.000 sputils.py:208(isshape)
     3618    0.002    0.000    0.005    0.000 base.py:238(nnz)
      201    0.000    0.000    0.005    0.000 profiler.py:426(__init__)
      402    0.000    0.000    0.005    0.000 typing.py:1156(__instancecheck__)
      201    0.004    0.000    0.004    0.000 {built-in method zeros}
      402    0.000    0.000    0.004    0.000 {built-in method builtins.issubclass}
      402    0.001    0.000    0.004    0.000 typing.py:1145(__subclasscheck__)
     1206    0.002    0.000    0.004    0.000 sputils.py:91(to_native)
      201    0.001    0.000    0.004    0.000 profiler.py:434(__enter__)
      402    0.001    0.000    0.003    0.000 <__array_function__ internals>:2(concatenate)
      201    0.003    0.000    0.003    0.000 {built-in method torch._ops.profiler._record_function_enter}
     1206    0.001    0.000    0.003    0.000 data.py:20(__init__)
      402    0.001    0.000    0.003    0.000 abc.py:196(__subclasscheck__)
     3618    0.003    0.000    0.003    0.000 {built-in method builtins.hasattr}
     1206    0.002    0.000    0.003    0.000 _index.py:331(_maybe_bool_ndarray)
     1206    0.001    0.000    0.002    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
      402    0.001    0.000    0.002    0.000 compressed.py:777(_get_submatrix)
      402    0.002    0.000    0.002    0.000 {built-in method as_tensor}
     2412    0.001    0.000    0.002    0.000 _asarray.py:86(asanyarray)
     3216    0.002    0.000    0.002    0.000 compressed.py:107(getnnz)
     1206    0.002    0.000    0.002    0.000 base.py:66(__init__)
     1206    0.001    0.000    0.002    0.000 <frozen importlib._bootstrap>:416(parent)
    16082    0.002    0.000    0.002    0.000 {built-in method builtins.len}
      804    0.002    0.000    0.002    0.000 {method 'astype' of 'numpy.ndarray' objects}
      804    0.001    0.000    0.002    0.000 _index.py:340(_first_element_bool)
      201    0.001    0.000    0.002    0.000 profiler.py:438(__exit__)
     3618    0.001    0.000    0.002    0.000 sputils.py:278(<genexpr>)
     2412    0.002    0.000    0.002    0.000 getlimits.py:509(min)
     1206    0.001    0.000    0.002    0.000 _weakrefset.py:70(__contains__)
     2412    0.001    0.000    0.001    0.000 base.py:1188(isspmatrix)
      804    0.001    0.000    0.001    0.000 compressed.py:1276(_process_slice)
     6432    0.001    0.000    0.001    0.000 base.py:80(get_shape)
      201    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_exit}
  402/201    0.000    0.000    0.001    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.001    0.001 {method 'permutation' of 'numpy.random.mtrand.RandomState' objects}
      804    0.001    0.000    0.001    0.000 _index.py:292(_check_ellipsis)
     1608    0.001    0.000    0.001    0.000 _util.py:134(_prune_array)
     1608    0.001    0.000    0.001    0.000 {built-in method builtins.max}
      402    0.001    0.000    0.001    0.000 abc.py:180(__instancecheck__)
      402    0.000    0.000    0.001    0.000 shape_base.py:421(<listcomp>)
     2412    0.001    0.000    0.001    0.000 getlimits.py:522(max)
      201    0.000    0.000    0.001    0.000 fetching.py:287(apply_profiler)
     3216    0.001    0.000    0.001    0.000 {built-in method _operator.index}
      402    0.001    0.000    0.001    0.000 coo.py:239(getnnz)
      402    0.000    0.000    0.001    0.000 <__array_function__ internals>:2(empty_like)
     1206    0.001    0.000    0.001    0.000 {method 'newbyteorder' of 'numpy.dtype' objects}
      201    0.000    0.000    0.001    0.000 base.py:68(profile)
      804    0.001    0.000    0.001    0.000 {method 'ravel' of 'numpy.ndarray' objects}
      402    0.000    0.000    0.001    0.000 shape_base.py:349(_stack_dispatcher)
      402    0.001    0.000    0.001    0.000 shape_base.py:425(<setcomp>)
     5226    0.001    0.000    0.001    0.000 csr.py:235(_swap)
      402    0.001    0.000    0.001    0.000 typing.py:1033(_abc_negative_cache_version)
     1206    0.001    0.000    0.001    0.000 {method 'rpartition' of 'str' objects}
      804    0.001    0.000    0.001    0.000 {built-in method builtins.iter}
     1206    0.001    0.000    0.001    0.000 data.py:23(_get_dtype)
      402    0.001    0.000    0.001    0.000 shape_base.py:433(<listcomp>)
      804    0.001    0.000    0.001    0.000 {built-in method numpy.core._multiarray_umath.normalize_axis_index}
      402    0.000    0.000    0.000    0.000 compressed.py:701(_major_slice)
      402    0.000    0.000    0.000    0.000 {method 'search' of '_sre.SRE_Pattern' objects}
     3216    0.000    0.000    0.000    0.000 multiarray.py:468(can_cast)
      201    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      402    0.000    0.000    0.000    0.000 shape_base.py:208(_arrays_for_stack_dispatcher)
     2010    0.000    0.000    0.000    0.000 fromnumeric.py:3071(_ndim_dispatcher)
      804    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      402    0.000    0.000    0.000    0.000 {method 'indices' of 'slice' objects}
      402    0.000    0.000    0.000    0.000 typing.py:1089(__eq__)
      402    0.000    0.000    0.000    0.000 typing.py:1019(_abc_negative_cache)
      402    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 <ipython-input-25-7c502df9f0ea>:22(<listcomp>)
        2    0.000    0.000    0.000    0.000 {method 'chunk' of 'torch._C._TensorBase' objects}
      402    0.000    0.000    0.000    0.000 fromnumeric.py:2414(_cumsum_dispatcher)
      402    0.000    0.000    0.000    0.000 function_base.py:1148(_diff_dispatcher)
      201    0.000    0.000    0.000    0.000 supporters.py:533(loader_iters)
      201    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      402    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      402    0.000    0.000    0.000    0.000 fromnumeric.py:995(_argsort_dispatcher)
      402    0.000    0.000    0.000    0.000 multiarray.py:143(concatenate)
      402    0.000    0.000    0.000    0.000 multiarray.py:75(empty_like)
        1    0.000    0.000    0.000    0.000 warnings.py:85(_showwarnmsg)
      201    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 warnings.py:20(_showwarnmsg_impl)
        1    0.000    0.000    0.000    0.000 iostream.py:384(write)
       62    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 iostream.py:195(schedule)
        1    0.000    0.000    0.000    0.000 socket.py:480(send)
        1    0.000    0.000    0.000    0.000 warnings.py:35(_formatwarnmsg_impl)
        1    0.000    0.000    0.000    0.000 warnings.py:106(_formatwarnmsg)
        1    0.000    0.000    0.000    0.000 warnings.py:398(__init__)
        1    0.000    0.000    0.000    0.000 linecache.py:15(getline)
        1    0.000    0.000    0.000    0.000 threading.py:1104(is_alive)
        1    0.000    0.000    0.000    0.000 linecache.py:37(getlines)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.locals}
        7    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        1    0.000    0.000    0.000    0.000 iostream.py:308(_is_master_process)
        1    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
        1    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        1    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
        1    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 iostream.py:321(_schedule_flush)
        1    0.000    0.000    0.000    0.000 threading.py:506(is_set)



Profile stats for: training_batch_to_device
         29200 function calls (28200 primitive calls) in 0.076 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.001    0.000    0.075    0.000 accelerator.py:192(batch_to_device)
      200    0.001    0.000    0.071    0.000 lightning.py:284(_apply_batch_transfer_handler)
      200    0.000    0.000    0.053    0.000 hooks.py:652(transfer_batch_to_device)
      200    0.001    0.000    0.053    0.000 apply_func.py:245(move_data_to_device)
 1000/200    0.006    0.000    0.052    0.000 apply_func.py:70(apply_to_collection)
      800    0.002    0.000    0.043    0.000 apply_func.py:262(batch_to)
      800    0.041    0.000    0.041    0.000 {method 'to' of 'torch._C._TensorBase' objects}
      200    0.001    0.000    0.016    0.000 signature_utils.py:18(is_param_in_hook_signature)
      200    0.000    0.000    0.016    0.000 inspect.py:3063(signature)
      200    0.000    0.000    0.015    0.000 inspect.py:2811(from_callable)
  400/200    0.002    0.000    0.015    0.000 inspect.py:2183(_signature_from_callable)
      200    0.003    0.000    0.009    0.000 inspect.py:2102(_signature_from_function)
     4600    0.002    0.000    0.006    0.000 {built-in method builtins.isinstance}
     1600    0.003    0.000    0.004    0.000 abc.py:180(__instancecheck__)
      400    0.003    0.000    0.004    0.000 inspect.py:2732(__init__)
      200    0.001    0.000    0.003    0.000 inspect.py:1787(_signature_bound_method)
      800    0.002    0.000    0.003    0.000 inspect.py:2452(__init__)
      200    0.000    0.000    0.002    0.000 accelerator.py:172(lightning_module)
      200    0.000    0.000    0.002    0.000 training_type_plugin.py:171(lightning_module)
      200    0.000    0.000    0.002    0.000 inspect.py:2825(replace)
      200    0.000    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
     2200    0.001    0.000    0.001    0.000 _weakrefset.py:70(__contains__)
      200    0.000    0.000    0.001    0.000 inspect.py:485(unwrap)
      800    0.001    0.000    0.001    0.000 enum.py:267(__call__)
      200    0.000    0.000    0.001    0.000 contextlib.py:85(__exit__)
     1000    0.001    0.000    0.001    0.000 inspect.py:2781(<genexpr>)
      200    0.000    0.000    0.001    0.000 {built-in method builtins.next}
      200    0.000    0.000    0.001    0.000 base.py:68(profile)
      200    0.000    0.000    0.000    0.000 inspect.py:505(_is_wrapper)
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
     1600    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      200    0.000    0.000    0.000    0.000 accelerator.py:180(root_device)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
     1200    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      800    0.000    0.000    0.000    0.000 enum.py:517(__new__)
     1400    0.000    0.000    0.000    0.000 inspect.py:2502(name)
      400    0.000    0.000    0.000    0.000 inspect.py:159(isfunction)
      800    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
     1000    0.000    0.000    0.000    0.000 inspect.py:2514(kind)
      200    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
      200    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      600    0.000    0.000    0.000    0.000 inspect.py:2506(default)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      200    0.000    0.000    0.000    0.000 single_device.py:63(root_device)
      400    0.000    0.000    0.000    0.000 inspect.py:2817(parameters)
      200    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
      200    0.000    0.000    0.000    0.000 base.py:54(trainer)
      200    0.000    0.000    0.000    0.000 hooks.py:744(on_after_batch_transfer)
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      200    0.000    0.000    0.000    0.000 hooks.py:709(on_before_batch_transfer)
      200    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: on_batch_start
         55068 function calls (47116 primitive calls) in 0.035 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.000    0.000    0.032    0.000 callback_hook.py:155(on_batch_start)
      200    0.001    0.000    0.030    0.000 lr_finder.py:329(on_batch_start)
        1    0.000    0.000    0.029    0.029 notebook.py:210(__init__)
        1    0.000    0.000    0.024    0.024 notebook.py:104(status_printer)
     11/4    0.000    0.000    0.021    0.005 widget.py:474(__init__)
     11/4    0.000    0.000    0.021    0.005 widget.py:490(open)
8772/3618    0.003    0.000    0.017    0.000 {built-in method builtins.getattr}
     14/7    0.000    0.000    0.017    0.002 widget.py:557(get_state)
 2676/862    0.001    0.000    0.017    0.000 traitlets.py:545(__get__)
  966/435    0.000    0.000    0.017    0.000 traitlets.py:526(get)
        7    0.000    0.000    0.014    0.002 trait_types.py:167(make_dynamic_default)
        2    0.000    0.000    0.010    0.005 widget_string.py:29(__init__)
       26    0.000    0.000    0.009    0.000 traitlets.py:950(__new__)
       26    0.000    0.000    0.009    0.000 traitlets.py:982(setup_instance)
       26    0.001    0.000    0.009    0.000 traitlets.py:961(setup_instance)
       11    0.000    0.000    0.008    0.001 comm.py:50(__init__)
        1    0.000    0.000    0.006    0.006 widget_float.py:23(__init__)
       36    0.001    0.000    0.006    0.000 traitlets.py:1407(traits)
       11    0.000    0.000    0.005    0.000 comm.py:80(open)
       14    0.000    0.000    0.005    0.000 comm.py:61(_publish_msg)
      505    0.001    0.000    0.005    0.000 traitlets.py:516(instance_init)
        1    0.000    0.000    0.004    0.004 widget_box.py:62(__init__)
       36    0.001    0.000    0.004    0.000 traitlets.py:224(getmembers)
      2/1    0.000    0.000    0.004    0.004 display.py:131(display)
        1    0.000    0.000    0.004    0.004 formatters.py:89(format)
        1    0.000    0.000    0.003    0.003 decorator.py:229(fun)
        1    0.000    0.000    0.003    0.003 formatters.py:220(catch_format_error)
        1    0.000    0.000    0.003    0.003 formatters.py:903(__call__)
        1    0.000    0.000    0.003    0.003 widget.py:789(_ipython_display_)
       15    0.000    0.000    0.003    0.000 session.py:749(send)
    10506    0.002    0.000    0.003    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.003    0.003 display.py:81(publish_display_data)
        1    0.000    0.000    0.003    0.003 zmqshell.py:97(publish)
       11    0.000    0.000    0.003    0.000 configurable.py:38(__init__)
       62    0.003    0.000    0.003    0.000 {built-in method builtins.dir}
      603    0.002    0.000    0.003    0.000 traitlets.py:486(_dynamic_default_callable)
    74/63    0.000    0.000    0.002    0.000 traitlets.py:576(__set__)
    86/75    0.000    0.000    0.002    0.000 traitlets.py:558(set)
        1    0.000    0.000    0.002    0.002 zmqshell.py:80(_flush_streams)
        2    0.000    0.000    0.002    0.001 iostream.py:335(flush)
        2    0.000    0.000    0.002    0.001 threading.py:533(wait)
        2    0.000    0.000    0.002    0.001 threading.py:263(wait)
       11    0.000    0.000    0.002    0.000 widget.py:461(_default_keys)
       29    0.002    0.000    0.002    0.000 {method 'acquire' of '_thread.lock' objects}
   396/29    0.001    0.000    0.002    0.000 jsonutil.py:73(json_clean)
    48/37    0.000    0.000    0.002    0.000 traitlets.py:1133(_notify_trait)
       11    0.000    0.000    0.002    0.000 configurable.py:131(_load_config)
      164    0.000    0.000    0.002    0.000 traitlets.py:1690(instance_init)
       15    0.000    0.000    0.002    0.000 session.py:685(serialize)
       15    0.000    0.000    0.002    0.000 widget.py:676(notify_change)
       60    0.000    0.000    0.002    0.000 session.py:95(json_packer)
      742    0.000    0.000    0.002    0.000 contextlib.py:85(__exit__)
      200    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
       60    0.000    0.000    0.001    0.000 __init__.py:183(dumps)
     1290    0.000    0.000    0.001    0.000 {built-in method builtins.next}
      990    0.001    0.000    0.001    0.000 abc.py:180(__instancecheck__)
        3    0.000    0.000    0.001    0.000 widget.py:538(send_state)
      200    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       60    0.000    0.000    0.001    0.000 encoder.py:182(encode)
      200    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
       60    0.001    0.000    0.001    0.000 encoder.py:204(iterencode)
  509/503    0.000    0.000    0.001    0.000 traitlets.py:587(_validate)
        1    0.000    0.000    0.001    0.001 notebook.py:149(display)
       36    0.001    0.000    0.001    0.000 traitlets.py:1421(<listcomp>)
      200    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      200    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
     2496    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
       26    0.000    0.000    0.001    0.000 traitlets.py:988(__init__)
      542    0.000    0.000    0.001    0.000 contextlib.py:157(helper)
        3    0.000    0.000    0.001    0.000 widget.py:814(_send)
    48/37    0.000    0.000    0.001    0.000 traitlets.py:1142(notify_change)
        3    0.000    0.000    0.001    0.000 comm.py:120(send)
      267    0.000    0.000    0.001    0.000 traitlets.py:1439(trait_metadata)
       31    0.000    0.000    0.001    0.000 traitlets.py:2264(instance_init)
     1975    0.001    0.000    0.001    0.000 _weakrefset.py:70(__contains__)
       47    0.000    0.000    0.000    0.000 traitlets.py:1698(make_dynamic_default)
      542    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
      542    0.000    0.000    0.000    0.000 contextlib.py:79(__enter__)
       74    0.000    0.000    0.000    0.000 traitlets.py:1067(hold_trait_notifications)
       11    0.000    0.000    0.000    0.000 manager.py:45(register_comm)
      4/1    0.000    0.000    0.000    0.000 widget.py:775(_handle_displayed)
      4/1    0.000    0.000    0.000    0.000 widget.py:201(__call__)
       33    0.000    0.000    0.000    0.000 traitlets.py:2566(instance_init)
        1    0.000    0.000    0.000    0.000 widget_box.py:67(_fire_children_displayed)
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
       19    0.000    0.000    0.000    0.000 iostream.py:195(schedule)
     2707    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       15    0.000    0.000    0.000    0.000 iostream.py:260(send_multipart)
      598    0.000    0.000    0.000    0.000 {method 'mro' of 'type' objects}
      210    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       15    0.000    0.000    0.000    0.000 iostream.py:207(send_multipart)
       15    0.000    0.000    0.000    0.000 session.py:644(msg)
       11    0.000    0.000    0.000    0.000 configurable.py:106(_find_my_config)
       15    0.000    0.000    0.000    0.000 session.py:670(sign)
     4272    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      147    0.000    0.000    0.000    0.000 traitlets.py:596(_cross_validate)
      200    0.000    0.000    0.000    0.000 fit_loop.py:80(batch_idx)
       30    0.000    0.000    0.000    0.000 jsonutil.py:108(json_default)
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       15    0.000    0.000    0.000    0.000 session.py:641(msg_header)
       25    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
       11    0.000    0.000    0.000    0.000 widget.py:505(_comm_changed)
     1010    0.000    0.000    0.000    0.000 traitlets.py:1047(cross_validation_lock)
       19    0.000    0.000    0.000    0.000 socket.py:480(send)
        1    0.000    0.000    0.000    0.000 asyncio.py:23(__init__)
       11    0.000    0.000    0.000    0.000 comm.py:26(_default_comm_id)
        1    0.000    0.000    0.000    0.000 std.py:846(__init__)
        1    0.000    0.000    0.000    0.000 widget.py:653(on_displayed)
       30    0.000    0.000    0.000    0.000 {method 'isoformat' of 'datetime.datetime' objects}
       14    0.000    0.000    0.000    0.000 widget.py:138(_remove_buffers)
       11    0.000    0.000    0.000    0.000 uuid.py:621(uuid4)
    19/14    0.000    0.000    0.000    0.000 widget.py:93(_separate_buffers)
       36    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}
       11    0.000    0.000    0.000    0.000 comm.py:137(on_msg)
      200    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      500    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       15    0.000    0.000    0.000    0.000 session.py:271(msg_header)
       22    0.000    0.000    0.000    0.000 traitlets.py:923(instance_init)
      100    0.000    0.000    0.000    0.000 trainer.py:1703(lr_schedulers)
      200    0.000    0.000    0.000    0.000 training_epoch_loop.py:81(batch_idx)
      598    0.000    0.000    0.000    0.000 {method 'index' of 'list' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.repr}
        2    0.000    0.000    0.000    0.000 std.py:355(format_meter)
        1    0.000    0.000    0.000    0.000 notebook.py:90(__repr__)
       15    0.000    0.000    0.000    0.000 traitlets.py:2323(validate)
       60    0.000    0.000    0.000    0.000 hmac.py:90(update)
       33    0.000    0.000    0.000    0.000 loader.py:231(_has_section)
       21    0.000    0.000    0.000    0.000 traitlets.py:2235(validate)
       22    0.000    0.000    0.000    0.000 configurable.py:99(section_names)
       22    0.000    0.000    0.000    0.000 traitlets.py:1237(observe)
       15    0.000    0.000    0.000    0.000 session.py:199(utcnow)
      164    0.000    0.000    0.000    0.000 traitlets.py:1694(_resolve_classes)
       75    0.000    0.000    0.000    0.000 {method 'update' of '_hashlib.HASH' objects}
       11    0.000    0.000    0.000    0.000 uuid.py:106(__init__)
       22    0.000    0.000    0.000    0.000 configurable.py:102(<listcomp>)
      138    0.000    0.000    0.000    0.000 traitlets.py:2045(validate)
       15    0.000    0.000    0.000    0.000 session.py:597(msg_id)
       11    0.000    0.000    0.000    0.000 {built-in method posix.urandom}
      401    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        3    0.000    0.000    0.000    0.000 widget.py:724(_should_send_property)
        1    0.000    0.000    0.000    0.000 std.py:560(__new__)
       21    0.000    0.000    0.000    0.000 threading.py:1104(is_alive)
       15    0.000    0.000    0.000    0.000 hmac.py:95(copy)
      312    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       15    0.000    0.000    0.000    0.000 hmac.py:127(hexdigest)
      637    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
      492    0.000    0.000    0.000    0.000 traitlets.py:215(__init__)
       12    0.000    0.000    0.000    0.000 traitlets.py:1336(set_trait)
       32    0.000    0.000    0.000    0.000 widget.py:515(model_id)
        1    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
       88    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
      492    0.000    0.000    0.000    0.000 traitlets.py:216(__call__)
      276    0.000    0.000    0.000    0.000 traitlets.py:911(__get__)
       15    0.000    0.000    0.000    0.000 {method 'replace' of 'datetime.datetime' objects}
      108    0.000    0.000    0.000    0.000 bunch.py:11(__getattr__)
      100    0.000    0.000    0.000    0.000 lr_finder.py:439(lr)
       30    0.000    0.000    0.000    0.000 traitlets.py:2316(validate_elements)
        1    0.000    0.000    0.000    0.000 std.py:576(_get_free_pos)
        1    0.000    0.000    0.000    0.000 formatters.py:374(lookup)
       84    0.000    0.000    0.000    0.000 traitlets.py:1673(validate)
       60    0.000    0.000    0.000    0.000 encoder.py:104(__init__)
       22    0.000    0.000    0.000    0.000 traitlets.py:188(parse_notifier_name)
       33    0.000    0.000    0.000    0.000 loader.py:150(_is_section_key)
       22    0.000    0.000    0.000    0.000 loader.py:161(__init__)
       12    0.000    0.000    0.000    0.000 traitlets.py:1095(hold)
        1    0.000    0.000    0.000    0.000 decorator.py:199(fix)
      200    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
     11/8    0.000    0.000    0.000    0.000 widget.py:51(_widget_to_json)
       11    0.000    0.000    0.000    0.000 comm.py:19(_default_kernel)
       22    0.000    0.000    0.000    0.000 traitlets.py:1178(_add_notifiers)
        1    0.000    0.000    0.000    0.000 formatters.py:397(lookup_by_type)
       15    0.000    0.000    0.000    0.000 hmac.py:108(_current)
       26    0.000    0.000    0.000    0.000 traitlets.py:1399(has_trait)
      198    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
       21    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        7    0.000    0.000    0.000    0.000 traitlets.py:932(instance_init)
       15    0.000    0.000    0.000    0.000 session.py:844(<listcomp>)
        1    0.000    0.000    0.000    0.000 std.py:579(<setcomp>)
       33    0.000    0.000    0.000    0.000 loader.py:218(__contains__)
       45    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
       36    0.000    0.000    0.000    0.000 traitlets.py:2246(validate_elements)
       30    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        2    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
       11    0.000    0.000    0.000    0.000 comm.py:38(_default_topic)
        7    0.000    0.000    0.000    0.000 traitlets.py:1299(_register_validator)
       19    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
       41    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
       15    0.000    0.000    0.000    0.000 tz.py:218(utcoffset)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        3    0.000    0.000    0.000    0.000 traitlets.py:2154(validate)
      222    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        1    0.000    0.000    0.000    0.000 utils.py:162(__init__)
        1    0.000    0.000    0.000    0.000 inspect.py:2992(bind)
        2    0.000    0.000    0.000    0.000 threading.py:498(__init__)
      256    0.000    0.000    0.000    0.000 widget.py:779(_trait_to_json)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        1    0.000    0.000    0.000    0.000 inspect.py:2861(_bind)
        4    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
       15    0.000    0.000    0.000    0.000 {built-in method utcnow}
        1    0.000    0.000    0.000    0.000 widget.py:217(register_callback)
       19    0.000    0.000    0.000    0.000 jsonutil.py:131(<listcomp>)
       11    0.000    0.000    0.000    0.000 {built-in method from_bytes}
       10    0.000    0.000    0.000    0.000 formatters.py:550(_in_deferred_types)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        1    0.000    0.000    0.000    0.000 notebook.py:81(_repr_json_)
       30    0.000    0.000    0.000    0.000 jsonutil.py:39(_ensure_tzinfo)
       11    0.000    0.000    0.000    0.000 widget.py:463(<listcomp>)
        7    0.000    0.000    0.000    0.000 trait_types.py:161(validate)
       11    0.000    0.000    0.000    0.000 uuid.py:280(hex)
      108    0.000    0.000    0.000    0.000 {method '__getitem__' of 'dict' objects}
       42    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
       15    0.000    0.000    0.000    0.000 session.py:278(extract_header)
        2    0.000    0.000    0.000    0.000 traitlets.py:2528(validate)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
       15    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
       13    0.000    0.000    0.000    0.000 configurable.py:381(instance)
        1    0.000    0.000    0.000    0.000 widget.py:55(<listcomp>)
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        1    0.000    0.000    0.000    0.000 utils.py:296(<listcomp>)
        2    0.000    0.000    0.000    0.000 threading.py:215(__init__)
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
       15    0.000    0.000    0.000    0.000 {built-in method builtins.locals}
        2    0.000    0.000    0.000    0.000 notebook.py:205(colour)
       15    0.000    0.000    0.000    0.000 tz.py:262(_isdst)
       15    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
       33    0.000    0.000    0.000    0.000 traitlets.py:2110(validate)
       70    0.000    0.000    0.000    0.000 traitlets.py:396(instance_init)
        6    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
       15    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        6    0.000    0.000    0.000    0.000 traitlets.py:1983(validate)
        1    0.000    0.000    0.000    0.000 re.py:204(split)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
       33    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        2    0.000    0.000    0.000    0.000 traitlets.py:2535(validate_elements)
        1    0.000    0.000    0.000    0.000 os.py:664(__getitem__)
        2    0.000    0.000    0.000    0.000 notebook.py:200(colour)
       17    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
       21    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        1    0.000    0.000    0.000    0.000 utils.py:215(_supports_unicode)
        1    0.000    0.000    0.000    0.000 utils.py:222(_is_ascii)
       13    0.000    0.000    0.000    0.000 configurable.py:426(initialized)
        1    0.000    0.000    0.000    0.000 inspect.py:2652(apply_defaults)
        2    0.000    0.000    0.000    0.000 threading.py:242(__exit__)
       22    0.000    0.000    0.000    0.000 threading.py:506(is_set)
        2    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
       11    0.000    0.000    0.000    0.000 {method 'count' of 'list' objects}
       60    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        1    0.000    0.000    0.000    0.000 std.py:188(__format__)
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        1    0.000    0.000    0.000    0.000 displaypub.py:43(_validate_data)
        1    0.000    0.000    0.000    0.000 dir2.py:54(get_real_method)
        2    0.000    0.000    0.000    0.000 traitlets.py:419(__init__)
        2    0.000    0.000    0.000    0.000 threading.py:251(_acquire_restore)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        1    0.000    0.000    0.000    0.000 {method 'split' of '_sre.SRE_Pattern' objects}
        1    0.000    0.000    0.000    0.000 std.py:155(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:171(__eq__)
       22    0.000    0.000    0.000    0.000 loader.py:165(_ensure_subconfig)
        1    0.000    0.000    0.000    0.000 inspect.py:2599(args)
        1    0.000    0.000    0.000    0.000 traitlets.py:904(__call__)
       11    0.000    0.000    0.000    0.000 traitlets.py:2023(validate)
        1    0.000    0.000    0.000    0.000 os.py:742(encode)
       37    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
       33    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        2    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        1    0.000    0.000    0.000    0.000 zmqshell.py:90(_hooks)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 __init__.py:12(escape)
        6    0.000    0.000    0.000    0.000 traitlets.py:1832(_validate_bounds)
       37    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
       37    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
       11    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        1    0.000    0.000    0.000    0.000 widget_float.py:33(_validate_value)
        1    0.000    0.000    0.000    0.000 _monitor.py:94(report)
        2    0.000    0.000    0.000    0.000 std.py:233(__call__)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        1    0.000    0.000    0.000    0.000 utils.py:201(_is_utf)
        1    0.000    0.000    0.000    0.000 inspect.py:2622(kwargs)
       12    0.000    0.000    0.000    0.000 traitlets.py:1083(compress)
        2    0.000    0.000    0.000    0.000 threading.py:239(__enter__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
       22    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 std.py:169(colour)
        3    0.000    0.000    0.000    0.000 std.py:228(__init__)
        1    0.000    0.000    0.000    0.000 std.py:657(get_lock)
        1    0.000    0.000    0.000    0.000 formatters.py:359(_check_return)
        1    0.000    0.000    0.000    0.000 inspect.py:2591(__init__)
        2    0.000    0.000    0.000    0.000 threading.py:248(_release_save)
        2    0.000    0.000    0.000    0.000 threading.py:254(_is_owned)
        1    0.000    0.000    0.000    0.000 re.py:286(_compile)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        1    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
        1    0.000    0.000    0.000    0.000 {method 'difference' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
       18    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 {built-in method time.time}
        3    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method _imp.lock_held}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.min}
       11    0.000    0.000    0.000    0.000 widget.py:334(_call_widget_constructed)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 utils.py:231(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 jsonutil.py:46(encode_images)
        1    0.000    0.000    0.000    0.000 formatters.py:274(_get_type)
        1    0.000    0.000    0.000    0.000 pretty.py:305(_get_mro)
        4    0.000    0.000    0.000    0.000 inspect.py:2817(parameters)
        1    0.000    0.000    0.000    0.000 inspect.py:73(isclass)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        3    0.000    0.000    0.000    0.000 {method 'items' of 'mappingproxy' objects}
       33    0.000    0.000    0.000    0.000 {function Config.__contains__ at 0x7f4a43031598}
        3    0.000    0.000    0.000    0.000 {built-in method math.isnan}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
        1    0.000    0.000    0.000    0.000 std.py:165(colour)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        3    0.000    0.000    0.000    0.000 py3compat.py:12(no_code)
        4    0.000    0.000    0.000    0.000 inspect.py:2502(name)
       10    0.000    0.000    0.000    0.000 inspect.py:2514(kind)



Profile stats for: on_train_batch_start
         26400 function calls (26200 primitive calls) in 0.020 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.001    0.000    0.019    0.000 callback_hook.py:166(on_train_batch_start)
      200    0.001    0.000    0.016    0.000 signature_utils.py:18(is_param_in_hook_signature)
      200    0.000    0.000    0.016    0.000 inspect.py:3063(signature)
      200    0.000    0.000    0.015    0.000 inspect.py:2811(from_callable)
  400/200    0.001    0.000    0.015    0.000 inspect.py:2183(_signature_from_callable)
      200    0.003    0.000    0.009    0.000 inspect.py:2102(_signature_from_function)
      400    0.003    0.000    0.004    0.000 inspect.py:2732(__init__)
     1200    0.002    0.000    0.003    0.000 inspect.py:2452(__init__)
      200    0.001    0.000    0.003    0.000 inspect.py:1787(_signature_bound_method)
      200    0.000    0.000    0.002    0.000 inspect.py:2825(replace)
      200    0.000    0.000    0.002    0.000 trainer.py:1686(lightning_module)
      200    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
     2800    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
      200    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      200    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
     1200    0.001    0.000    0.001    0.000 enum.py:267(__call__)
      200    0.000    0.000    0.001    0.000 inspect.py:485(unwrap)
     1400    0.001    0.000    0.001    0.000 inspect.py:2781(<genexpr>)
      200    0.000    0.000    0.001    0.000 abc.py:180(__instancecheck__)
      200    0.000    0.000    0.001    0.000 contextlib.py:85(__exit__)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
     2200    0.000    0.000    0.000    0.000 inspect.py:2502(name)
     1600    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     1200    0.000    0.000    0.000    0.000 enum.py:517(__new__)
      200    0.000    0.000    0.000    0.000 inspect.py:505(_is_wrapper)
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      400    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      600    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      400    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      400    0.000    0.000    0.000    0.000 inspect.py:159(isfunction)
     1200    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
     1400    0.000    0.000    0.000    0.000 inspect.py:2514(kind)
     1200    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      600    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
     1000    0.000    0.000    0.000    0.000 inspect.py:2506(default)
      800    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      200    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
      400    0.000    0.000    0.000    0.000 inspect.py:2817(parameters)
      200    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      200    0.000    0.000    0.000    0.000 hooks.py:82(on_train_batch_start)
      200    0.000    0.000    0.000    0.000 base.py:99(on_train_batch_start)
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      200    0.000    0.000    0.000    0.000 training_type_plugin.py:363(on_train_batch_start)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.len}



Profile stats for: run_training_batch
         25814 function calls (25614 primitive calls) in 4.625 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
  400/200    0.002    0.000    4.625    0.023 base.py:109(run)
      200    0.001    0.000    4.621    0.023 training_batch_loop.py:72(advance)
      200    0.000    0.000    4.615    0.023 optimizer_loop.py:214(advance)
      200    0.001    0.000    4.614    0.023 optimizer_loop.py:231(_run_optimization)
      300    0.000    0.000    4.601    0.015 contextlib.py:79(__enter__)
      300    0.000    0.000    4.601    0.015 {built-in method builtins.next}
      200    0.000    0.000    4.600    0.023 base.py:68(profile)
      200    0.000    0.000    4.600    0.023 advanced.py:61(start)
      200    4.600    0.023    4.600    0.023 {method 'enable' of '_lsprof.Profiler' objects}
      100    0.001    0.000    2.496    0.025 optimizer_loop.py:353(_optimizer_step)
      100    0.000    0.000    2.492    0.025 lightning.py:1571(optimizer_step)
      100    0.000    0.000    2.492    0.025 optimizer.py:95(step)
      100    0.000    0.000    2.109    0.021 optimizer_loop.py:159(__call__)
      100    0.000    0.000    2.109    0.021 optimizer_loop.py:140(closure)
      200    0.001    0.000    0.004    0.000 optimizer_loop.py:283(_make_closure)
      500    0.000    0.000    0.003    0.000 trainer.py:1686(lightning_module)
      200    0.001    0.000    0.003    0.000 training_batch_loop.py:62(on_run_start)
      500    0.000    0.000    0.003    0.000 accelerator.py:172(lightning_module)
      500    0.000    0.000    0.003    0.000 training_type_plugin.py:171(lightning_module)
     1701    0.001    0.000    0.002    0.000 {built-in method builtins.isinstance}
      500    0.000    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
      200    0.000    0.000    0.002    0.000 training_batch_loop.py:108(_tbptt_split_batch)
      600    0.001    0.000    0.002    0.000 abc.py:180(__instancecheck__)
      200    0.000    0.000    0.001    0.000 fit_loop.py:265(_should_accumulate)
      200    0.000    0.000    0.001    0.000 training_epoch_loop.py:356(_should_accumulate)
      200    0.001    0.000    0.001    0.000 typing.py:1227(__new__)
      200    0.001    0.000    0.001    0.000 optimizer_loop.py:127(__init__)
      300    0.000    0.000    0.001    0.000 contextlib.py:157(helper)
     3200    0.001    0.000    0.001    0.000 base.py:54(trainer)
      200    0.001    0.000    0.001    0.000 optimizer_loop.py:206(on_run_start)
      100    0.000    0.000    0.001    0.000 optimizer.py:63(_to_lightning_optimizer)
      100    0.000    0.000    0.001    0.000 utilities.py:127(_block_parallel_sync_behavior)
      300    0.000    0.000    0.001    0.000 contextlib.py:59(__init__)
      100    0.000    0.000    0.001    0.000 enums.py:30(__eq__)
     1200    0.001    0.000    0.001    0.000 _weakrefset.py:70(__contains__)
      200    0.000    0.000    0.001    0.000 trainer.py:1719(amp_backend)
      200    0.000    0.000    0.000    0.000 optimizer_loop.py:335(_run_optimization_start)
      200    0.000    0.000    0.000    0.000 typing.py:1180(_generic_new)
      400    0.000    0.000    0.000    0.000 base.py:174(on_advance_start)
     1802    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      500    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      200    0.000    0.000    0.000    0.000 optimizer_loop.py:298(_make_zero_grad_fn)
      200    0.000    0.000    0.000    0.000 closure.py:60(__init__)
      400    0.000    0.000    0.000    0.000 optimizer_loop.py:190(done)
      402    0.000    0.000    0.000    0.000 trainer.py:1690(optimizers)
      200    0.000    0.000    0.000    0.000 accelerator.py:372(amp_backend)
      200    0.000    0.000    0.000    0.000 training_epoch_loop.py:339(_accumulated_batches_reached)
      200    0.000    0.000    0.000    0.000 utilities.py:151(_get_active_optimizers)
      200    0.000    0.000    0.000    0.000 optimizer_loop.py:198(reset)
      200    0.000    0.000    0.000    0.000 optimizer_loop.py:317(_make_backward_fn)
      200    0.000    0.000    0.000    0.000 training_epoch_loop.py:343(_num_ready_batches_reached)
      200    0.000    0.000    0.000    0.000 types.py:135(__get__)
      200    0.000    0.000    0.000    0.000 training_batch_loop.py:45(done)
      200    0.000    0.000    0.000    0.000 trainer.py:1711(optimizer_frequencies)
      200    0.000    0.000    0.000    0.000 optimizer_loop.py:294(_make_step_fn)
      200    0.000    0.000    0.000    0.000 {method 'pop' of 'list' objects}
      100    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
      800    0.000    0.000    0.000    0.000 utils.py:51(void)
      800    0.000    0.000    0.000    0.000 {built-in method builtins.len}
      300    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 training_batch_loop.py:58(reset)
      100    0.000    0.000    0.000    0.000 trainer.py:1796(lightning_optimizers)
      200    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
      100    0.000    0.000    0.000    0.000 progress.py:126(increment_ready)
      200    0.000    0.000    0.000    0.000 optimizer_loop.py:186(optimizer_idx)
      200    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
      200    0.000    0.000    0.000    0.000 lightning.py:256(automatic_optimization)
      400    0.000    0.000    0.000    0.000 base.py:84(skip)
      200    0.000    0.000    0.000    0.000 logger_connector.py:214(on_train_split_start)
      200    0.000    0.000    0.000    0.000 enum.py:599(value)
      200    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
      300    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
      400    0.000    0.000    0.000    0.000 training_type_plugin.py:276(handles_gradient_accumulation)
      100    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        1    0.000    0.000    0.000    0.000 optimizers.py:112(convert_to_lightning_optimizers)
        1    0.000    0.000    0.000    0.000 optimizers.py:119(<dictcomp>)
        1    0.000    0.000    0.000    0.000 optimizers.py:113(_convert_to_lightning_optimizer)
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
      100    0.000    0.000    0.000    0.000 trainer.py:1650(_device_type)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 optimizer.py:56(_on_trainer_init)
        1    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 optimizer.py:36(<dictcomp>)
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: training_step_and_backward
         4200 function calls in 2.657 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.001    0.000    2.657    0.013 optimizer_loop.py:412(_training_step)
      200    0.000    0.000    2.654    0.013 contextlib.py:79(__enter__)
      200    0.000    0.000    2.654    0.013 {built-in method builtins.next}
      200    0.000    0.000    2.654    0.013 base.py:68(profile)
      200    0.000    0.000    2.654    0.013 advanced.py:61(start)
      200    2.654    0.013    2.654    0.013 {method 'enable' of '_lsprof.Profiler' objects}
      200    0.000    0.000    0.002    0.000 trainer.py:1686(lightning_module)
      200    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      200    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      200    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      400    0.000    0.000    0.001    0.000 {built-in method builtins.isinstance}
      200    0.000    0.000    0.001    0.000 abc.py:180(__instancecheck__)
      200    0.000    0.000    0.000    0.000 contextlib.py:157(helper)
      200    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
      400    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      400    0.000    0.000    0.000    0.000 base.py:54(trainer)
      200    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}



Profile stats for: model_forward
         17200 function calls (17000 primitive calls) in 2.160 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.000    0.000    2.144    0.011 contextlib.py:79(__enter__)
      200    0.000    0.000    2.144    0.011 {built-in method builtins.next}
      200    0.000    0.000    2.143    0.011 base.py:68(profile)
      200    0.000    0.000    2.143    0.011 advanced.py:61(start)
      200    2.143    0.011    2.143    0.011 {method 'enable' of '_lsprof.Profiler' objects}
      200    0.001    0.000    0.015    0.000 utilities.py:65(_build_training_step_kwargs)
      200    0.001    0.000    0.013    0.000 signature_utils.py:18(is_param_in_hook_signature)
      200    0.000    0.000    0.013    0.000 inspect.py:3063(signature)
      200    0.000    0.000    0.012    0.000 inspect.py:2811(from_callable)
  400/200    0.002    0.000    0.012    0.000 inspect.py:2183(_signature_from_callable)
      200    0.003    0.000    0.006    0.000 inspect.py:2102(_signature_from_function)
      400    0.002    0.000    0.003    0.000 inspect.py:2732(__init__)
      200    0.001    0.000    0.003    0.000 inspect.py:1787(_signature_bound_method)
      600    0.001    0.000    0.002    0.000 inspect.py:2452(__init__)
      200    0.000    0.000    0.002    0.000 inspect.py:2825(replace)
      200    0.001    0.000    0.001    0.000 module.py:1180(__setattr__)
      200    0.000    0.000    0.001    0.000 inspect.py:485(unwrap)
      600    0.000    0.000    0.001    0.000 enum.py:267(__call__)
      200    0.000    0.000    0.001    0.000 contextlib.py:157(helper)
      800    0.000    0.000    0.000    0.000 inspect.py:2781(<genexpr>)
     2000    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      200    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
      200    0.000    0.000    0.000    0.000 inspect.py:505(_is_wrapper)
     1400    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      400    0.000    0.000    0.000    0.000 inspect.py:159(isfunction)
      600    0.000    0.000    0.000    0.000 enum.py:517(__new__)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
     1000    0.000    0.000    0.000    0.000 inspect.py:2502(name)
      200    0.000    0.000    0.000    0.000 trainer.py:1690(optimizers)
      800    0.000    0.000    0.000    0.000 inspect.py:2514(kind)
      400    0.000    0.000    0.000    0.000 base.py:54(trainer)
      200    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
      600    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
      600    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      200    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
      400    0.000    0.000    0.000    0.000 inspect.py:2817(parameters)
      200    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
      400    0.000    0.000    0.000    0.000 inspect.py:2506(default)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.id}
      200    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.len}



Profile stats for: training_step
         12400 function calls (11400 primitive calls) in 2.119 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.001    0.000    2.118    0.011 accelerator.py:213(training_step)
      200    0.001    0.000    2.114    0.011 training_type_plugin.py:212(training_step)
      200    0.001    0.000    2.113    0.011 <ipython-input-27-c9e80d243a57>:45(training_step)
      200    1.915    0.010    2.040    0.010 <ipython-input-26-8c37ca340d25>:35(sparse_loss)
      400    0.029    0.000    0.074    0.000 <ipython-input-26-8c37ca340d25>:27(sparse_dense_multiply)
  400/200    0.002    0.000    0.072    0.000 module.py:1096(_call_impl)
      200    0.001    0.000    0.071    0.000 <ipython-input-27-c9e80d243a57>:42(forward)
      200    0.067    0.000    0.068    0.000 <ipython-input-26-8c37ca340d25>:15(forward)
      200    0.000    0.000    0.051    0.000 __init__.py:94(sum)
      200    0.050    0.000    0.050    0.000 {built-in method _sparse_sum}
      400    0.042    0.000    0.042    0.000 {built-in method sparse_coo_tensor}
 1000/600    0.001    0.000    0.002    0.000 {built-in method builtins.next}
  600/400    0.001    0.000    0.002    0.000 contextlib.py:85(__exit__)
      400    0.001    0.000    0.002    0.000 precision_plugin.py:232(train_step_context)
      600    0.001    0.000    0.001    0.000 {method '_values' of 'torch._C._TensorBase' objects}
      400    0.001    0.000    0.001    0.000 {method '_indices' of 'torch._C._TensorBase' objects}
     1200    0.001    0.000    0.001    0.000 module.py:1164(__getattr__)
  400/200    0.000    0.000    0.001    0.000 contextlib.py:79(__enter__)
      400    0.000    0.000    0.001    0.000 contextlib.py:157(helper)
      400    0.001    0.000    0.001    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      400    0.001    0.000    0.001    0.000 {built-in method torch._C._get_tracing_state}
      400    0.000    0.000    0.001    0.000 contextlib.py:59(__init__)
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      200    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      400    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      400    0.000    0.000    0.000    0.000 base.py:54(trainer)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
      400    0.000    0.000    0.000    0.000 precision_plugin.py:227(forward_context)
      200    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
      200    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
      200    0.000    0.000    0.000    0.000 training_type_plugin.py:215(post_training_step)
      200    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}



Profile stats for: training_step_end
         3600 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      600    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
      400    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      400    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      200    0.000    0.000    0.000    0.000 lightning.py:696(training_step_end)
      200    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 training_type_plugin.py:227(training_step_end)
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: zero_grad
         2900 function calls in 0.015 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.000    0.000    0.015    0.000 optimizer_loop.py:311(zero_grad_fn)
      100    0.000    0.000    0.015    0.000 optimizer_loop.py:391(_on_before_zero_grad)
      100    0.000    0.000    0.014    0.000 trainer.py:1481(call_hook)
      100    0.000    0.000    0.012    0.000 contextlib.py:79(__enter__)
      100    0.000    0.000    0.012    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.012    0.000 base.py:68(profile)
      100    0.000    0.000    0.012    0.000 advanced.py:61(start)
      100    0.012    0.000    0.012    0.000 {method 'enable' of '_lsprof.Profiler' objects}
      100    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
      100    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      100    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      100    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      400    0.000    0.000    0.001    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      100    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
      100    0.000    0.000    0.000    0.000 contextlib.py:157(helper)
      100    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
      100    0.000    0.000    0.000    0.000 progress.py:126(increment_ready)
      200    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      100    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      300    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 base.py:54(trainer)



Profile stats for: on_before_zero_grad
         2600 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.000    0.000    0.001    0.000 callback_hook.py:309(on_before_zero_grad)
      100    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
      100    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
      100    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
      100    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
      100    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 base.py:68(profile)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      100    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      100    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      200    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      100    0.000    0.000    0.000    0.000 base.py:329(on_before_zero_grad)
      100    0.000    0.000    0.000    0.000 hooks.py:220(on_before_zero_grad)
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: backward
         7800 function calls in 0.474 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.000    0.000    0.474    0.002 optimizer_loop.py:326(backward_fn)
      200    0.000    0.000    0.474    0.002 accelerator.py:305(backward)
      200    0.000    0.000    0.472    0.002 precision_plugin.py:64(pre_backward)
      200    0.001    0.000    0.472    0.002 trainer.py:1481(call_hook)
      200    0.000    0.000    0.469    0.002 contextlib.py:79(__enter__)
      200    0.000    0.000    0.469    0.002 {built-in method builtins.next}
      200    0.000    0.000    0.469    0.002 base.py:68(profile)
      200    0.000    0.000    0.469    0.002 advanced.py:61(start)
      200    0.469    0.002    0.469    0.002 {method 'enable' of '_lsprof.Profiler' objects}
      400    0.000    0.000    0.002    0.000 accelerator.py:172(lightning_module)
      400    0.000    0.000    0.002    0.000 training_type_plugin.py:171(lightning_module)
      400    0.000    0.000    0.002    0.000 base.py:104(unwrap_lightning_module)
     1200    0.001    0.000    0.002    0.000 {built-in method builtins.isinstance}
      400    0.001    0.000    0.001    0.000 abc.py:180(__instancecheck__)
      200    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
      200    0.001    0.000    0.001    0.000 module.py:1180(__setattr__)
      200    0.000    0.000    0.000    0.000 contextlib.py:157(helper)
      800    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      200    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
      400    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      600    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 base.py:54(trainer)
      200    0.000    0.000    0.000    0.000 training_type_plugin.py:156(pre_backward)



Profile stats for: on_before_backward
         5200 function calls in 0.002 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.000    0.000    0.001    0.000 callback_hook.py:294(on_before_backward)
      200    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
      200    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      200    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      200    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      200    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      200    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      400    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      400    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      200    0.000    0.000    0.000    0.000 base.py:315(on_before_backward)
      200    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 hooks.py:240(on_before_backward)
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_after_backward
         5200 function calls in 0.004 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.001    0.000    0.002    0.000 callback_hook.py:299(on_after_backward)
      200    0.000    0.000    0.002    0.000 trainer.py:1686(lightning_module)
      200    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      200    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      200    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      400    0.000    0.000    0.001    0.000 {built-in method builtins.isinstance}
      200    0.000    0.000    0.001    0.000 contextlib.py:85(__exit__)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      200    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      400    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      400    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      200    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 base.py:319(on_after_backward)
      200    0.000    0.000    0.000    0.000 hooks.py:248(on_after_backward)
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_end
         144434 function calls (143334 primitive calls) in 0.108 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.001    0.000    0.106    0.001 callback_hook.py:175(on_train_batch_end)
      200    0.002    0.000    0.091    0.000 lr_finder.py:339(on_train_batch_end)
      100    0.000    0.000    0.086    0.001 notebook.py:267(update)
      100    0.001    0.000    0.085    0.001 std.py:1212(update)
       50    0.000    0.000    0.084    0.002 std.py:1339(refresh)
       50    0.001    0.000    0.083    0.002 notebook.py:149(display)
      150    0.000    0.000    0.077    0.001 traitlets.py:576(__set__)
      150    0.000    0.000    0.077    0.001 traitlets.py:558(set)
      150    0.000    0.000    0.075    0.000 traitlets.py:1133(_notify_trait)
      150    0.001    0.000    0.074    0.000 widget.py:676(notify_change)
      150    0.001    0.000    0.070    0.000 widget.py:538(send_state)
      150    0.000    0.000    0.039    0.000 widget.py:814(_send)
      150    0.000    0.000    0.038    0.000 comm.py:120(send)
      150    0.001    0.000    0.038    0.000 comm.py:61(_publish_msg)
      150    0.001    0.000    0.030    0.000 widget.py:557(get_state)
      150    0.001    0.000    0.028    0.000 traitlets.py:1407(traits)
      150    0.002    0.000    0.026    0.000 session.py:749(send)
      150    0.005    0.000    0.023    0.000 traitlets.py:224(getmembers)
      150    0.001    0.000    0.015    0.000 session.py:685(serialize)
      200    0.001    0.000    0.013    0.000 signature_utils.py:18(is_param_in_hook_signature)
      200    0.000    0.000    0.012    0.000 inspect.py:3063(signature)
      200    0.000    0.000    0.012    0.000 inspect.py:2811(from_callable)
  400/200    0.001    0.000    0.011    0.000 inspect.py:2183(_signature_from_callable)
      600    0.001    0.000    0.011    0.000 session.py:95(json_packer)
      150    0.010    0.000    0.010    0.000 {built-in method builtins.dir}
      600    0.002    0.000    0.010    0.000 __init__.py:183(dumps)
 1200/300    0.004    0.000    0.009    0.000 jsonutil.py:73(json_clean)
    31502    0.005    0.000    0.008    0.000 {built-in method builtins.isinstance}
      600    0.001    0.000    0.008    0.000 encoder.py:182(encode)
      200    0.002    0.000    0.007    0.000 inspect.py:2102(_signature_from_function)
    18851    0.006    0.000    0.007    0.000 {built-in method builtins.getattr}
      600    0.004    0.000    0.007    0.000 encoder.py:204(iterencode)
      150    0.000    0.000    0.005    0.000 iostream.py:260(send_multipart)
      150    0.000    0.000    0.004    0.000 iostream.py:207(send_multipart)
      150    0.002    0.000    0.004    0.000 traitlets.py:1421(<listcomp>)
      150    0.001    0.000    0.004    0.000 iostream.py:195(schedule)
     9150    0.002    0.000    0.004    0.000 traitlets.py:545(__get__)
     2600    0.002    0.000    0.004    0.000 abc.py:180(__instancecheck__)
      150    0.001    0.000    0.003    0.000 session.py:644(msg)
       50    0.002    0.000    0.003    0.000 std.py:355(format_meter)
      150    0.001    0.000    0.003    0.000 session.py:670(sign)
      400    0.002    0.000    0.003    0.000 inspect.py:2732(__init__)
      300    0.001    0.000    0.003    0.000 jsonutil.py:108(json_default)
      100    0.003    0.000    0.003    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      150    0.003    0.000    0.003    0.000 socket.py:480(send)
      200    0.001    0.000    0.003    0.000 inspect.py:1787(_signature_bound_method)
     1200    0.001    0.000    0.003    0.000 inspect.py:2452(__init__)
      150    0.000    0.000    0.003    0.000 session.py:641(msg_header)
      300    0.002    0.000    0.002    0.000 {method 'isoformat' of 'datetime.datetime' objects}
      150    0.001    0.000    0.002    0.000 traitlets.py:1142(notify_change)
     5550    0.002    0.000    0.002    0.000 traitlets.py:526(get)
     2760    0.002    0.000    0.002    0.000 {built-in method builtins.hasattr}
      151    0.000    0.000    0.002    0.000 traitlets.py:587(_validate)
      200    0.000    0.000    0.002    0.000 inspect.py:2825(replace)
     5150    0.002    0.000    0.002    0.000 _weakrefset.py:70(__contains__)
      200    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
    19600    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
      150    0.000    0.000    0.001    0.000 session.py:271(msg_header)
      200    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
       50    0.000    0.000    0.001    0.000 std.py:1460(format_dict)
      300    0.001    0.000    0.001    0.000 traitlets.py:1439(trait_metadata)
      150    0.000    0.000    0.001    0.000 widget.py:724(_should_send_property)
      200    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      150    0.000    0.000    0.001    0.000 session.py:199(utcnow)
      151    0.000    0.000    0.001    0.000 traitlets.py:596(_cross_validate)
      200    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      100    0.001    0.000    0.001    0.000 supporters.py:66(last)
     1200    0.001    0.000    0.001    0.000 enum.py:267(__call__)
      150    0.001    0.000    0.001    0.000 {method 'sort' of 'list' objects}
      600    0.000    0.000    0.001    0.000 hmac.py:90(update)
      150    0.000    0.000    0.001    0.000 session.py:597(msg_id)
      150    0.000    0.000    0.001    0.000 hmac.py:127(hexdigest)
      350    0.001    0.000    0.001    0.000 {method 'format' of 'str' objects}
      150    0.000    0.000    0.001    0.000 hmac.py:95(copy)
      150    0.000    0.000    0.001    0.000 threading.py:1104(is_alive)
      200    0.000    0.000    0.001    0.000 inspect.py:485(unwrap)
      750    0.001    0.000    0.001    0.000 {method 'update' of '_hashlib.HASH' objects}
      200    0.000    0.000    0.001    0.000 contextlib.py:85(__exit__)
       50    0.000    0.000    0.001    0.000 notebook.py:200(colour)
      150    0.000    0.000    0.001    0.000 widget.py:138(_remove_buffers)
     1400    0.000    0.000    0.001    0.000 inspect.py:2781(<genexpr>)
      150    0.001    0.000    0.001    0.000 {method 'replace' of 'datetime.datetime' objects}
     3258    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      600    0.000    0.000    0.000    0.000 encoder.py:104(__init__)
      100    0.000    0.000    0.000    0.000 std.py:288(format_interval)
      150    0.000    0.000    0.000    0.000 widget.py:93(_separate_buffers)
       50    0.000    0.000    0.000    0.000 re.py:204(split)
      150    0.000    0.000    0.000    0.000 hmac.py:108(_current)
      300    0.000    0.000    0.000    0.000 std.py:233(__call__)
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
      850    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
      750    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
       50    0.000    0.000    0.000    0.000 {built-in method now}
      450    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
       50    0.000    0.000    0.000    0.000 std.py:104(acquire)
       50    0.000    0.000    0.000    0.000 traitlets.py:904(__call__)
      150    0.000    0.000    0.000    0.000 session.py:844(<listcomp>)
      150    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
      300    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      200    0.000    0.000    0.000    0.000 fit_loop.py:80(batch_idx)
     2551    0.000    0.000    0.000    0.000 {built-in method builtins.len}
      150    0.000    0.000    0.000    0.000 tz.py:218(utcoffset)
       50    0.000    0.000    0.000    0.000 {method 'split' of '_sre.SRE_Pattern' objects}
      200    0.000    0.000    0.000    0.000 inspect.py:505(_is_wrapper)
      100    0.000    0.000    0.000    0.000 __init__.py:12(escape)
     1200    0.000    0.000    0.000    0.000 enum.py:517(__new__)
       50    0.000    0.000    0.000    0.000 traitlets.py:1983(validate)
     2200    0.000    0.000    0.000    0.000 inspect.py:2502(name)
      300    0.000    0.000    0.000    0.000 bunch.py:11(__getattr__)
      200    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       50    0.000    0.000    0.000    0.000 widget_float.py:33(_validate_value)
       50    0.000    0.000    0.000    0.000 std.py:108(release)
      150    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
     1200    0.000    0.000    0.000    0.000 {method 'isidentifier' of 'str' objects}
      150    0.000    0.000    0.000    0.000 {built-in method utcnow}
      100    0.000    0.000    0.000    0.000 trainer.py:2031(global_step)
      150    0.000    0.000    0.000    0.000 {built-in method builtins.locals}
      400    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      400    0.000    0.000    0.000    0.000 inspect.py:159(isfunction)
      150    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
      300    0.000    0.000    0.000    0.000 jsonutil.py:39(_ensure_tzinfo)
     1400    0.000    0.000    0.000    0.000 inspect.py:2514(kind)
      150    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
      150    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
      200    0.000    0.000    0.000    0.000 training_epoch_loop.py:81(batch_idx)
      150    0.000    0.000    0.000    0.000 session.py:278(extract_header)
      400    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
      150    0.000    0.000    0.000    0.000 {built-in method builtins.max}
      900    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
     1000    0.000    0.000    0.000    0.000 inspect.py:2506(default)
       50    0.000    0.000    0.000    0.000 re.py:286(_compile)
      750    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
      100    0.000    0.000    0.000    0.000 traitlets.py:2045(validate)
      100    0.000    0.000    0.000    0.000 fit_loop.py:123(running_loss)
      600    0.000    0.000    0.000    0.000 traitlets.py:911(__get__)
       50    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
      250    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
      600    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
      800    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       50    0.000    0.000    0.000    0.000 traitlets.py:1832(_validate_bounds)
      150    0.000    0.000    0.000    0.000 tz.py:262(_isdst)
       50    0.000    0.000    0.000    0.000 utils.py:57(__init__)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
      200    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
      150    0.000    0.000    0.000    0.000 threading.py:506(is_set)
      300    0.000    0.000    0.000    0.000 {method '__getitem__' of 'dict' objects}
      400    0.000    0.000    0.000    0.000 inspect.py:2817(parameters)
      100    0.000    0.000    0.000    0.000 std.py:1116(__bool__)
      150    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
      200    0.000    0.000    0.000    0.000 hooks.py:93(on_train_batch_end)
      151    0.000    0.000    0.000    0.000 {built-in method time.time}
      151    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       50    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
      150    0.000    0.000    0.000    0.000 jsonutil.py:131(<listcomp>)
      150    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
      200    0.000    0.000    0.000    0.000 {built-in method sys.getrecursionlimit}
      100    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       50    0.000    0.000    0.000    0.000 {built-in method math.isnan}
      150    0.000    0.000    0.000    0.000 widget.py:779(_trait_to_json)
       50    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
       50    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
       50    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        1    0.000    0.000    0.000    0.000 traitlets.py:486(_dynamic_default_callable)
        1    0.000    0.000    0.000    0.000 traitlets.py:2528(validate)
        1    0.000    0.000    0.000    0.000 traitlets.py:2535(validate_elements)
        1    0.000    0.000    0.000    0.000 traitlets.py:419(__init__)
        1    0.000    0.000    0.000    0.000 {method 'mro' of 'type' objects}
        1    0.000    0.000    0.000    0.000 {method 'index' of 'list' objects}
        1    0.000    0.000    0.000    0.000 traitlets.py:1673(validate)
        1    0.000    0.000    0.000    0.000 traitlets.py:1698(make_dynamic_default)



Profile stats for: on_batch_end
         5400 function calls in 0.003 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      200    0.000    0.000    0.001    0.000 callback_hook.py:160(on_batch_end)
      400    0.000    0.000    0.001    0.000 {built-in method builtins.getattr}
      200    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
      200    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      200    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      200    0.000    0.000    0.001    0.000 module.py:1164(__getattr__)
      200    0.000    0.000    0.001    0.000 base.py:104(unwrap_lightning_module)
      400    0.000    0.000    0.001    0.000 {built-in method builtins.isinstance}
      200    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
      200    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      200    0.000    0.000    0.000    0.000 base.py:68(profile)
      200    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      200    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      400    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      200    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      400    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      400    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      200    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 base.py:226(on_batch_end)
      200    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: optimizer_step_with_closure_0
         4200 function calls in 1.399 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.000    0.000    1.399    0.014 accelerator.py:321(optimizer_step)
      100    0.000    0.000    1.398    0.014 precision_plugin.py:152(optimizer_step)
      100    0.000    0.000    1.397    0.014 lr_scheduler.py:60(wrapper)
      100    0.001    0.000    1.397    0.014 optimizer.py:83(wrapper)
      100    0.000    0.000    1.393    0.014 grad_mode.py:25(decorate_context)
      100    0.000    0.000    1.392    0.014 adam.py:81(step)
      100    0.000    0.000    1.391    0.014 precision_plugin.py:135(_wrap_closure)
      100    0.000    0.000    1.391    0.014 optimizer_loop.py:159(__call__)
      100    0.000    0.000    1.391    0.014 optimizer_loop.py:140(closure)
      100    0.000    0.000    1.391    0.014 contextlib.py:79(__enter__)
      100    0.000    0.000    1.391    0.014 {built-in method builtins.next}
      100    0.000    0.000    1.391    0.014 base.py:68(profile)
      100    0.000    0.000    1.391    0.014 advanced.py:61(start)
      100    1.391    0.014    1.391    0.014 {method 'enable' of '_lsprof.Profiler' objects}
      100    0.000    0.000    0.002    0.000 profiler.py:434(__enter__)
      100    0.000    0.000    0.001    0.000 profiler.py:426(__init__)
      100    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter}
      100    0.001    0.000    0.001    0.000 {built-in method zeros}
      100    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      100    0.000    0.000    0.001    0.000 training_type_plugin.py:171(lightning_module)
      100    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      100    0.000    0.000    0.000    0.000 grad_mode.py:124(__enter__)
      300    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 contextlib.py:157(helper)
      100    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
      100    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      100    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
      100    0.000    0.000    0.000    0.000 grad_mode.py:213(__init__)
      100    0.000    0.000    0.000    0.000 grad_mode.py:167(__enter__)
      100    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
      300    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
      200    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      200    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
      100    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      100    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)



Profile stats for: on_before_optimizer_step
         2600 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      100    0.000    0.000    0.001    0.000 callback_hook.py:304(on_before_optimizer_step)
      100    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
      100    0.000    0.000    0.001    0.000 accelerator.py:172(lightning_module)
      100    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
      100    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      200    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
      100    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
      100    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 base.py:68(profile)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      100    0.000    0.000    0.000    0.000 advanced.py:66(stop)
      100    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
      200    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      200    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      100    0.000    0.000    0.000    0.000 base.py:323(on_before_optimizer_step)
      100    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
      200    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
      100    0.000    0.000    0.000    0.000 hooks.py:256(on_before_optimizer_step)
      100    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_epoch_end
         26 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:90(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 base.py:126(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:193(on_train_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_epoch_end
         26 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:130(on_epoch_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:187(on_epoch_end)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 base.py:164(on_epoch_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_end
         30 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:140(on_train_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 base.py:234(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:347(on_train_end)
        3    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:43(on_train_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)



Profile stats for: teardown
         23 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:50(teardown)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 base.py:71(teardown)
        1    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 hooks.py:399(teardown)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)


FIT Profiler Report
Profile stats for: configure_callbacks
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 lightning.py:1199(configure_callbacks)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: prepare_data
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:325(prepare_data)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)



Profile stats for: on_before_accelerator_backend_setup
         1494 function calls (1281 primitive calls) in 0.031 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.031    0.031 callback_hook.py:35(on_before_accelerator_backend_setup)
        1    0.000    0.000    0.031    0.031 stochastic_weight_avg.py:139(on_before_accelerator_backend_setup)
    179/1    0.001    0.000    0.031    0.031 copy.py:132(deepcopy)
     27/1    0.000    0.000    0.031    0.031 copy.py:268(_reconstruct)
      8/1    0.000    0.000    0.031    0.031 copy.py:236(_deepcopy_dict)
        6    0.021    0.003    0.021    0.003 {method '__deepcopy__' of 'numpy.ndarray' objects}
        5    0.000    0.000    0.008    0.002 parameter.py:28(__deepcopy__)
        5    0.008    0.002    0.008    0.002 {method 'clone' of 'torch._C._TensorBase' objects}
       70    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       28    0.000    0.000    0.000    0.000 {method '__reduce_ex__' of 'object' objects}
      392    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 parameter.py:23(__new__)
       50    0.000    0.000    0.000    0.000 copy.py:252(_keep_alive)
       22    0.000    0.000    0.000    0.000 copy.py:273(<genexpr>)
      4/3    0.000    0.000    0.000    0.000 copy.py:219(_deepcopy_tuple)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        7    0.000    0.000    0.000    0.000 copyreg.py:87(__newobj__)
        5    0.000    0.000    0.000    0.000 {built-in method _make_subclass}
      281    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
      4/3    0.000    0.000    0.000    0.000 copy.py:220(<listcomp>)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       45    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        7    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        4    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        2    0.000    0.000    0.000    0.000 lightning.py:2029(_prevent_trainer_and_dataloaders_deepcopy)
        4    0.000    0.000    0.000    0.000 parsing.py:270(__getattr__)
      125    0.000    0.000    0.000    0.000 copy.py:190(_deepcopy_atomic)
        2    0.000    0.000    0.000    0.000 module.py:1150(__setstate__)
        2    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        3    0.000    0.000    0.000    0.000 dataset.py:78(__getattr__)
        2    0.000    0.000    0.000    0.000 typing.py:2008(__new__)
       42    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
       49    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        1    0.000    0.000    0.000    0.000 lightning.py:2035(__getstate__)
        1    0.000    0.000    0.000    0.000 contextlib.py:79(__enter__)
        6    0.000    0.000    0.000    0.000 base.py:673(__getattr__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 typing.py:1180(_generic_new)
        5    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        4    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        6    0.000    0.000    0.000    0.000 typing.py:1096(__hash__)
        1    0.000    0.000    0.000    0.000 typing.py:1227(__new__)
        1    0.000    0.000    0.000    0.000 contextlib.py:157(helper)
        2    0.000    0.000    0.000    0.000 copy.py:210(_deepcopy_list)
        8    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        7    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
        4    0.000    0.000    0.000    0.000 base.py:63(on_before_accelerator_backend_setup)
        1    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
        4    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method '__setstate__' of 'functools.partial' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}



Profile stats for: setup
         67 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:45(setup)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        5    0.000    0.000    0.000    0.000 base.py:67(setup)
        5    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:373(setup)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_sharded_model
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:298(configure_sharded_model)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_configure_sharded_model
         71 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:40(on_configure_sharded_model)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 module.py:1164(__getattr__)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        5    0.000    0.000    0.000    0.000 base.py:60(on_configure_sharded_model)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: configure_optimizers
         140 function calls (138 primitive calls) in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 <ipython-input-27-c9e80d243a57>:35(configure_optimizers)
        1    0.000    0.000    0.000    0.000 adam.py:60(__init__)
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
        6    0.000    0.000    0.000    0.000 module.py:1499(parameters)
        6    0.000    0.000    0.000    0.000 module.py:1523(named_parameters)
        6    0.000    0.000    0.000    0.000 module.py:1486(_named_members)
        1    0.000    0.000    0.000    0.000 optimizer.py:232(add_param_group)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
       20    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        1    0.000    0.000    0.000    0.000 optimizer.py:78(_hook_for_profile)
      5/3    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        7    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        3    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
        2    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        5    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {method 'isdisjoint' of 'set' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       20    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}



Profile stats for: on_fit_start
         100 function calls (98 primitive calls) in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:65(on_fit_start)
        1    0.000    0.000    0.000    0.000 stochastic_weight_avg.py:144(on_fit_start)
        1    0.000    0.000    0.000    0.000 stochastic_weight_avg.py:135(pl_module_contains_batch_norm)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.any}
        3    0.000    0.000    0.000    0.000 stochastic_weight_avg.py:137(<genexpr>)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       13    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 module.py:1626(modules)
      5/3    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        8    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 trainer.py:2039(max_epochs)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 trainer.py:1690(optimizers)
        1    0.000    0.000    0.000    0.000 trainer.py:1703(lr_schedulers)
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        2    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 hooks.py:28(on_fit_start)
        4    0.000    0.000    0.000    0.000 base.py:83(on_fit_start)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_pretrain_routine_start
         872 function calls (866 primitive calls) in 0.003 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.003    0.003 callback_hook.py:145(on_pretrain_routine_start)
        1    0.000    0.000    0.002    0.002 model_summary.py:52(on_pretrain_routine_start)
        1    0.000    0.000    0.002    0.002 model_summary.py:65(summarize)
        1    0.000    0.000    0.002    0.002 __init__.py:1298(info)
        1    0.000    0.000    0.002    0.002 __init__.py:1421(_log)
        1    0.000    0.000    0.001    0.001 __init__.py:1446(handle)
        1    0.000    0.000    0.001    0.001 __init__.py:1500(callHandlers)
        1    0.000    0.000    0.001    0.001 __init__.py:852(handle)
        1    0.000    0.000    0.001    0.001 __init__.py:982(emit)
        1    0.000    0.000    0.001    0.001 __init__.py:971(flush)
        1    0.000    0.000    0.001    0.001 iostream.py:335(flush)
        1    0.000    0.000    0.001    0.001 threading.py:533(wait)
        1    0.000    0.000    0.001    0.001 threading.py:263(wait)
       10    0.001    0.000    0.001    0.000 {method 'acquire' of '_thread.lock' objects}
        1    0.000    0.000    0.001    0.001 model_checkpoint.py:271(on_pretrain_routine_start)
        1    0.000    0.000    0.001    0.001 model_checkpoint.py:590(__resolve_ckpt_dir)
        1    0.000    0.000    0.001    0.001 local.py:45(makedirs)
        1    0.000    0.000    0.001    0.001 os.py:195(makedirs)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.000    0.000 model_summary.py:307(_get_summary_data)
        1    0.000    0.000    0.000    0.000 {built-in method posix.mkdir}
        2    0.000    0.000    0.000    0.000 iostream.py:384(write)
        5    0.000    0.000    0.000    0.000 iostream.py:195(schedule)
        1    0.000    0.000    0.000    0.000 model_summary.py:246(param_nums)
        1    0.000    0.000    0.000    0.000 model_summary.py:248(<listcomp>)
        1    0.000    0.000    0.000    0.000 model_summary.py:124(num_parameters)
        5    0.000    0.000    0.000    0.000 socket.py:480(send)
        6    0.000    0.000    0.000    0.000 model_summary.py:127(<genexpr>)
        2    0.000    0.000    0.000    0.000 iostream.py:321(_schedule_flush)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:629(__warn_if_dir_not_empty)
        5    0.000    0.000    0.000    0.000 <__array_function__ internals>:2(prod)
        1    0.000    0.000    0.000    0.000 local.py:53(ls)
        1    0.000    0.000    0.000    0.000 {built-in method posix.listdir}
        5    0.000    0.000    0.000    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}
        2    0.000    0.000    0.000    0.000 {built-in method posix.stat}
        5    0.000    0.000    0.000    0.000 fromnumeric.py:2881(prod)
        1    0.000    0.000    0.000    0.000 genericpath.py:16(exists)
        5    0.000    0.000    0.000    0.000 fromnumeric.py:70(_wrapreduction)
       24    0.000    0.000    0.000    0.000 module.py:1499(parameters)
        1    0.000    0.000    0.000    0.000 model_summary.py:446(summarize)
       24    0.000    0.000    0.000    0.000 module.py:1523(named_parameters)
        2    0.000    0.000    0.000    0.000 model_summary.py:250(total_parameters)
        1    0.000    0.000    0.000    0.000 model_summary.py:191(__init__)
        4    0.000    0.000    0.000    0.000 model_summary.py:396(get_human_readable_count)
       12    0.000    0.000    0.000    0.000 model_summary.py:252(<genexpr>)
        1    0.000    0.000    0.000    0.000 model_summary.py:348(_format_summary_table)
        5    0.000    0.000    0.000    0.000 {method 'reduce' of 'numpy.ufunc' objects}
       24    0.000    0.000    0.000    0.000 module.py:1486(_named_members)
        1    0.000    0.000    0.000    0.000 model_summary.py:265(summarize)
       20    0.000    0.000    0.000    0.000 model_summary.py:433(_is_lazy_weight_tensor)
        2    0.000    0.000    0.000    0.000 model_summary.py:266(<genexpr>)
        1    0.000    0.000    0.000    0.000 trainer.py:1859(weights_save_path)
        2    0.000    0.000    0.000    0.000 cloud_io.py:41(get_filesystem)
        1    0.000    0.000    0.000    0.000 __init__.py:1406(makeRecord)
        1    0.000    0.000    0.000    0.000 model_summary.py:70(__init__)
        1    0.000    0.000    0.000    0.000 __init__.py:251(__init__)
        1    0.000    0.000    0.000    0.000 model_summary.py:254(trainable_parameters)
        2    0.000    0.000    0.000    0.000 spec.py:53(__call__)
        1    0.000    0.000    0.000    0.000 model_summary.py:80(_register_hook)
        1    0.000    0.000    0.000    0.000 model_summary.py:260(model_size)
       52    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        6    0.000    0.000    0.000    0.000 model_summary.py:257(<genexpr>)
        1    0.000    0.000    0.000    0.000 spec.py:622(isdir)
        1    0.000    0.000    0.000    0.000 local.py:65(info)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
       40    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        1    0.000    0.000    0.000    0.000 module.py:1053(register_forward_hook)
       20    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       24    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1849(default_root_dir)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       28    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        6    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        2    0.000    0.000    0.000    0.000 utils.py:271(tokenize)
        2    0.000    0.000    0.000    0.000 posixpath.py:338(normpath)
        6    0.000    0.000    0.000    0.000 threading.py:1104(is_alive)
    17/11    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        3    0.000    0.000    0.000    0.000 local.py:182(_strip_protocol)
        1    0.000    0.000    0.000    0.000 __init__.py:829(format)
        1    0.000    0.000    0.000    0.000 __init__.py:1376(findCaller)
        1    0.000    0.000    0.000    0.000 __init__.py:564(format)
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        6    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
       12    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 model_summary.py:103(detach_hook)
        1    0.000    0.000    0.000    0.000 model_summary.py:217(named_modules)
        1    0.000    0.000    0.000    0.000 hooks.py:15(__init__)
        1    0.000    0.000    0.000    0.000 threading.py:498(__init__)
        2    0.000    0.000    0.000    0.000 trainer.py:1777(is_global_zero)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 posixpath.py:75(join)
        5    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
       11    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       40    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        1    0.000    0.000    0.000    0.000 model_summary.py:369(<listcomp>)
        8    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        2    0.000    0.000    0.000    0.000 config.py:66(apply_config)
        7    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
        2    0.000    0.000    0.000    0.000 module.py:1606(named_children)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        5    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        3    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
        1    0.000    0.000    0.000    0.000 model_summary.py:234(layer_types)
        1    0.000    0.000    0.000    0.000 threading.py:215(__init__)
        1    0.000    0.000    0.000    0.000 posixpath.py:104(split)
        1    0.000    0.000    0.000    0.000 posixpath.py:121(splitext)
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        2    0.000    0.000    0.000    0.000 hooks.py:20(remove)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 __init__.py:542(usesTime)
        2    0.000    0.000    0.000    0.000 __init__.py:809(acquire)
        1    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
        1    0.000    0.000    0.000    0.000 posixpath.py:144(basename)
       15    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
        2    0.000    0.000    0.000    0.000 trainer.py:1623(global_rank)
        1    0.000    0.000    0.000    0.000 model_summary.py:77(__del__)
        1    0.000    0.000    0.000    0.000 model_summary.py:230(layer_names)
        1    0.000    0.000    0.000    0.000 model_summary.py:274(<listcomp>)
        8    0.000    0.000    0.000    0.000 model_summary.py:362(<genexpr>)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        5    0.000    0.000    0.000    0.000 fromnumeric.py:71(<dictcomp>)
        2    0.000    0.000    0.000    0.000 iostream.py:308(_is_master_process)
        1    0.000    0.000    0.000    0.000 __init__.py:157(<lambda>)
        1    0.000    0.000    0.000    0.000 posixpath.py:52(normcase)
       18    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        2    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
        7    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
       40    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.min}
       15    0.000    0.000    0.000    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 model_summary.py:236(<listcomp>)
        5    0.000    0.000    0.000    0.000 fromnumeric.py:2876(_prod_dispatcher)
        5    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
        2    0.000    0.000    0.000    0.000 {built-in method _hashlib.openssl_md5}
        1    0.000    0.000    0.000    0.000 __init__.py:120(getLevelName)
        1    0.000    0.000    0.000    0.000 __init__.py:387(usesTime)
        1    0.000    0.000    0.000    0.000 __init__.py:548(formatMessage)
        1    0.000    0.000    0.000    0.000 threading.py:239(__enter__)
        3    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
        4    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
       13    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        2    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        4    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
        2    0.000    0.000    0.000    0.000 lightning.py:186(example_input_array)
        1    0.000    0.000    0.000    0.000 model_summary.py:119(layer_type)
        3    0.000    0.000    0.000    0.000 utils.py:291(stringify_path)
        2    0.000    0.000    0.000    0.000 spec.py:56(<genexpr>)
        1    0.000    0.000    0.000    0.000 __init__.py:329(getMessage)
        2    0.000    0.000    0.000    0.000 __init__.py:705(filter)
        2    0.000    0.000    0.000    0.000 __init__.py:816(release)
        1    0.000    0.000    0.000    0.000 __init__.py:1530(getEffectiveLevel)
        1    0.000    0.000    0.000    0.000 threading.py:242(__exit__)
        1    0.000    0.000    0.000    0.000 threading.py:248(_release_save)
        1    0.000    0.000    0.000    0.000 genericpath.py:117(_splitext)
        1    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
        3    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        5    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'find' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISLNK}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method sys._getframe}
        1    0.000    0.000    0.000    0.000 tensorboard.py:137(save_dir)
        2    0.000    0.000    0.000    0.000 tensorboard.py:281(version)
        1    0.000    0.000    0.000    0.000 model_summary.py:392(get_formatted_model_size)
        3    0.000    0.000    0.000    0.000 base.py:238(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 process.py:35(current_process)
        1    0.000    0.000    0.000    0.000 process.py:146(name)
        2    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 __init__.py:390(format)
        1    0.000    0.000    0.000    0.000 threading.py:251(_acquire_restore)
        1    0.000    0.000    0.000    0.000 threading.py:254(_is_owned)
        6    0.000    0.000    0.000    0.000 threading.py:506(is_set)
        1    0.000    0.000    0.000    0.000 threading.py:1076(name)
        1    0.000    0.000    0.000    0.000 threading.py:1230(current_thread)
        2    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'count' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
        1    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method _imp.lock_held}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       17    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 tensorboard.py:272(name)
        1    0.000    0.000    0.000    0.000 single_device.py:80(broadcast)
        1    0.000    0.000    0.000    0.000 hooks.py:64(on_pretrain_routine_start)
        1    0.000    0.000    0.000    0.000 local.py:59(<listcomp>)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_pretrain_routine_end
         70 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:150(on_pretrain_routine_end)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        5    0.000    0.000    0.000    0.000 base.py:242(on_pretrain_routine_end)
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:73(on_pretrain_routine_end)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:620(on_train_dataloader)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: train_dataloader
         70 function calls (66 primitive calls) in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 <ipython-input-27-c9e80d243a57>:27(train_dataloader)
        1    0.000    0.000    0.001    0.001 <ipython-input-25-7c502df9f0ea>:5(__init__)
        1    0.000    0.000    0.000    0.000 _tensor.py:25(wrapped)
        1    0.000    0.000    0.000    0.000 {method 'prod' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 dataloader.py:162(__init__)
        1    0.000    0.000    0.000    0.000 {method 'round' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {method 'int' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 {built-in method tensor}
      4/1    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 typing.py:1156(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
    19/18    0.000    0.000    0.000    0.000 dataloader.py:336(__setattr__)
        1    0.000    0.000    0.000    0.000 typing.py:1145(__subclasscheck__)
        1    0.000    0.000    0.000    0.000 abc.py:196(__subclasscheck__)
        2    0.000    0.000    0.000    0.000 typing.py:1227(__new__)
        2    0.000    0.000    0.000    0.000 typing.py:1180(_generic_new)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C.set_vital}
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 dataloader.py:311(multiprocessing_context)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 <ipython-input-24-45860f993673>:18(shape)
        1    0.000    0.000    0.000    0.000 dataloader.py:406(check_worker_number_rationality)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._log_api_usage_once}
        1    0.000    0.000    0.000    0.000 typing.py:1033(_abc_negative_cache_version)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function}
        1    0.000    0.000    0.000    0.000 base.py:80(get_shape)
        1    0.000    0.000    0.000    0.000 typing.py:1019(_abc_negative_cache)
        1    0.000    0.000    0.000    0.000 typing.py:1089(__eq__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 dataloader.py:361(_auto_collation)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_start
         54684 function calls (46690 primitive calls) in 0.034 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.034    0.034 callback_hook.py:135(on_train_start)
        1    0.000    0.000    0.033    0.033 tqdm_progress.py:217(on_train_start)
        1    0.000    0.000    0.033    0.033 tqdm_progress.py:155(init_train_tqdm)
        1    0.000    0.000    0.033    0.033 tqdm_progress.py:35(__init__)
        1    0.000    0.000    0.033    0.033 notebook.py:210(__init__)
        1    0.000    0.000    0.029    0.029 notebook.py:104(status_printer)
     11/4    0.000    0.000    0.023    0.006 widget.py:474(__init__)
     11/4    0.000    0.000    0.023    0.006 widget.py:490(open)
    21/14    0.000    0.000    0.021    0.001 widget.py:557(get_state)
3228/1414    0.001    0.000    0.019    0.000 traitlets.py:545(__get__)
 1221/690    0.001    0.000    0.019    0.000 traitlets.py:526(get)
9365/4211    0.003    0.000    0.018    0.000 {built-in method builtins.getattr}
        7    0.000    0.000    0.016    0.002 trait_types.py:167(make_dynamic_default)
        2    0.000    0.000    0.012    0.006 widget_string.py:29(__init__)
       26    0.000    0.000    0.010    0.000 traitlets.py:950(__new__)
       26    0.000    0.000    0.010    0.000 traitlets.py:982(setup_instance)
       26    0.001    0.000    0.010    0.000 traitlets.py:961(setup_instance)
       11    0.000    0.000    0.008    0.001 comm.py:50(__init__)
       43    0.001    0.000    0.008    0.000 traitlets.py:1407(traits)
        1    0.000    0.000    0.008    0.008 widget_float.py:23(__init__)
       21    0.000    0.000    0.007    0.000 comm.py:61(_publish_msg)
    80/69    0.000    0.000    0.006    0.000 traitlets.py:576(__set__)
    93/82    0.000    0.000    0.006    0.000 traitlets.py:558(set)
      505    0.001    0.000    0.005    0.000 traitlets.py:516(instance_init)
       43    0.001    0.000    0.005    0.000 traitlets.py:224(getmembers)
    56/45    0.000    0.000    0.005    0.000 traitlets.py:1133(_notify_trait)
       11    0.000    0.000    0.005    0.000 comm.py:80(open)
       23    0.000    0.000    0.005    0.000 widget.py:676(notify_change)
       10    0.000    0.000    0.004    0.000 widget.py:538(send_state)
        1    0.000    0.000    0.004    0.004 widget_box.py:62(__init__)
       22    0.000    0.000    0.004    0.000 session.py:749(send)
       69    0.003    0.000    0.003    0.000 {built-in method builtins.dir}
       11    0.000    0.000    0.003    0.000 configurable.py:38(__init__)
      606    0.002    0.000    0.003    0.000 traitlets.py:486(_dynamic_default_callable)
       11    0.000    0.000    0.003    0.000 widget.py:461(_default_keys)
    11586    0.002    0.000    0.003    0.000 {built-in method builtins.isinstance}
   452/43    0.001    0.000    0.003    0.000 jsonutil.py:73(json_clean)
      2/1    0.000    0.000    0.003    0.003 display.py:131(display)
        1    0.000    0.000    0.003    0.003 formatters.py:89(format)
        1    0.000    0.000    0.003    0.003 decorator.py:229(fun)
        1    0.000    0.000    0.002    0.002 formatters.py:220(catch_format_error)
        1    0.000    0.000    0.002    0.002 formatters.py:903(__call__)
        1    0.000    0.000    0.002    0.002 widget.py:789(_ipython_display_)
       10    0.000    0.000    0.002    0.000 widget.py:814(_send)
       10    0.000    0.000    0.002    0.000 comm.py:120(send)
      164    0.000    0.000    0.002    0.000 traitlets.py:1690(instance_init)
       22    0.000    0.000    0.002    0.000 session.py:685(serialize)
       11    0.000    0.000    0.002    0.000 configurable.py:131(_load_config)
        1    0.000    0.000    0.002    0.002 display.py:81(publish_display_data)
        1    0.000    0.000    0.002    0.002 zmqshell.py:97(publish)
       88    0.000    0.000    0.002    0.000 session.py:95(json_packer)
        1    0.000    0.000    0.002    0.002 zmqshell.py:80(_flush_streams)
        2    0.000    0.000    0.002    0.001 iostream.py:335(flush)
       88    0.000    0.000    0.001    0.000 __init__.py:183(dumps)
        2    0.000    0.000    0.001    0.001 threading.py:533(wait)
       36    0.001    0.000    0.001    0.000 {method 'acquire' of '_thread.lock' objects}
        2    0.000    0.000    0.001    0.001 threading.py:263(wait)
        1    0.000    0.000    0.001    0.001 notebook.py:149(display)
       43    0.001    0.000    0.001    0.000 traitlets.py:1421(<listcomp>)
  519/513    0.000    0.000    0.001    0.000 traitlets.py:587(_validate)
       88    0.000    0.000    0.001    0.000 encoder.py:182(encode)
      543    0.000    0.000    0.001    0.000 contextlib.py:85(__exit__)
     1091    0.000    0.000    0.001    0.000 {built-in method builtins.next}
      907    0.001    0.000    0.001    0.000 abc.py:180(__instancecheck__)
       88    0.001    0.000    0.001    0.000 encoder.py:204(iterencode)
     2425    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
       26    0.000    0.000    0.001    0.000 traitlets.py:988(__init__)
    56/45    0.000    0.000    0.001    0.000 traitlets.py:1142(notify_change)
      542    0.000    0.000    0.001    0.000 contextlib.py:157(helper)
       26    0.000    0.000    0.001    0.000 iostream.py:195(schedule)
      281    0.000    0.000    0.001    0.000 traitlets.py:1439(trait_metadata)
       22    0.000    0.000    0.001    0.000 iostream.py:260(send_multipart)
       22    0.000    0.000    0.001    0.000 iostream.py:207(send_multipart)
       31    0.000    0.000    0.001    0.000 traitlets.py:2264(instance_init)
       74    0.000    0.000    0.001    0.000 traitlets.py:1067(hold_trait_notifications)
       50    0.000    0.000    0.001    0.000 traitlets.py:1698(make_dynamic_default)
       26    0.001    0.000    0.001    0.000 socket.py:480(send)
      542    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
      542    0.000    0.000    0.000    0.000 contextlib.py:79(__enter__)
       22    0.000    0.000    0.000    0.000 session.py:644(msg)
     1807    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
       11    0.000    0.000    0.000    0.000 manager.py:45(register_comm)
      4/1    0.000    0.000    0.000    0.000 widget.py:775(_handle_displayed)
      4/1    0.000    0.000    0.000    0.000 widget.py:201(__call__)
       33    0.000    0.000    0.000    0.000 traitlets.py:2566(instance_init)
        1    0.000    0.000    0.000    0.000 widget_box.py:67(_fire_children_displayed)
      601    0.000    0.000    0.000    0.000 {method 'mro' of 'type' objects}
       22    0.000    0.000    0.000    0.000 session.py:670(sign)
     5146    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
      157    0.000    0.000    0.000    0.000 traitlets.py:596(_cross_validate)
       44    0.000    0.000    0.000    0.000 jsonutil.py:108(json_default)
       11    0.000    0.000    0.000    0.000 configurable.py:106(_find_my_config)
       22    0.000    0.000    0.000    0.000 session.py:641(msg_header)
     2605    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 widget.py:505(_comm_changed)
       25    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
       11    0.000    0.000    0.000    0.000 comm.py:26(_default_comm_id)
       21    0.000    0.000    0.000    0.000 widget.py:138(_remove_buffers)
       44    0.000    0.000    0.000    0.000 {method 'isoformat' of 'datetime.datetime' objects}
    26/21    0.000    0.000    0.000    0.000 widget.py:93(_separate_buffers)
     1010    0.000    0.000    0.000    0.000 traitlets.py:1047(cross_validation_lock)
       43    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}
       11    0.000    0.000    0.000    0.000 uuid.py:621(uuid4)
       22    0.000    0.000    0.000    0.000 session.py:271(msg_header)
      601    0.000    0.000    0.000    0.000 {method 'index' of 'list' objects}
       11    0.000    0.000    0.000    0.000 comm.py:137(on_msg)
       10    0.000    0.000    0.000    0.000 widget.py:724(_should_send_property)
        1    0.000    0.000    0.000    0.000 widget.py:653(on_displayed)
       22    0.000    0.000    0.000    0.000 session.py:199(utcnow)
       22    0.000    0.000    0.000    0.000 traitlets.py:923(instance_init)
       15    0.000    0.000    0.000    0.000 traitlets.py:2323(validate)
      164    0.000    0.000    0.000    0.000 traitlets.py:1694(_resolve_classes)
        1    0.000    0.000    0.000    0.000 asyncio.py:23(__init__)
        1    0.000    0.000    0.000    0.000 std.py:846(__init__)
       21    0.000    0.000    0.000    0.000 traitlets.py:2235(validate)
       22    0.000    0.000    0.000    0.000 configurable.py:99(section_names)
       22    0.000    0.000    0.000    0.000 traitlets.py:1237(observe)
       88    0.000    0.000    0.000    0.000 hmac.py:90(update)
       33    0.000    0.000    0.000    0.000 loader.py:231(_has_section)
       22    0.000    0.000    0.000    0.000 hmac.py:127(hexdigest)
       22    0.000    0.000    0.000    0.000 configurable.py:102(<listcomp>)
       11    0.000    0.000    0.000    0.000 uuid.py:106(__init__)
      110    0.000    0.000    0.000    0.000 {method 'update' of '_hashlib.HASH' objects}
       22    0.000    0.000    0.000    0.000 session.py:597(msg_id)
      142    0.000    0.000    0.000    0.000 traitlets.py:2045(validate)
        3    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
       28    0.000    0.000    0.000    0.000 threading.py:1104(is_alive)
        1    0.000    0.000    0.000    0.000 std.py:560(__new__)
       22    0.000    0.000    0.000    0.000 {method 'replace' of 'datetime.datetime' objects}
       22    0.000    0.000    0.000    0.000 hmac.py:95(copy)
       13    0.000    0.000    0.000    0.000 traitlets.py:1336(set_trait)
      672    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.repr}
      492    0.000    0.000    0.000    0.000 traitlets.py:215(__init__)
       11    0.000    0.000    0.000    0.000 {built-in method posix.urandom}
        1    0.000    0.000    0.000    0.000 notebook.py:90(__repr__)
        2    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
       88    0.000    0.000    0.000    0.000 encoder.py:104(__init__)
      125    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
       30    0.000    0.000    0.000    0.000 traitlets.py:2316(validate_elements)
      492    0.000    0.000    0.000    0.000 traitlets.py:216(__call__)
      125    0.000    0.000    0.000    0.000 bunch.py:11(__getattr__)
       22    0.000    0.000    0.000    0.000 traitlets.py:188(parse_notifier_name)
       22    0.000    0.000    0.000    0.000 hmac.py:108(_current)
       87    0.000    0.000    0.000    0.000 traitlets.py:1673(validate)
       32    0.000    0.000    0.000    0.000 widget.py:515(model_id)
      432    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 decorator.py:199(fix)
       33    0.000    0.000    0.000    0.000 loader.py:150(_is_section_key)
       22    0.000    0.000    0.000    0.000 loader.py:161(__init__)
       13    0.000    0.000    0.000    0.000 traitlets.py:1095(hold)
        2    0.000    0.000    0.000    0.000 std.py:355(format_meter)
        7    0.000    0.000    0.000    0.000 traitlets.py:932(instance_init)
       22    0.000    0.000    0.000    0.000 session.py:844(<listcomp>)
        1    0.000    0.000    0.000    0.000 formatters.py:374(lookup)
      198    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
     11/8    0.000    0.000    0.000    0.000 widget.py:51(_widget_to_json)
      310    0.000    0.000    0.000    0.000 traitlets.py:911(__get__)
      268    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
       11    0.000    0.000    0.000    0.000 comm.py:19(_default_kernel)
        1    0.000    0.000    0.000    0.000 notebook.py:81(_repr_json_)
       28    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
       55    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
       22    0.000    0.000    0.000    0.000 {built-in method utcnow}
        1    0.000    0.000    0.000    0.000 formatters.py:397(lookup_by_type)
        7    0.000    0.000    0.000    0.000 traitlets.py:1299(_register_validator)
       49    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
       44    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
       22    0.000    0.000    0.000    0.000 traitlets.py:1178(_add_notifiers)
       27    0.000    0.000    0.000    0.000 traitlets.py:1399(has_trait)
       66    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
       33    0.000    0.000    0.000    0.000 loader.py:218(__contains__)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
       22    0.000    0.000    0.000    0.000 session.py:278(extract_header)
       22    0.000    0.000    0.000    0.000 tz.py:218(utcoffset)
        5    0.000    0.000    0.000    0.000 traitlets.py:2528(validate)
        4    0.000    0.000    0.000    0.000 traitlets.py:2154(validate)
       36    0.000    0.000    0.000    0.000 traitlets.py:2246(validate_elements)
      263    0.000    0.000    0.000    0.000 widget.py:779(_trait_to_json)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 inspect.py:2992(bind)
       11    0.000    0.000    0.000    0.000 comm.py:38(_default_topic)
        1    0.000    0.000    0.000    0.000 inspect.py:2861(_bind)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       22    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
        5    0.000    0.000    0.000    0.000 traitlets.py:2535(validate_elements)
       26    0.000    0.000    0.000    0.000 jsonutil.py:131(<listcomp>)
       22    0.000    0.000    0.000    0.000 {built-in method builtins.locals}
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 widget.py:217(register_callback)
        3    0.000    0.000    0.000    0.000 utils.py:296(<listcomp>)
       33    0.000    0.000    0.000    0.000 traitlets.py:2110(validate)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        1    0.000    0.000    0.000    0.000 utils.py:162(__init__)
       10    0.000    0.000    0.000    0.000 formatters.py:550(_in_deferred_types)
      125    0.000    0.000    0.000    0.000 {method '__getitem__' of 'dict' objects}
       11    0.000    0.000    0.000    0.000 {built-in method from_bytes}
       22    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       26    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
        3    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
       22    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        3    0.000    0.000    0.000    0.000 traitlets.py:904(__call__)
        7    0.000    0.000    0.000    0.000 trait_types.py:161(validate)
       11    0.000    0.000    0.000    0.000 uuid.py:280(hex)
       12    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
       11    0.000    0.000    0.000    0.000 widget.py:463(<listcomp>)
       13    0.000    0.000    0.000    0.000 configurable.py:381(instance)
        2    0.000    0.000    0.000    0.000 threading.py:498(__init__)
        3    0.000    0.000    0.000    0.000 os.py:664(__getitem__)
        1    0.000    0.000    0.000    0.000 gpu.py:48(on_train_start)
       44    0.000    0.000    0.000    0.000 jsonutil.py:39(_ensure_tzinfo)
       22    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 widget.py:55(<listcomp>)
       22    0.000    0.000    0.000    0.000 tz.py:262(_isdst)
        8    0.000    0.000    0.000    0.000 traitlets.py:1983(validate)
       70    0.000    0.000    0.000    0.000 traitlets.py:396(instance_init)
       88    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        7    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 notebook.py:205(colour)
        5    0.000    0.000    0.000    0.000 traitlets.py:419(__init__)
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
       29    0.000    0.000    0.000    0.000 threading.py:506(is_set)
       33    0.000    0.000    0.000    0.000 {method 'upper' of 'str' objects}
        2    0.000    0.000    0.000    0.000 notebook.py:200(colour)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
       13    0.000    0.000    0.000    0.000 configurable.py:426(initialized)
        1    0.000    0.000    0.000    0.000 re.py:204(split)
       22    0.000    0.000    0.000    0.000 loader.py:165(_ensure_subconfig)
        2    0.000    0.000    0.000    0.000 threading.py:215(__init__)
       28    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
       33    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 memory.py:102(empty_cache)
       11    0.000    0.000    0.000    0.000 traitlets.py:2023(validate)
        3    0.000    0.000    0.000    0.000 os.py:742(encode)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
       33    0.000    0.000    0.000    0.000 {function Config.__contains__ at 0x7f4a43031598}
       37    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
       37    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:277(on_train_start)
        1    0.000    0.000    0.000    0.000 utils.py:215(_supports_unicode)
        1    0.000    0.000    0.000    0.000 inspect.py:2652(apply_defaults)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:133(is_disabled)
       11    0.000    0.000    0.000    0.000 widget.py:334(_call_widget_constructed)
        2    0.000    0.000    0.000    0.000 widget_float.py:33(_validate_value)
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        2    0.000    0.000    0.000    0.000 __init__.py:12(escape)
        1    0.000    0.000    0.000    0.000 dir2.py:54(get_real_method)
        1    0.000    0.000    0.000    0.000 inspect.py:2599(args)
        8    0.000    0.000    0.000    0.000 traitlets.py:1832(_validate_bounds)
        1    0.000    0.000    0.000    0.000 {method 'split' of '_sre.SRE_Pattern' objects}
        4    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 zmqshell.py:90(_hooks)
       13    0.000    0.000    0.000    0.000 traitlets.py:1083(compress)
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
       28    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        2    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        1    0.000    0.000    0.000    0.000 widget_float.py:51(_validate_max)
        1    0.000    0.000    0.000    0.000 _monitor.py:94(report)
        3    0.000    0.000    0.000    0.000 std.py:228(__init__)
        1    0.000    0.000    0.000    0.000 std.py:657(get_lock)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        2    0.000    0.000    0.000    0.000 utils.py:171(__eq__)
        1    0.000    0.000    0.000    0.000 __init__.py:146(is_initialized)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 inspect.py:2622(kwargs)
       11    0.000    0.000    0.000    0.000 {method 'count' of 'list' objects}
       26    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        3    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_emptyCache}
        7    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 accelerator.py:571(on_train_start)
        1    0.000    0.000    0.000    0.000 base.py:158(on_train_start)
        2    0.000    0.000    0.000    0.000 std.py:233(__call__)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        1    0.000    0.000    0.000    0.000 utils.py:201(_is_utf)
        1    0.000    0.000    0.000    0.000 formatters.py:274(_get_type)
        1    0.000    0.000    0.000    0.000 formatters.py:359(_check_return)
        1    0.000    0.000    0.000    0.000 pretty.py:305(_get_mro)
        4    0.000    0.000    0.000    0.000 inspect.py:2817(parameters)
        4    0.000    0.000    0.000    0.000 inspect.py:2502(name)
       10    0.000    0.000    0.000    0.000 inspect.py:2514(kind)
        2    0.000    0.000    0.000    0.000 threading.py:239(__enter__)
        2    0.000    0.000    0.000    0.000 threading.py:242(__exit__)
        2    0.000    0.000    0.000    0.000 threading.py:248(_release_save)
        2    0.000    0.000    0.000    0.000 threading.py:254(_is_owned)
        1    0.000    0.000    0.000    0.000 re.py:286(_compile)
        1    0.000    0.000    0.000    0.000 {method 'values' of 'mappingproxy' objects}
       37    0.000    0.000    0.000    0.000 {method 'values' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method time.monotonic}
        4    0.000    0.000    0.000    0.000 {built-in method _thread.allocate_lock}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.lock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        2    0.000    0.000    0.000    0.000 {built-in method _imp.lock_held}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
        1    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:125(process_position)
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:231(_screen_shape_wrapper)
        1    0.000    0.000    0.000    0.000 displaypub.py:43(_validate_data)
        1    0.000    0.000    0.000    0.000 inspect.py:2591(__init__)
        4    0.000    0.000    0.000    0.000 py3compat.py:12(no_code)
        1    0.000    0.000    0.000    0.000 inspect.py:73(isclass)
        2    0.000    0.000    0.000    0.000 threading.py:251(_acquire_restore)
        3    0.000    0.000    0.000    0.000 {method 'items' of 'mappingproxy' objects}
        5    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        5    0.000    0.000    0.000    0.000 {built-in method math.isnan}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {method '__enter__' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 {method '__exit__' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.iter}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:331(on_train_start)
        1    0.000    0.000    0.000    0.000 hooks.py:40(on_train_start)
        3    0.000    0.000    0.000    0.000 base.py:230(on_train_start)
        1    0.000    0.000    0.000    0.000 jsonutil.py:46(encode_images)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}



Profile stats for: run_training_epoch
         460 function calls in 318.883 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000  318.883   31.888 base.py:109(run)
       10    0.000    0.000  318.883   31.888 training_epoch_loop.py:133(on_run_start)
       10    0.000    0.000  318.883   31.888 trainer.py:1481(call_hook)
       10    0.000    0.000  318.883   31.888 contextlib.py:79(__enter__)
       10    0.000    0.000  318.883   31.888 {built-in method builtins.next}
       10    0.000    0.000  318.883   31.888 base.py:68(profile)
       10    0.000    0.000  318.883   31.888 advanced.py:61(start)
       10  318.883   31.888  318.883   31.888 {method 'enable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.000    0.000 training_epoch_loop.py:118(reset)
       40    0.000    0.000    0.000    0.000 progress.py:154(reset_on_run)
       10    0.000    0.000    0.000    0.000 progress.py:194(reset_on_run)
       10    0.000    0.000    0.000    0.000 progress.py:263(reset_on_run)
       10    0.000    0.000    0.000    0.000 progress.py:101(reset)
       10    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
       20    0.000    0.000    0.000    0.000 progress.py:77(reset)
       10    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       10    0.000    0.000    0.000    0.000 progress.py:230(reset_on_run)
       10    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
       40    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       40    0.000    0.000    0.000    0.000 progress.py:49(reset)
       10    0.000    0.000    0.000    0.000 contextlib.py:157(helper)
       10    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:59(__init__)
       20    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
       30    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       20    0.000    0.000    0.000    0.000 base.py:54(trainer)
       10    0.000    0.000    0.000    0.000 logger_connector.py:258(on_epoch_start)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       10    0.000    0.000    0.000    0.000 base.py:84(skip)



Profile stats for: on_epoch_start
         700 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.000    0.000 callback_hook.py:125(on_epoch_start)
       50    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
       50    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       50    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       50    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       50    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
       10    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       60    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       50    0.000    0.000    0.000    0.000 base.py:160(on_epoch_start)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       10    0.000    0.000    0.000    0.000 hooks.py:184(on_epoch_start)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}



Profile stats for: on_train_epoch_start
         35104 function calls (34840 primitive calls) in 0.324 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.324    0.032 callback_hook.py:85(on_train_epoch_start)
       10    0.000    0.000    0.296    0.030 stochastic_weight_avg.py:164(on_train_epoch_start)
        4    0.026    0.006    0.295    0.074 stochastic_weight_avg.py:264(update_parameters)
       40    0.143    0.004    0.143    0.004 {method 'to' of 'torch._C._TensorBase' objects}
       15    0.099    0.007    0.099    0.007 stochastic_weight_avg.py:277(avg_fn)
       10    0.000    0.000    0.027    0.003 tqdm_progress.py:221(on_train_epoch_start)
       20    0.026    0.001    0.026    0.001 {method 'copy_' of 'torch._C._TensorBase' objects}
       20    0.000    0.000    0.024    0.001 std.py:1339(refresh)
       20    0.000    0.000    0.024    0.001 notebook.py:149(display)
       81    0.000    0.000    0.023    0.000 traitlets.py:576(__set__)
       81    0.000    0.000    0.022    0.000 traitlets.py:558(set)
       41    0.000    0.000    0.021    0.001 traitlets.py:1133(_notify_trait)
       41    0.000    0.000    0.021    0.001 widget.py:676(notify_change)
       10    0.000    0.000    0.021    0.002 tqdm_progress.py:347(reset)
       10    0.000    0.000    0.021    0.002 notebook.py:296(reset)
       41    0.000    0.000    0.020    0.000 widget.py:538(send_state)
       10    0.000    0.000    0.019    0.002 std.py:1374(reset)
       41    0.000    0.000    0.011    0.000 widget.py:814(_send)
       41    0.000    0.000    0.011    0.000 comm.py:120(send)
       41    0.000    0.000    0.011    0.000 comm.py:61(_publish_msg)
       41    0.000    0.000    0.008    0.000 widget.py:557(get_state)
       41    0.000    0.000    0.008    0.000 traitlets.py:1407(traits)
       41    0.001    0.000    0.008    0.000 session.py:749(send)
       41    0.001    0.000    0.006    0.000 traitlets.py:224(getmembers)
       10    0.000    0.000    0.005    0.001 std.py:1396(set_description)
       41    0.000    0.000    0.004    0.000 session.py:685(serialize)
      164    0.000    0.000    0.003    0.000 session.py:95(json_packer)
       41    0.003    0.000    0.003    0.000 {built-in method builtins.dir}
      164    0.000    0.000    0.003    0.000 __init__.py:183(dumps)
   328/82    0.001    0.000    0.003    0.000 jsonutil.py:73(json_clean)
     8043    0.001    0.000    0.002    0.000 {built-in method builtins.isinstance}
      164    0.000    0.000    0.002    0.000 encoder.py:182(encode)
      164    0.001    0.000    0.002    0.000 encoder.py:204(iterencode)
     5095    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
       41    0.000    0.000    0.001    0.000 iostream.py:260(send_multipart)
     2562    0.001    0.000    0.001    0.000 traitlets.py:545(__get__)
       41    0.001    0.000    0.001    0.000 traitlets.py:1421(<listcomp>)
       41    0.000    0.000    0.001    0.000 iostream.py:207(send_multipart)
       20    0.000    0.000    0.001    0.000 std.py:1460(format_dict)
      716    0.001    0.000    0.001    0.000 abc.py:180(__instancecheck__)
       41    0.000    0.000    0.001    0.000 iostream.py:195(schedule)
       81    0.000    0.000    0.001    0.000 traitlets.py:587(_validate)
       41    0.000    0.000    0.001    0.000 session.py:644(msg)
       41    0.000    0.000    0.001    0.000 session.py:670(sign)
       82    0.000    0.000    0.001    0.000 jsonutil.py:108(json_default)
       20    0.000    0.000    0.001    0.000 std.py:355(format_meter)
       20    0.000    0.000    0.001    0.000 utils.py:282(_screen_shape_linux)
       41    0.000    0.000    0.001    0.000 session.py:641(msg_header)
       48    0.000    0.000    0.001    0.000 module.py:1499(parameters)
       41    0.001    0.000    0.001    0.000 socket.py:480(send)
       82    0.000    0.000    0.001    0.000 {method 'isoformat' of 'datetime.datetime' objects}
      813    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
       48    0.000    0.000    0.001    0.000 module.py:1523(named_parameters)
       80    0.000    0.000    0.001    0.000 traitlets.py:596(_cross_validate)
       48    0.000    0.000    0.001    0.000 module.py:1486(_named_members)
     1422    0.001    0.000    0.001    0.000 _weakrefset.py:70(__contains__)
       41    0.000    0.000    0.000    0.000 traitlets.py:1142(notify_change)
     1586    0.000    0.000    0.000    0.000 traitlets.py:526(get)
       60    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
     4987    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       60    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       41    0.000    0.000    0.000    0.000 session.py:271(msg_header)
       60    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       82    0.000    0.000    0.000    0.000 traitlets.py:1439(trait_metadata)
       41    0.000    0.000    0.000    0.000 widget.py:724(_should_send_property)
       60    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       41    0.000    0.000    0.000    0.000 session.py:199(utcnow)
       40    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 device_dtype_mixin.py:50(to)
       10    0.000    0.000    0.000    0.000 base.py:102(total_val_batches)
      164    0.000    0.000    0.000    0.000 hmac.py:90(update)
       10    0.000    0.000    0.000    0.000 trainer.py:1842(enable_validation)
       41    0.000    0.000    0.000    0.000 session.py:597(msg_id)
       41    0.000    0.000    0.000    0.000 hmac.py:95(copy)
       41    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}
       10    0.000    0.000    0.000    0.000 traitlets.py:2154(validate)
       30    0.000    0.000    0.000    0.000 traitlets.py:904(__call__)
       80    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       41    0.000    0.000    0.000    0.000 hmac.py:127(hexdigest)
       41    0.000    0.000    0.000    0.000 widget.py:138(_remove_buffers)
       20    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
      205    0.000    0.000    0.000    0.000 {method 'update' of '_hashlib.HASH' objects}
       20    0.000    0.000    0.000    0.000 utils.py:296(<listcomp>)
       20    0.000    0.000    0.000    0.000 re.py:204(split)
        1    0.000    0.000    0.000    0.000 swa_utils.py:212(__init__)
       41    0.000    0.000    0.000    0.000 threading.py:1104(is_alive)
       41    0.000    0.000    0.000    0.000 {method 'replace' of 'datetime.datetime' objects}
        1    0.000    0.000    0.000    0.000 module.py:795(to)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:24(__init__)
      2/1    0.000    0.000    0.000    0.000 module.py:568(_apply)
       20    0.000    0.000    0.000    0.000 std.py:288(format_interval)
       20    0.000    0.000    0.000    0.000 notebook.py:200(colour)
       41    0.000    0.000    0.000    0.000 widget.py:93(_separate_buffers)
       20    0.000    0.000    0.000    0.000 std.py:104(acquire)
        1    0.000    0.000    0.000    0.000 {built-in method tensor}
       41    0.000    0.000    0.000    0.000 tz.py:218(utcoffset)
       10    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
      164    0.000    0.000    0.000    0.000 encoder.py:104(__init__)
       41    0.000    0.000    0.000    0.000 hmac.py:108(_current)
       20    0.000    0.000    0.000    0.000 os.py:664(__getitem__)
      302    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
       50    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
      225    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
       80    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
    40/24    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
       20    0.000    0.000    0.000    0.000 {method 'split' of '_sre.SRE_Pattern' objects}
       41    0.000    0.000    0.000    0.000 tz.py:262(_isdst)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:117(step)
      123    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
       60    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
       40    0.000    0.000    0.000    0.000 __init__.py:12(escape)
       20    0.000    0.000    0.000    0.000 widget_float.py:33(_validate_value)
       41    0.000    0.000    0.000    0.000 session.py:844(<listcomp>)
       82    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
       20    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
       30    0.000    0.000    0.000    0.000 traitlets.py:1983(validate)
      700    0.000    0.000    0.000    0.000 {built-in method builtins.len}
      464    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       41    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
       58    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 device_dtype_mixin.py:178(__update_properties)
       20    0.000    0.000    0.000    0.000 std.py:108(release)
       10    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
       20    0.000    0.000    0.000    0.000 stochastic_weight_avg.py:127(swa_start)
       10    0.000    0.000    0.000    0.000 gradient_accumulation_scheduler.py:102(on_train_epoch_start)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       82    0.000    0.000    0.000    0.000 bunch.py:11(__getattr__)
       20    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.__build_class__}
       10    0.000    0.000    0.000    0.000 widget_float.py:51(_validate_max)
       41    0.000    0.000    0.000    0.000 {built-in method utcnow}
       41    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
       20    0.000    0.000    0.000    0.000 os.py:742(encode)
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       41    0.000    0.000    0.000    0.000 {built-in method builtins.locals}
       41    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
       41    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
       65    0.000    0.000    0.000    0.000 {built-in method builtins.max}
      2/1    0.000    0.000    0.000    0.000 module.py:620(apply)
       82    0.000    0.000    0.000    0.000 jsonutil.py:39(_ensure_tzinfo)
       10    0.000    0.000    0.000    0.000 tqdm_progress.py:337(convert_inf)
       50    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
       20    0.000    0.000    0.000    0.000 re.py:286(_compile)
       10    0.000    0.000    0.000    0.000 base.py:161(on_train_epoch_start)
       41    0.000    0.000    0.000    0.000 session.py:278(extract_header)
       40    0.000    0.000    0.000    0.000 traitlets.py:2045(validate)
       20    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:47(with_counter)
        5    0.000    0.000    0.000    0.000 module.py:572(compute_should_use_set_data)
       41    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
       10    0.000    0.000    0.000    0.000 base.py:93(total_train_batches)
        1    0.000    0.000    0.000    0.000 swa_utils.py:256(get_lr)
        5    0.000    0.000    0.000    0.000 module.py:893(convert)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       30    0.000    0.000    0.000    0.000 traitlets.py:1832(_validate_bounds)
       85    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
       82    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
      246    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
       14    0.000    0.000    0.000    0.000 stochastic_weight_avg.py:131(swa_end)
       73    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
      205    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
      164    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        6    0.000    0.000    0.000    0.000 module.py:1597(children)
       30    0.000    0.000    0.000    0.000 std.py:228(__init__)
        1    0.000    0.000    0.000    0.000 device_dtype_mixin.py:40(device)
       20    0.000    0.000    0.000    0.000 utils.py:57(__init__)
       61    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 typing.py:676(inner)
       41    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        5    0.000    0.000    0.000    0.000 grad_mode.py:124(__enter__)
        6    0.000    0.000    0.000    0.000 module.py:1606(named_children)
      156    0.000    0.000    0.000    0.000 traitlets.py:911(__get__)
       40    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
       80    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       41    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
       20    0.000    0.000    0.000    0.000 base.py:57(trainer)
        2    0.000    0.000    0.000    0.000 {built-in method torch._C._nn._parse_to}
       41    0.000    0.000    0.000    0.000 threading.py:506(is_set)
       41    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 gradient_accumulation_scheduler.py:94(get_accumulate_grad_batches)
       20    0.000    0.000    0.000    0.000 std.py:233(__call__)
      100    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       30    0.000    0.000    0.000    0.000 {built-in method time.time}
       20    0.000    0.000    0.000    0.000 {built-in method math.isinf}
       20    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
       16    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
       36    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
       82    0.000    0.000    0.000    0.000 {method '__getitem__' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 device_dtype_mixin.py:181(apply_fn)
        1    0.000    0.000    0.000    0.000 functools.py:44(update_wrapper)
       20    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        5    0.000    0.000    0.000    0.000 {built-in method _has_compatible_shallow_copy_type}
        5    0.000    0.000    0.000    0.000 grad_mode.py:119(__init__)
       10    0.000    0.000    0.000    0.000 grad_mode.py:213(__init__)
       20    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 swa_utils.py:246(_cosine_anneal)
       10    0.000    0.000    0.000    0.000 py3compat.py:12(no_code)
       20    0.000    0.000    0.000    0.000 {built-in method math.isnan}
        5    0.000    0.000    0.000    0.000 grad_mode.py:128(__exit__)
        5    0.000    0.000    0.000    0.000 _tensor.py:1001(grad)
        5    0.000    0.000    0.000    0.000 {method 'is_floating_point' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.000    0.000 module.py:1180(__setattr__)
       41    0.000    0.000    0.000    0.000 jsonutil.py:131(<listcomp>)
        1    0.000    0.000    0.000    0.000 optimizers.py:237(_get_default_scheduler_config)
       10    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       20    0.000    0.000    0.000    0.000 base.py:122(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 swa_utils.py:230(_format_param)
       15    0.000    0.000    0.000    0.000 {built-in method torch._C.is_grad_enabled}
       41    0.000    0.000    0.000    0.000 widget.py:779(_trait_to_json)
        2    0.000    0.000    0.000    0.000 trainer.py:1703(lr_schedulers)
       10    0.000    0.000    0.000    0.000 base.py:61(train_batch_idx)
        5    0.000    0.000    0.000    0.000 __future__.py:18(get_overwrite_module_params_on_conversion)
        1    0.000    0.000    0.000    0.000 swa_utils.py:265(<listcomp>)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 typing.py:822(__hash__)
        1    0.000    0.000    0.000    0.000 functools.py:74(wraps)
        2    0.000    0.000    0.000    0.000 {built-in method math.cos}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        1    0.000    0.000    0.000    0.000 trainer.py:1690(optimizers)
        1    0.000    0.000    0.000    0.000 swa_utils.py:269(<listcomp>)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:142(__enter__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.min}
       10    0.000    0.000    0.000    0.000 hooks.py:190(on_train_epoch_start)
        1    0.000    0.000    0.000    0.000 swa_utils.py:250(_get_initial_lr)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:105(print_lr)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:139(__init__)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:146(__exit__)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:137(_enable_get_lr_call)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.setattr}
        1    0.000    0.000    0.000    0.000 trainer.py:2039(max_epochs)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:41(<listcomp>)
        1    0.000    0.000    0.000    0.000 lr_scheduler.py:166(<listcomp>)
        5    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)



Profile stats for: get_train_batch
         202020 function calls (182780 primitive calls) in 72.691 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
28860/19240    0.008    0.000   72.658    0.004 contextlib.py:79(__enter__)
28860/19240    0.008    0.000   72.653    0.004 {built-in method builtins.next}
     9620    0.010    0.000   72.646    0.008 fetching.py:287(apply_profiler)
     9620    0.004    0.000   72.620    0.008 base.py:68(profile)
     9620    0.007    0.000   72.616    0.008 advanced.py:61(start)
     9620   72.609    0.008   72.609    0.008 {method 'enable' of '_lsprof.Profiler' objects}
    28860    0.013    0.000    0.041    0.000 contextlib.py:157(helper)
    28860    0.024    0.000    0.028    0.000 contextlib.py:59(__init__)
    28860    0.005    0.000    0.005    0.000 {built-in method builtins.getattr}
     9620    0.002    0.000    0.002    0.000 fetching.py:238(fetching_context)
     9620    0.001    0.000    0.001    0.000 fetching.py:243(on_fetch_start)



Profile stats for: fetch_next_train_batch
         9447630 function calls (9293830 primitive calls) in 72.482 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
48080/19230    0.037    0.000   72.474    0.004 {built-in method builtins.next}
     9620    0.013    0.000   72.409    0.008 supporters.py:544(__next__)
     9620    0.015    0.000   72.391    0.008 supporters.py:552(request_next_batch)
     9620    0.014    0.000   72.376    0.008 apply_func.py:70(apply_to_collection)
     9620    0.101    0.000   72.322    0.008 dataloader.py:517(__next__)
     9620    0.026    0.000   71.518    0.007 dataloader.py:559(_next_data)
     9610    0.053    0.000   71.108    0.007 fetch.py:47(fetch)
     9610    0.106    0.000   70.401    0.007 <ipython-input-24-45860f993673>:33(__getitem__)
    19220    0.336    0.000   70.295    0.004 <ipython-input-24-45860f993673>:22(to_sparse_tensor)
    38440    0.129    0.000   61.331    0.002 _index.py:32(__getitem__)
    19220    0.073    0.000   41.336    0.002 csr.py:328(_get_arrayXslice)
    19220    3.588    0.000   41.151    0.002 compressed.py:675(_major_index_fancy)
    19220   22.121    0.001   22.121    0.001 {built-in method scipy.sparse._sparsetools.csr_row_index}
365180/345960    0.569    0.000   15.387    0.000 {built-in method numpy.core._multiarray_umath.implement_array_function}
    19220    0.054    0.000   14.556    0.001 csr.py:322(_get_sliceXarray)
    19220    0.294    0.000   14.480    0.001 compressed.py:733(_minor_index_fancy)
    19220    0.027    0.000   10.198    0.001 <__array_function__ internals>:2(diff)
    19220   10.078    0.001   10.119    0.001 function_base.py:1152(diff)
    19220    7.084    0.000    7.084    0.000 {built-in method scipy.sparse._sparsetools.csr_column_index1}
    38440    0.175    0.000    5.279    0.000 _index.py:127(_validate_indices)
    19220    4.815    0.000    4.815    0.000 {built-in method sparse_coo_tensor}
    38440    0.051    0.000    4.080    0.000 fromnumeric.py:52(_wrapfunc)
    38440    0.305    0.000    3.846    0.000 compressed.py:27(__init__)
   153760    3.613    0.000    3.613    0.000 {method 'reduce' of 'numpy.ufunc' objects}
    38440    0.180    0.000    3.470    0.000 _index.py:151(_asindices)
    19220    0.221    0.000    3.319    0.000 compressed.py:1013(tocoo)
    76880    0.073    0.000    2.421    0.000 {method 'max' of 'numpy.ndarray' objects}
    19220    2.412    0.000    2.412    0.000 {built-in method scipy.sparse._sparsetools.csr_column_index2}
    76880    0.043    0.000    2.348    0.000 _methods.py:37(_amax)
    19220    0.024    0.000    2.216    0.000 <__array_function__ internals>:2(argsort)
    19220    0.028    0.000    2.171    0.000 fromnumeric.py:999(argsort)
    19220    2.113    0.000    2.113    0.000 {method 'argsort' of 'numpy.ndarray' objects}
    19220    0.035    0.000    2.036    0.000 <__array_function__ internals>:2(cumsum)
    38440    0.797    0.000    2.029    0.000 compressed.py:135(check_format)
    19220    0.153    0.000    1.993    0.000 coo.py:126(__init__)
    19220    0.034    0.000    1.971    0.000 fromnumeric.py:2418(cumsum)
    19220    1.899    0.000    1.899    0.000 {method 'cumsum' of 'numpy.ndarray' objects}
   115320    0.594    0.000    1.635    0.000 sputils.py:119(get_index_dtype)
   730370    1.522    0.000    1.522    0.000 {built-in method numpy.array}
    76880    0.064    0.000    1.409    0.000 {method 'min' of 'numpy.ndarray' objects}
   442070    0.133    0.000    1.366    0.000 _asarray.py:14(asarray)
    76880    0.037    0.000    1.345    0.000 _methods.py:41(_amin)
    19220    0.402    0.000    1.254    0.000 coo.py:265(_check)
    19220    0.952    0.000    0.952    0.000 {built-in method scipy.sparse._sparsetools.expandptr}
    38440    0.308    0.000    0.908    0.000 _index.py:246(_unpack_index)
    96100    0.257    0.000    0.770    0.000 sputils.py:186(isintlike)
     9610    0.021    0.000    0.654    0.000 auto_restart.py:462(_capture_metadata_collate)
    38440    0.563    0.000    0.563    0.000 {built-in method numpy.zeros}
    19220    0.021    0.000    0.490    0.000 <__array_function__ internals>:2(stack)
    38440    0.235    0.000    0.485    0.000 compressed.py:1144(prune)
788030/730370    0.218    0.000    0.484    0.000 {built-in method builtins.isinstance}
    96100    0.093    0.000    0.480    0.000 <__array_function__ internals>:2(ndim)
   230640    0.437    0.000    0.437    0.000 getlimits.py:498(__init__)
    19220    0.119    0.000    0.402    0.000 shape_base.py:358(stack)
48050/9610    0.160    0.000    0.387    0.000 collate.py:16(default_convert)
     9620    0.006    0.000    0.383    0.000 dataloader.py:511(_next_index)
     9620    0.030    0.000    0.383    0.000 profiler.py:434(__enter__)
     9620    0.017    0.000    0.371    0.000 <ipython-input-25-7c502df9f0ea>:20(__iter__)
     9620    0.353    0.000    0.353    0.000 {built-in method torch._ops.profiler._record_function_enter}
       10    0.000    0.000    0.343    0.034 <ipython-input-25-7c502df9f0ea>:21(<listcomp>)
       20    0.343    0.017    0.343    0.017 {built-in method randperm}
   153760    0.112    0.000    0.343    0.000 <__array_function__ internals>:2(can_cast)
    96100    0.071    0.000    0.339    0.000 _index.py:355(_compatible_boolean_index)
    57660    0.221    0.000    0.329    0.000 sputils.py:265(check_shape)
    96100    0.122    0.000    0.289    0.000 fromnumeric.py:3075(ndim)
     9610    0.032    0.000    0.281    0.000 collate.py:29(<dictcomp>)
    96100    0.244    0.000    0.244    0.000 {built-in method numpy.empty}
    57660    0.169    0.000    0.236    0.000 sputils.py:208(isshape)
   172980    0.083    0.000    0.233    0.000 base.py:238(nnz)
    19220    0.012    0.000    0.226    0.000 typing.py:1156(__instancecheck__)
     9620    0.015    0.000    0.220    0.000 profiler.py:426(__init__)
    19220    0.019    0.000    0.214    0.000 {built-in method builtins.issubclass}
     9620    0.205    0.000    0.205    0.000 {built-in method zeros}
    19220    0.044    0.000    0.196    0.000 typing.py:1145(__subclasscheck__)
    57660    0.088    0.000    0.186    0.000 sputils.py:91(to_native)
    19220    0.024    0.000    0.162    0.000 <__array_function__ internals>:2(concatenate)
    19220    0.051    0.000    0.152    0.000 abc.py:196(__subclasscheck__)
    57660    0.048    0.000    0.147    0.000 data.py:20(__init__)
   172980    0.135    0.000    0.135    0.000 {built-in method builtins.hasattr}
    57660    0.075    0.000    0.134    0.000 _index.py:331(_maybe_bool_ndarray)
    57660    0.030    0.000    0.116    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
    19220    0.036    0.000    0.112    0.000 compressed.py:777(_get_submatrix)
    19220    0.107    0.000    0.107    0.000 {built-in method as_tensor}
   153760    0.105    0.000    0.105    0.000 compressed.py:107(getnnz)
   115320    0.046    0.000    0.103    0.000 _asarray.py:86(asanyarray)
     9620    0.032    0.000    0.100    0.000 profiler.py:438(__exit__)
    57660    0.068    0.000    0.099    0.000 <frozen importlib._bootstrap>:416(parent)
    57660    0.099    0.000    0.099    0.000 base.py:66(__init__)
    38440    0.097    0.000    0.097    0.000 {method 'astype' of 'numpy.ndarray' objects}
   768800    0.095    0.000    0.095    0.000 {built-in method builtins.len}
    38440    0.066    0.000    0.094    0.000 _index.py:340(_first_element_bool)
   172980    0.072    0.000    0.087    0.000 sputils.py:278(<genexpr>)
   115320    0.084    0.000    0.084    0.000 getlimits.py:509(min)
    57670    0.057    0.000    0.076    0.000 _weakrefset.py:70(__contains__)
    38440    0.037    0.000    0.071    0.000 compressed.py:1276(_process_slice)
   115320    0.045    0.000    0.070    0.000 base.py:1188(isspmatrix)
     9620    0.067    0.000    0.067    0.000 {built-in method torch._ops.profiler._record_function_exit}
   307520    0.066    0.000    0.066    0.000 base.py:80(get_shape)
19240/9620    0.012    0.000    0.062    0.000 contextlib.py:85(__exit__)
    38440    0.048    0.000    0.053    0.000 _index.py:292(_check_ellipsis)
    76880    0.053    0.000    0.053    0.000 _util.py:134(_prune_array)
    19230    0.027    0.000    0.051    0.000 abc.py:180(__instancecheck__)
    76880    0.049    0.000    0.049    0.000 {built-in method builtins.max}
    19220    0.022    0.000    0.049    0.000 shape_base.py:421(<listcomp>)
     9620    0.006    0.000    0.049    0.000 fetching.py:287(apply_profiler)
   153760    0.048    0.000    0.048    0.000 {built-in method _operator.index}
   115320    0.048    0.000    0.048    0.000 getlimits.py:522(max)
    19220    0.020    0.000    0.045    0.000 <__array_function__ internals>:2(empty_like)
    19220    0.038    0.000    0.045    0.000 coo.py:239(getnnz)
    57660    0.044    0.000    0.044    0.000 {method 'newbyteorder' of 'numpy.dtype' objects}
    38440    0.037    0.000    0.037    0.000 {method 'ravel' of 'numpy.ndarray' objects}
     9620    0.014    0.000    0.035    0.000 base.py:68(profile)
    19220    0.014    0.000    0.033    0.000 shape_base.py:349(_stack_dispatcher)
    19220    0.027    0.000    0.032    0.000 typing.py:1033(_abc_negative_cache_version)
    57660    0.031    0.000    0.031    0.000 {method 'rpartition' of 'str' objects}
   249860    0.031    0.000    0.031    0.000 csr.py:235(_swap)
    19220    0.030    0.000    0.030    0.000 shape_base.py:425(<setcomp>)
    38440    0.028    0.000    0.028    0.000 {built-in method builtins.iter}
    57660    0.027    0.000    0.027    0.000 data.py:23(_get_dtype)
    19220    0.027    0.000    0.027    0.000 shape_base.py:433(<listcomp>)
    38440    0.026    0.000    0.026    0.000 {built-in method numpy.core._multiarray_umath.normalize_axis_index}
    19220    0.021    0.000    0.021    0.000 compressed.py:701(_major_slice)
   153760    0.021    0.000    0.021    0.000 multiarray.py:468(can_cast)
     9620    0.013    0.000    0.021    0.000 advanced.py:66(stop)
    19220    0.020    0.000    0.020    0.000 {method 'search' of '_sre.SRE_Pattern' objects}
    19220    0.016    0.000    0.019    0.000 typing.py:1089(__eq__)
    19220    0.010    0.000    0.019    0.000 shape_base.py:208(_arrays_for_stack_dispatcher)
    96100    0.018    0.000    0.018    0.000 fromnumeric.py:3071(_ndim_dispatcher)
    38440    0.017    0.000    0.017    0.000 {built-in method builtins.getattr}
    19220    0.017    0.000    0.017    0.000 {method 'indices' of 'slice' objects}
    19220    0.012    0.000    0.016    0.000 typing.py:1019(_abc_negative_cache)
    19220    0.013    0.000    0.013    0.000 {built-in method builtins.min}
       10    0.001    0.000    0.009    0.001 {method 'permutation' of 'numpy.random.mtrand.RandomState' objects}
    19220    0.006    0.000    0.006    0.000 fromnumeric.py:2414(_cumsum_dispatcher)
    19220    0.005    0.000    0.005    0.000 function_base.py:1148(_diff_dispatcher)
     9620    0.005    0.000    0.005    0.000 {method 'get' of 'dict' objects}
     9620    0.004    0.000    0.004    0.000 supporters.py:533(loader_iters)
    19220    0.004    0.000    0.004    0.000 {method 'append' of 'list' objects}
    19220    0.004    0.000    0.004    0.000 multiarray.py:143(concatenate)
    19220    0.004    0.000    0.004    0.000 fromnumeric.py:995(_argsort_dispatcher)
    19220    0.003    0.000    0.003    0.000 multiarray.py:75(empty_like)
     9620    0.003    0.000    0.003    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       10    0.000    0.000    0.002    0.000 <ipython-input-25-7c502df9f0ea>:22(<listcomp>)
       20    0.001    0.000    0.001    0.000 {method 'chunk' of 'torch._C._TensorBase' objects}
      620    0.000    0.000    0.000    0.000 {method 'numpy' of 'torch._C._TensorBase' objects}
    20/10    0.000    0.000    0.000    0.000 {method 'throw' of 'generator' objects}



Profile stats for: training_batch_to_device
         1403060 function calls (1355010 primitive calls) in 3.638 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.035    0.000    3.592    0.000 accelerator.py:192(batch_to_device)
     9610    0.056    0.000    3.392    0.000 lightning.py:284(_apply_batch_transfer_handler)
     9610    0.017    0.000    2.529    0.000 hooks.py:652(transfer_batch_to_device)
     9610    0.025    0.000    2.512    0.000 apply_func.py:245(move_data_to_device)
48050/9610    0.284    0.000    2.487    0.000 apply_func.py:70(apply_to_collection)
    38440    0.106    0.000    2.018    0.000 apply_func.py:262(batch_to)
    38440    1.907    0.000    1.907    0.000 {method 'to' of 'torch._C._TensorBase' objects}
     9610    0.040    0.000    0.803    0.000 signature_utils.py:18(is_param_in_hook_signature)
     9610    0.011    0.000    0.762    0.000 inspect.py:3063(signature)
     9610    0.020    0.000    0.751    0.000 inspect.py:2811(from_callable)
19220/9610    0.090    0.000    0.731    0.000 inspect.py:2183(_signature_from_callable)
     9610    0.158    0.000    0.420    0.000 inspect.py:2102(_signature_from_function)
   221030    0.107    0.000    0.305    0.000 {built-in method builtins.isinstance}
    76880    0.124    0.000    0.197    0.000 abc.py:180(__instancecheck__)
    19220    0.131    0.000    0.174    0.000 inspect.py:2732(__init__)
     9610    0.052    0.000    0.155    0.000 inspect.py:1787(_signature_bound_method)
    38440    0.086    0.000    0.144    0.000 inspect.py:2452(__init__)
     9610    0.012    0.000    0.114    0.000 accelerator.py:172(lightning_module)
     9610    0.010    0.000    0.102    0.000 training_type_plugin.py:171(lightning_module)
     9610    0.016    0.000    0.092    0.000 inspect.py:2825(replace)
     9610    0.014    0.000    0.092    0.000 base.py:104(unwrap_lightning_module)
   105710    0.073    0.000    0.073    0.000 _weakrefset.py:70(__contains__)
     9610    0.025    0.000    0.050    0.000 inspect.py:485(unwrap)
    38440    0.032    0.000    0.044    0.000 enum.py:267(__call__)
     9610    0.008    0.000    0.038    0.000 contextlib.py:85(__exit__)
    48050    0.024    0.000    0.031    0.000 inspect.py:2781(<genexpr>)
     9610    0.004    0.000    0.030    0.000 {built-in method builtins.next}
     9610    0.009    0.000    0.025    0.000 base.py:68(profile)
     9610    0.006    0.000    0.020    0.000 inspect.py:505(_is_wrapper)
    76880    0.016    0.000    0.016    0.000 {method 'append' of 'list' objects}
     9610    0.011    0.000    0.016    0.000 advanced.py:66(stop)
     9610    0.011    0.000    0.016    0.000 accelerator.py:180(root_device)
     9610    0.014    0.000    0.014    0.000 {built-in method builtins.hasattr}
    38440    0.012    0.000    0.012    0.000 enum.py:517(__new__)
    57660    0.012    0.000    0.012    0.000 {method 'get' of 'dict' objects}
    67270    0.011    0.000    0.011    0.000 inspect.py:2502(name)
    19220    0.008    0.000    0.011    0.000 inspect.py:159(isfunction)
    38440    0.008    0.000    0.008    0.000 {method 'isidentifier' of 'str' objects}
    48050    0.007    0.000    0.007    0.000 inspect.py:2514(kind)
     9610    0.006    0.000    0.006    0.000 trainer.py:1611(accelerator)
     9610    0.006    0.000    0.006    0.000 {method 'values' of 'mappingproxy' objects}
     9610    0.005    0.000    0.005    0.000 single_device.py:63(root_device)
    28830    0.004    0.000    0.004    0.000 inspect.py:2506(default)
    19220    0.003    0.000    0.003    0.000 {built-in method builtins.callable}
    19220    0.003    0.000    0.003    0.000 inspect.py:2817(parameters)
     9610    0.003    0.000    0.003    0.000 {built-in method sys.getrecursionlimit}
     9610    0.003    0.000    0.003    0.000 base.py:54(trainer)
     9610    0.003    0.000    0.003    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     9610    0.002    0.000    0.002    0.000 hooks.py:744(on_after_batch_transfer)
     9610    0.002    0.000    0.002    0.000 {built-in method builtins.id}
     9610    0.002    0.000    0.002    0.000 {method 'items' of 'dict' objects}
     9610    0.002    0.000    0.002    0.000 hooks.py:709(on_before_batch_transfer)



Profile stats for: on_batch_start
         682310 function calls in 0.464 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.060    0.000    0.338    0.000 callback_hook.py:155(on_batch_start)
    48050    0.038    0.000    0.272    0.000 trainer.py:1686(lightning_module)
    48050    0.027    0.000    0.222    0.000 accelerator.py:172(lightning_module)
    48050    0.024    0.000    0.195    0.000 training_type_plugin.py:171(lightning_module)
    48050    0.034    0.000    0.171    0.000 base.py:104(unwrap_lightning_module)
    96100    0.048    0.000    0.137    0.000 {built-in method builtins.isinstance}
    48050    0.056    0.000    0.089    0.000 abc.py:180(__instancecheck__)
    19220    0.037    0.000    0.080    0.000 {built-in method builtins.getattr}
     9610    0.028    0.000    0.043    0.000 module.py:1164(__getattr__)
    96100    0.033    0.000    0.033    0.000 _weakrefset.py:70(__contains__)
     9610    0.005    0.000    0.026    0.000 contextlib.py:85(__exit__)
     9610    0.003    0.000    0.021    0.000 {built-in method builtins.next}
     9610    0.006    0.000    0.018    0.000 base.py:68(profile)
     9610    0.015    0.000    0.015    0.000 {method 'format' of 'str' objects}
    57660    0.014    0.000    0.014    0.000 trainer.py:1611(accelerator)
     9610    0.008    0.000    0.012    0.000 advanced.py:66(stop)
     9610    0.009    0.000    0.009    0.000 {built-in method builtins.hasattr}
     9610    0.005    0.000    0.008    0.000 trainer.py:1615(training_type_plugin)
    48050    0.007    0.000    0.007    0.000 base.py:168(on_batch_start)
    19220    0.003    0.000    0.003    0.000 {built-in method builtins.callable}
     9610    0.002    0.000    0.002    0.000 {method 'get' of 'dict' objects}
     9610    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_start
         5612240 function calls (5564190 primitive calls) in 4.200 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.128    0.000    4.129    0.000 callback_hook.py:166(on_train_batch_start)
    48050    0.155    0.000    3.621    0.000 signature_utils.py:18(is_param_in_hook_signature)
    48050    0.037    0.000    3.444    0.000 inspect.py:3063(signature)
    48050    0.058    0.000    3.408    0.000 inspect.py:2811(from_callable)
96100/48050    0.325    0.000    3.350    0.000 inspect.py:2183(_signature_from_callable)
    48050    0.689    0.000    2.028    0.000 inspect.py:2102(_signature_from_function)
    96100    0.642    0.000    0.906    0.000 inspect.py:2732(__init__)
   288300    0.456    0.000    0.771    0.000 inspect.py:2452(__init__)
    48050    0.191    0.000    0.762    0.000 inspect.py:1787(_signature_bound_method)
    48050    0.064    0.000    0.531    0.000 inspect.py:2825(replace)
    48050    0.051    0.000    0.372    0.000 trainer.py:1686(lightning_module)
    48050    0.035    0.000    0.303    0.000 accelerator.py:172(lightning_module)
   672700    0.156    0.000    0.289    0.000 {built-in method builtins.isinstance}
    48050    0.030    0.000    0.267    0.000 training_type_plugin.py:171(lightning_module)
    48050    0.044    0.000    0.237    0.000 base.py:104(unwrap_lightning_module)
   288300    0.161    0.000    0.230    0.000 enum.py:267(__call__)
   336350    0.131    0.000    0.173    0.000 inspect.py:2781(<genexpr>)
    48050    0.084    0.000    0.165    0.000 inspect.py:485(unwrap)
    48050    0.086    0.000    0.134    0.000 abc.py:180(__instancecheck__)
   528550    0.073    0.000    0.073    0.000 inspect.py:2502(name)
   288300    0.068    0.000    0.068    0.000 enum.py:517(__new__)
    48050    0.021    0.000    0.061    0.000 inspect.py:505(_is_wrapper)
   345960    0.059    0.000    0.059    0.000 {method 'get' of 'dict' objects}
    96100    0.036    0.000    0.049    0.000 inspect.py:159(isfunction)
    57660    0.048    0.000    0.048    0.000 {built-in method builtins.hasattr}
    96100    0.048    0.000    0.048    0.000 _weakrefset.py:70(__contains__)
   288300    0.044    0.000    0.044    0.000 {method 'isidentifier' of 'str' objects}
   336350    0.043    0.000    0.043    0.000 inspect.py:2514(kind)
   288300    0.043    0.000    0.043    0.000 {method 'append' of 'list' objects}
     9610    0.006    0.000    0.031    0.000 contextlib.py:85(__exit__)
   240250    0.030    0.000    0.030    0.000 inspect.py:2506(default)
     9610    0.004    0.000    0.025    0.000 {built-in method builtins.next}
    67270    0.023    0.000    0.023    0.000 trainer.py:1611(accelerator)
     9610    0.008    0.000    0.021    0.000 base.py:68(profile)
    48050    0.018    0.000    0.018    0.000 {method 'values' of 'mappingproxy' objects}
   115320    0.017    0.000    0.017    0.000 {built-in method builtins.callable}
    96100    0.015    0.000    0.015    0.000 inspect.py:2817(parameters)
    19220    0.009    0.000    0.014    0.000 trainer.py:1615(training_type_plugin)
     9610    0.010    0.000    0.014    0.000 advanced.py:66(stop)
    28830    0.012    0.000    0.012    0.000 {built-in method builtins.getattr}
    48050    0.010    0.000    0.010    0.000 {built-in method builtins.id}
    48050    0.010    0.000    0.010    0.000 {built-in method sys.getrecursionlimit}
    48050    0.008    0.000    0.008    0.000 {built-in method builtins.len}
    48050    0.008    0.000    0.008    0.000 base.py:99(on_train_batch_start)
     9610    0.002    0.000    0.002    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     9610    0.002    0.000    0.002    0.000 hooks.py:82(on_train_batch_start)
     9610    0.002    0.000    0.002    0.000 training_type_plugin.py:363(on_train_batch_start)



Profile stats for: run_training_batch
         1160654 function calls (1151044 primitive calls) in 210.052 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
19220/9610    0.087    0.000  210.052    0.022 base.py:109(run)
     9610    0.076    0.000  209.824    0.022 training_batch_loop.py:72(advance)
     9610    0.016    0.000  209.516    0.022 optimizer_loop.py:214(advance)
     9610    0.073    0.000  209.496    0.022 optimizer_loop.py:231(_run_optimization)
    17050    0.008    0.000  208.930    0.012 contextlib.py:79(__enter__)
    17050    0.008    0.000  208.922    0.012 {built-in method builtins.next}
     9610    0.007    0.000  208.868    0.022 base.py:68(profile)
     9610    0.011    0.000  208.861    0.022 advanced.py:61(start)
     9610  208.850    0.022  208.850    0.022 {method 'enable' of '_lsprof.Profiler' objects}
     7440    0.006    0.000  155.088    0.021 optimizer_loop.py:159(__call__)
     7440    0.010    0.000  155.082    0.021 optimizer_loop.py:140(closure)
     2170    0.032    0.000   53.937    0.025 optimizer_loop.py:353(_optimizer_step)
     2170    0.003    0.000   53.840    0.025 lightning.py:1571(optimizer_step)
     2170    0.010    0.000   53.837    0.025 optimizer.py:95(step)
     9610    0.073    0.000    0.212    0.000 optimizer_loop.py:283(_make_closure)
     9610    0.044    0.000    0.153    0.000 training_batch_loop.py:62(on_run_start)
    21390    0.020    0.000    0.148    0.000 trainer.py:1686(lightning_module)
    21390    0.015    0.000    0.123    0.000 accelerator.py:172(lightning_module)
    63241    0.040    0.000    0.115    0.000 {built-in method builtins.isinstance}
    21390    0.013    0.000    0.108    0.000 training_type_plugin.py:171(lightning_module)
     9610    0.021    0.000    0.107    0.000 training_batch_loop.py:108(_tbptt_split_batch)
    21390    0.019    0.000    0.095    0.000 base.py:104(unwrap_lightning_module)
    28830    0.048    0.000    0.076    0.000 abc.py:180(__instancecheck__)
     9610    0.008    0.000    0.062    0.000 fit_loop.py:265(_should_accumulate)
     9610    0.034    0.000    0.055    0.000 typing.py:1227(__new__)
     9610    0.023    0.000    0.055    0.000 training_epoch_loop.py:356(_should_accumulate)
    17050    0.015    0.000    0.048    0.000 contextlib.py:157(helper)
     7440    0.009    0.000    0.047    0.000 utilities.py:127(_block_parallel_sync_behavior)
     9610    0.028    0.000    0.043    0.000 optimizer_loop.py:127(__init__)
     9610    0.031    0.000    0.041    0.000 optimizer_loop.py:206(on_run_start)
   143220    0.037    0.000    0.037    0.000 base.py:54(trainer)
    17050    0.027    0.000    0.034    0.000 contextlib.py:59(__init__)
    57660    0.028    0.000    0.028    0.000 _weakrefset.py:70(__contains__)
     9610    0.015    0.000    0.026    0.000 optimizer_loop.py:335(_run_optimization_start)
     9610    0.016    0.000    0.021    0.000 typing.py:1180(_generic_new)
    19220    0.017    0.000    0.020    0.000 base.py:174(on_advance_start)
    81222    0.018    0.000    0.018    0.000 trainer.py:1611(accelerator)
    26660    0.012    0.000    0.018    0.000 trainer.py:1615(training_type_plugin)
     2170    0.006    0.000    0.017    0.000 optimizer.py:63(_to_lightning_optimizer)
     9610    0.016    0.000    0.016    0.000 optimizer_loop.py:198(reset)
     9610    0.016    0.000    0.016    0.000 closure.py:60(__init__)
    19220    0.013    0.000    0.015    0.000 optimizer_loop.py:190(done)
     2170    0.006    0.000    0.015    0.000 enums.py:30(__eq__)
     9610    0.015    0.000    0.015    0.000 optimizer_loop.py:317(_make_backward_fn)
     9610    0.013    0.000    0.015    0.000 optimizer_loop.py:298(_make_zero_grad_fn)
    19222    0.010    0.000    0.014    0.000 trainer.py:1690(optimizers)
     9610    0.014    0.000    0.014    0.000 utilities.py:151(_get_active_optimizers)
     4340    0.005    0.000    0.013    0.000 trainer.py:1719(amp_backend)
     9610    0.010    0.000    0.012    0.000 training_epoch_loop.py:339(_accumulated_batches_reached)
     9610    0.009    0.000    0.011    0.000 training_epoch_loop.py:343(_num_ready_batches_reached)
     9610    0.009    0.000    0.011    0.000 trainer.py:1711(optimizer_frequencies)
     9610    0.009    0.000    0.009    0.000 optimizer_loop.py:294(_make_step_fn)
     9610    0.009    0.000    0.009    0.000 {method 'pop' of 'list' objects}
     9610    0.007    0.000    0.009    0.000 training_batch_loop.py:45(done)
    38440    0.008    0.000    0.008    0.000 utils.py:51(void)
     4340    0.005    0.000    0.007    0.000 accelerator.py:372(amp_backend)
     4340    0.003    0.000    0.007    0.000 types.py:135(__get__)
    38440    0.006    0.000    0.006    0.000 {built-in method builtins.len}
    17050    0.006    0.000    0.006    0.000 {built-in method builtins.getattr}
     9610    0.005    0.000    0.005    0.000 training_batch_loop.py:58(reset)
     9610    0.005    0.000    0.005    0.000 {built-in method __new__ of type object at 0x9d12c0}
     2170    0.003    0.000    0.005    0.000 trainer.py:2035(current_epoch)
     9610    0.005    0.000    0.005    0.000 lightning.py:256(automatic_optimization)
     9610    0.004    0.000    0.004    0.000 lightning.py:265(truncated_bptt_steps)
    19220    0.004    0.000    0.004    0.000 base.py:84(skip)
     9610    0.003    0.000    0.003    0.000 optimizer_loop.py:186(optimizer_idx)
     9610    0.003    0.000    0.003    0.000 logger_connector.py:214(on_train_split_start)
     4340    0.003    0.000    0.003    0.000 enum.py:599(value)
    11780    0.003    0.000    0.003    0.000 trainer.py:2059(fit_loop)
     2170    0.003    0.000    0.003    0.000 progress.py:126(increment_ready)
    19220    0.003    0.000    0.003    0.000 training_type_plugin.py:276(handles_gradient_accumulation)
     2170    0.001    0.000    0.002    0.000 trainer.py:1796(lightning_optimizers)
     2170    0.001    0.000    0.001    0.000 fit_loop.py:55(current_epoch)
     2170    0.001    0.000    0.001    0.000 trainer.py:1650(_device_type)
     4340    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
     2170    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 optimizers.py:112(convert_to_lightning_optimizers)
        1    0.000    0.000    0.000    0.000 optimizers.py:119(<dictcomp>)
        1    0.000    0.000    0.000    0.000 optimizers.py:113(_convert_to_lightning_optimizer)
        1    0.000    0.000    0.000    0.000 optimizer.py:33(__init__)
        1    0.000    0.000    0.000    0.000 optimizer.py:56(_on_trainer_init)
        1    0.000    0.000    0.000    0.000 optimizer.py:36(<dictcomp>)
        1    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}



Profile stats for: training_step_and_backward
         201810 function calls in 125.098 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.027    0.000  125.098    0.013 optimizer_loop.py:412(_training_step)
     9610    0.004    0.000  124.976    0.013 contextlib.py:79(__enter__)
     9610    0.003    0.000  124.972    0.013 {built-in method builtins.next}
     9610    0.005    0.000  124.970    0.013 base.py:68(profile)
     9610    0.007    0.000  124.965    0.013 advanced.py:61(start)
     9610  124.958    0.013  124.958    0.013 {method 'enable' of '_lsprof.Profiler' objects}
     9610    0.010    0.000    0.071    0.000 trainer.py:1686(lightning_module)
     9610    0.007    0.000    0.059    0.000 accelerator.py:172(lightning_module)
     9610    0.007    0.000    0.052    0.000 training_type_plugin.py:171(lightning_module)
     9610    0.009    0.000    0.045    0.000 base.py:104(unwrap_lightning_module)
    19220    0.012    0.000    0.037    0.000 {built-in method builtins.isinstance}
     9610    0.015    0.000    0.024    0.000 abc.py:180(__instancecheck__)
     9610    0.006    0.000    0.019    0.000 contextlib.py:157(helper)
     9610    0.011    0.000    0.013    0.000 contextlib.py:59(__init__)
    19220    0.009    0.000    0.009    0.000 _weakrefset.py:70(__contains__)
    19220    0.005    0.000    0.005    0.000 base.py:54(trainer)
     9610    0.002    0.000    0.002    0.000 trainer.py:1611(accelerator)
     9610    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}



Profile stats for: model_forward
         826460 function calls (816850 primitive calls) in 103.131 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.004    0.000  102.348    0.011 contextlib.py:79(__enter__)
     9610    0.003    0.000  102.344    0.011 {built-in method builtins.next}
     9610    0.006    0.000  102.340    0.011 base.py:68(profile)
     9610    0.010    0.000  102.335    0.011 advanced.py:61(start)
     9610  102.325    0.011  102.325    0.011 {method 'enable' of '_lsprof.Profiler' objects}
     9610    0.058    0.000    0.691    0.000 utilities.py:65(_build_training_step_kwargs)
     9610    0.030    0.000    0.623    0.000 signature_utils.py:18(is_param_in_hook_signature)
     9610    0.010    0.000    0.591    0.000 inspect.py:3063(signature)
     9610    0.014    0.000    0.582    0.000 inspect.py:2811(from_callable)
19220/9610    0.081    0.000    0.567    0.000 inspect.py:2183(_signature_from_callable)
     9610    0.119    0.000    0.307    0.000 inspect.py:2102(_signature_from_function)
    19220    0.096    0.000    0.127    0.000 inspect.py:2732(__init__)
     9610    0.044    0.000    0.125    0.000 inspect.py:1787(_signature_bound_method)
    28830    0.061    0.000    0.101    0.000 inspect.py:2452(__init__)
     9610    0.015    0.000    0.071    0.000 inspect.py:2825(replace)
     9610    0.037    0.000    0.052    0.000 module.py:1180(__setattr__)
     9610    0.021    0.000    0.040    0.000 inspect.py:485(unwrap)
    28830    0.022    0.000    0.031    0.000 enum.py:267(__call__)
     9610    0.008    0.000    0.026    0.000 contextlib.py:157(helper)
    38440    0.018    0.000    0.024    0.000 inspect.py:2781(<genexpr>)
    96100    0.022    0.000    0.022    0.000 {built-in method builtins.isinstance}
     9610    0.015    0.000    0.018    0.000 contextlib.py:59(__init__)
     9610    0.005    0.000    0.014    0.000 inspect.py:505(_is_wrapper)
    67270    0.013    0.000    0.013    0.000 {method 'get' of 'dict' objects}
    19220    0.007    0.000    0.010    0.000 inspect.py:159(isfunction)
     9610    0.009    0.000    0.009    0.000 {built-in method builtins.hasattr}
    28830    0.009    0.000    0.009    0.000 enum.py:517(__new__)
    19220    0.008    0.000    0.008    0.000 {built-in method builtins.getattr}
    48050    0.008    0.000    0.008    0.000 inspect.py:2502(name)
     9610    0.005    0.000    0.007    0.000 trainer.py:1690(optimizers)
    19220    0.006    0.000    0.006    0.000 base.py:54(trainer)
    28830    0.006    0.000    0.006    0.000 {method 'isidentifier' of 'str' objects}
    38440    0.006    0.000    0.006    0.000 inspect.py:2514(kind)
    28830    0.005    0.000    0.005    0.000 {method 'append' of 'list' objects}
     9610    0.004    0.000    0.004    0.000 {method 'values' of 'mappingproxy' objects}
     9610    0.004    0.000    0.004    0.000 lightning.py:265(truncated_bptt_steps)
    19220    0.004    0.000    0.004    0.000 inspect.py:2817(parameters)
    19220    0.003    0.000    0.003    0.000 {built-in method builtins.callable}
    19220    0.003    0.000    0.003    0.000 inspect.py:2506(default)
     9610    0.003    0.000    0.003    0.000 {built-in method sys.getrecursionlimit}
     9610    0.002    0.000    0.002    0.000 trainer.py:1611(accelerator)
     9610    0.002    0.000    0.002    0.000 {built-in method builtins.id}
     9610    0.002    0.000    0.002    0.000 {built-in method builtins.len}



Profile stats for: training_step
         595820 function calls (547770 primitive calls) in 101.157 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.062    0.000  101.092    0.011 accelerator.py:213(training_step)
     9610    0.031    0.000  100.898    0.010 training_type_plugin.py:212(training_step)
     9610    0.053    0.000  100.864    0.010 <ipython-input-27-c9e80d243a57>:45(training_step)
     9610   91.679    0.010   97.620    0.010 <ipython-input-26-8c37ca340d25>:35(sparse_loss)
    19220    1.341    0.000    3.483    0.000 <ipython-input-26-8c37ca340d25>:27(sparse_dense_multiply)
19220/9610    0.097    0.000    3.191    0.000 module.py:1096(_call_impl)
     9610    0.046    0.000    3.136    0.000 <ipython-input-27-c9e80d243a57>:42(forward)
     9610    2.958    0.000    3.005    0.000 <ipython-input-26-8c37ca340d25>:15(forward)
     9610    0.013    0.000    2.424    0.000 __init__.py:94(sum)
     9610    2.411    0.000    2.411    0.000 {built-in method _sparse_sum}
    19220    2.015    0.000    2.015    0.000 {built-in method sparse_coo_tensor}
48050/28830    0.023    0.000    0.116    0.000 {built-in method builtins.next}
28830/19220    0.035    0.000    0.089    0.000 contextlib.py:85(__exit__)
    19220    0.029    0.000    0.081    0.000 precision_plugin.py:232(train_step_context)
    28830    0.065    0.000    0.065    0.000 {method '_values' of 'torch._C._TensorBase' objects}
    19220    0.064    0.000    0.064    0.000 {method '_indices' of 'torch._C._TensorBase' objects}
    57660    0.061    0.000    0.061    0.000 module.py:1164(__getattr__)
19220/9610    0.008    0.000    0.049    0.000 contextlib.py:79(__enter__)
    19220    0.011    0.000    0.037    0.000 contextlib.py:157(helper)
    19220    0.028    0.000    0.028    0.000 {built-in method torch._C._get_tracing_state}
    19220    0.028    0.000    0.028    0.000 {method 'size' of 'torch._C._TensorBase' objects}
    19220    0.022    0.000    0.026    0.000 contextlib.py:59(__init__)
     9610    0.019    0.000    0.024    0.000 trainer.py:1615(training_type_plugin)
     9610    0.008    0.000    0.022    0.000 base.py:68(profile)
     9610    0.009    0.000    0.014    0.000 advanced.py:66(stop)
    19220    0.008    0.000    0.008    0.000 trainer.py:1611(accelerator)
    19220    0.008    0.000    0.008    0.000 base.py:54(trainer)
     9610    0.005    0.000    0.005    0.000 {method 'numel' of 'torch._C._TensorBase' objects}
    19220    0.004    0.000    0.004    0.000 {built-in method builtins.getattr}
    19220    0.004    0.000    0.004    0.000 precision_plugin.py:227(forward_context)
     9610    0.003    0.000    0.003    0.000 training_type_plugin.py:162(model)
     9610    0.003    0.000    0.003    0.000 {method 'get' of 'dict' objects}
     9610    0.002    0.000    0.002    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     9610    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
     9610    0.002    0.000    0.002    0.000 training_type_plugin.py:215(post_training_step)



Profile stats for: training_step_end
         172980 function calls in 0.057 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
    28830    0.020    0.000    0.020    0.000 {built-in method builtins.getattr}
     9610    0.003    0.000    0.017    0.000 contextlib.py:85(__exit__)
     9610    0.002    0.000    0.015    0.000 {built-in method builtins.next}
     9610    0.004    0.000    0.012    0.000 base.py:68(profile)
    19220    0.008    0.000    0.011    0.000 trainer.py:1615(training_type_plugin)
     9610    0.006    0.000    0.008    0.000 advanced.py:66(stop)
    19220    0.004    0.000    0.004    0.000 trainer.py:1611(accelerator)
     9610    0.004    0.000    0.004    0.000 {built-in method builtins.hasattr}
    19220    0.002    0.000    0.002    0.000 {built-in method builtins.callable}
     9610    0.002    0.000    0.002    0.000 lightning.py:696(training_step_end)
     9610    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     9610    0.001    0.000    0.001    0.000 training_type_plugin.py:227(training_step_end)
     9610    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: zero_grad
         62930 function calls in 0.369 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     2170    0.002    0.000    0.369    0.000 optimizer_loop.py:311(zero_grad_fn)
     2170    0.006    0.000    0.367    0.000 optimizer_loop.py:391(_on_before_zero_grad)
     2170    0.007    0.000    0.357    0.000 trainer.py:1481(call_hook)
     2170    0.001    0.000    0.316    0.000 contextlib.py:79(__enter__)
     2170    0.001    0.000    0.315    0.000 {built-in method builtins.next}
     2170    0.001    0.000    0.314    0.000 base.py:68(profile)
     2170    0.001    0.000    0.313    0.000 advanced.py:61(start)
     2170    0.312    0.000    0.312    0.000 {method 'enable' of '_lsprof.Profiler' objects}
     2170    0.002    0.000    0.021    0.000 trainer.py:1686(lightning_module)
     2170    0.002    0.000    0.018    0.000 accelerator.py:172(lightning_module)
     2170    0.002    0.000    0.016    0.000 training_type_plugin.py:171(lightning_module)
     2170    0.002    0.000    0.015    0.000 base.py:104(unwrap_lightning_module)
     8680    0.004    0.000    0.013    0.000 {built-in method builtins.isinstance}
     2170    0.007    0.000    0.009    0.000 abc.py:180(__instancecheck__)
     2170    0.006    0.000    0.009    0.000 module.py:1180(__setattr__)
     2170    0.001    0.000    0.004    0.000 contextlib.py:157(helper)
     2170    0.004    0.000    0.004    0.000 progress.py:126(increment_ready)
     2170    0.003    0.000    0.003    0.000 contextlib.py:59(__init__)
     4340    0.003    0.000    0.003    0.000 _weakrefset.py:70(__contains__)
     6510    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     2170    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
     2170    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     2170    0.000    0.000    0.000    0.000 base.py:54(trainer)



Profile stats for: on_before_zero_grad
         151900 function calls in 0.066 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     2170    0.012    0.000    0.055    0.000 callback_hook.py:309(on_before_zero_grad)
    10850    0.006    0.000    0.042    0.000 trainer.py:1686(lightning_module)
    10850    0.004    0.000    0.034    0.000 accelerator.py:172(lightning_module)
    10850    0.004    0.000    0.030    0.000 training_type_plugin.py:171(lightning_module)
    10850    0.005    0.000    0.026    0.000 base.py:104(unwrap_lightning_module)
    21700    0.007    0.000    0.021    0.000 {built-in method builtins.isinstance}
    10850    0.009    0.000    0.014    0.000 abc.py:180(__instancecheck__)
    21700    0.005    0.000    0.005    0.000 _weakrefset.py:70(__contains__)
     2170    0.001    0.000    0.004    0.000 contextlib.py:85(__exit__)
     2170    0.001    0.000    0.004    0.000 {built-in method builtins.next}
     2170    0.001    0.000    0.003    0.000 base.py:68(profile)
     2170    0.003    0.000    0.003    0.000 {built-in method builtins.hasattr}
     2170    0.001    0.000    0.002    0.000 advanced.py:66(stop)
    13020    0.002    0.000    0.002    0.000 trainer.py:1611(accelerator)
     4340    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
    10850    0.001    0.000    0.001    0.000 base.py:329(on_before_zero_grad)
     2170    0.001    0.000    0.001    0.000 trainer.py:1615(training_type_plugin)
     4340    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     2170    0.000    0.000    0.000    0.000 hooks.py:220(on_before_zero_grad)
     2170    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     2170    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: backward
         374790 function calls in 21.265 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.019    0.000   21.265    0.002 optimizer_loop.py:326(backward_fn)
     9610    0.021    0.000   21.241    0.002 accelerator.py:305(backward)
     9610    0.015    0.000   21.148    0.002 precision_plugin.py:64(pre_backward)
     9610    0.029    0.000   21.133    0.002 trainer.py:1481(call_hook)
     9610    0.003    0.000   21.008    0.002 contextlib.py:79(__enter__)
     9610    0.003    0.000   21.004    0.002 {built-in method builtins.next}
     9610    0.004    0.000   21.002    0.002 base.py:68(profile)
     9610    0.005    0.000   20.998    0.002 advanced.py:61(start)
     9610   20.993    0.002   20.993    0.002 {method 'enable' of '_lsprof.Profiler' objects}
    19220    0.010    0.000    0.104    0.000 accelerator.py:172(lightning_module)
    19220    0.009    0.000    0.094    0.000 training_type_plugin.py:171(lightning_module)
    19220    0.015    0.000    0.085    0.000 base.py:104(unwrap_lightning_module)
    57660    0.025    0.000    0.075    0.000 {built-in method builtins.isinstance}
    19220    0.034    0.000    0.050    0.000 abc.py:180(__instancecheck__)
     9610    0.006    0.000    0.041    0.000 trainer.py:1686(lightning_module)
     9610    0.027    0.000    0.036    0.000 module.py:1180(__setattr__)
     9610    0.006    0.000    0.019    0.000 contextlib.py:157(helper)
    38440    0.015    0.000    0.015    0.000 _weakrefset.py:70(__contains__)
     9610    0.010    0.000    0.013    0.000 contextlib.py:59(__init__)
    19220    0.005    0.000    0.005    0.000 trainer.py:1611(accelerator)
    28830    0.004    0.000    0.004    0.000 {method 'get' of 'dict' objects}
     9610    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
     9610    0.002    0.000    0.002    0.000 base.py:54(trainer)
     9610    0.002    0.000    0.002    0.000 training_type_plugin.py:156(pre_backward)



Profile stats for: on_before_backward
         672700 function calls in 0.273 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.049    0.000    0.229    0.000 callback_hook.py:294(on_before_backward)
    48050    0.026    0.000    0.176    0.000 trainer.py:1686(lightning_module)
    48050    0.018    0.000    0.143    0.000 accelerator.py:172(lightning_module)
    48050    0.015    0.000    0.125    0.000 training_type_plugin.py:171(lightning_module)
    48050    0.022    0.000    0.109    0.000 base.py:104(unwrap_lightning_module)
    96100    0.030    0.000    0.088    0.000 {built-in method builtins.isinstance}
    48050    0.036    0.000    0.057    0.000 abc.py:180(__instancecheck__)
    96100    0.022    0.000    0.022    0.000 _weakrefset.py:70(__contains__)
     9610    0.003    0.000    0.018    0.000 contextlib.py:85(__exit__)
     9610    0.002    0.000    0.015    0.000 {built-in method builtins.next}
     9610    0.004    0.000    0.013    0.000 base.py:68(profile)
     9610    0.012    0.000    0.012    0.000 {built-in method builtins.hasattr}
     9610    0.006    0.000    0.009    0.000 advanced.py:66(stop)
    57660    0.008    0.000    0.008    0.000 trainer.py:1611(accelerator)
    19220    0.006    0.000    0.006    0.000 {built-in method builtins.getattr}
     9610    0.004    0.000    0.005    0.000 trainer.py:1615(training_type_plugin)
    48050    0.005    0.000    0.005    0.000 base.py:315(on_before_backward)
    19220    0.002    0.000    0.002    0.000 {built-in method builtins.callable}
     9610    0.002    0.000    0.002    0.000 {method 'get' of 'dict' objects}
     9610    0.002    0.000    0.002    0.000 hooks.py:240(on_before_backward)
     9610    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_after_backward
         672700 function calls in 0.292 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.046    0.000    0.238    0.000 callback_hook.py:299(on_after_backward)
    48050    0.028    0.000    0.187    0.000 trainer.py:1686(lightning_module)
    48050    0.020    0.000    0.151    0.000 accelerator.py:172(lightning_module)
    48050    0.016    0.000    0.132    0.000 training_type_plugin.py:171(lightning_module)
    48050    0.022    0.000    0.115    0.000 base.py:104(unwrap_lightning_module)
    96100    0.032    0.000    0.093    0.000 {built-in method builtins.isinstance}
    48050    0.037    0.000    0.061    0.000 abc.py:180(__instancecheck__)
    96100    0.023    0.000    0.023    0.000 _weakrefset.py:70(__contains__)
     9610    0.004    0.000    0.021    0.000 contextlib.py:85(__exit__)
     9610    0.003    0.000    0.017    0.000 {built-in method builtins.next}
     9610    0.005    0.000    0.015    0.000 base.py:68(profile)
     9610    0.013    0.000    0.013    0.000 {built-in method builtins.hasattr}
    19220    0.011    0.000    0.011    0.000 {built-in method builtins.getattr}
     9610    0.007    0.000    0.010    0.000 advanced.py:66(stop)
    57660    0.009    0.000    0.009    0.000 trainer.py:1611(accelerator)
     9610    0.004    0.000    0.005    0.000 trainer.py:1615(training_type_plugin)
    48050    0.005    0.000    0.005    0.000 base.py:319(on_after_backward)
    19220    0.002    0.000    0.002    0.000 {built-in method builtins.callable}
     9610    0.002    0.000    0.002    0.000 {method 'get' of 'dict' objects}
     9610    0.001    0.000    0.001    0.000 hooks.py:248(on_after_backward)
     9610    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_batch_end
         24569337 function calls (24390007 primitive calls) in 17.492 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.137    0.000   17.428    0.002 callback_hook.py:175(on_train_batch_end)
     9610    0.074    0.000   13.642    0.001 tqdm_progress.py:233(on_train_batch_end)
    12011    0.055    0.000   12.146    0.001 std.py:1339(refresh)
    12011    0.180    0.000   12.008    0.001 notebook.py:149(display)
    36033    0.026    0.000   10.663    0.000 traitlets.py:576(__set__)
    36033    0.073    0.000   10.637    0.000 traitlets.py:558(set)
    21880    0.051    0.000   10.306    0.000 traitlets.py:1133(_notify_trait)
    21880    0.141    0.000   10.255    0.000 widget.py:676(notify_change)
     9610    0.084    0.000    9.648    0.001 std.py:1416(set_postfix)
    21880    0.083    0.000    9.633    0.000 widget.py:538(send_state)
    21880    0.052    0.000    5.280    0.000 widget.py:814(_send)
    21880    0.046    0.000    5.185    0.000 comm.py:120(send)
    21880    0.182    0.000    5.139    0.000 comm.py:61(_publish_msg)
    21880    0.082    0.000    4.170    0.000 widget.py:557(get_state)
    21880    0.126    0.000    3.971    0.000 traitlets.py:1407(traits)
    21880    0.222    0.000    3.482    0.000 session.py:749(send)
    21880    0.670    0.000    3.208    0.000 traitlets.py:224(getmembers)
    48050    0.146    0.000    3.109    0.000 signature_utils.py:18(is_param_in_hook_signature)
    48050    0.035    0.000    2.945    0.000 inspect.py:3063(signature)
    48050    0.055    0.000    2.911    0.000 inspect.py:2811(from_callable)
     9610    0.025    0.000    2.856    0.000 tqdm_progress.py:324(_update_bar)
96100/48050    0.289    0.000    2.856    0.000 inspect.py:2183(_signature_from_callable)
     9610    0.018    0.000    2.824    0.000 notebook.py:267(update)
     9610    0.033    0.000    2.806    0.000 std.py:1212(update)
    21880    0.136    0.000    2.116    0.000 session.py:685(serialize)
    48050    0.596    0.000    1.726    0.000 inspect.py:2102(_signature_from_function)
    87520    0.111    0.000    1.517    0.000 session.py:95(json_packer)
    21880    1.419    0.000    1.419    0.000 {built-in method builtins.dir}
175040/43760    0.571    0.000    1.369    0.000 jsonutil.py:73(json_clean)
  5007423    0.747    0.000    1.368    0.000 {built-in method builtins.isinstance}
    87520    0.213    0.000    1.365    0.000 __init__.py:183(dumps)
    87520    0.143    0.000    1.087    0.000 encoder.py:182(encode)
     9610    0.062    0.000    1.034    0.000 base.py:185(get_metrics)
  2745981    0.826    0.000    0.917    0.000 {built-in method builtins.getattr}
    87520    0.525    0.000    0.904    0.000 encoder.py:204(iterencode)
     9610    0.024    0.000    0.806    0.000 lightning.py:1791(get_progress_bar_dict)
     9610    0.108    0.000    0.782    0.000 base.py:217(get_standard_metrics)
    96100    0.555    0.000    0.767    0.000 inspect.py:2732(__init__)
   317130    0.385    0.000    0.648    0.000 inspect.py:2452(__init__)
    48050    0.167    0.000    0.640    0.000 inspect.py:1787(_signature_bound_method)
    21880    0.359    0.000    0.633    0.000 traitlets.py:1421(<listcomp>)
   417350    0.374    0.000    0.620    0.000 abc.py:180(__instancecheck__)
  1369936    0.349    0.000    0.572    0.000 traitlets.py:545(__get__)
    12011    0.321    0.000    0.548    0.000 std.py:355(format_meter)
     9610    0.007    0.000    0.530    0.000 supporters.py:93(mean)
    21880    0.034    0.000    0.527    0.000 iostream.py:260(send_multipart)
     9610    0.014    0.000    0.523    0.000 supporters.py:105(_agg_memory)
     9610    0.505    0.000    0.505    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
    21880    0.023    0.000    0.493    0.000 iostream.py:207(send_multipart)
    12011    0.094    0.000    0.482    0.000 std.py:1460(format_dict)
    21880    0.068    0.000    0.470    0.000 iostream.py:195(schedule)
    21880    0.074    0.000    0.459    0.000 session.py:644(msg)
    48050    0.053    0.000    0.439    0.000 inspect.py:2825(replace)
    21880    0.083    0.000    0.387    0.000 session.py:670(sign)
    43760    0.064    0.000    0.379    0.000 jsonutil.py:108(json_default)
    48050    0.047    0.000    0.348    0.000 trainer.py:1686(lightning_module)
    21880    0.040    0.000    0.339    0.000 session.py:641(msg_header)
    21880    0.303    0.000    0.303    0.000 socket.py:480(send)
    12011    0.097    0.000    0.290    0.000 utils.py:282(_screen_shape_linux)
   483831    0.287    0.000    0.287    0.000 {built-in method builtins.hasattr}
    48050    0.034    0.000    0.281    0.000 accelerator.py:172(lightning_module)
    21880    0.168    0.000    0.265    0.000 traitlets.py:1142(notify_change)
    43760    0.234    0.000    0.261    0.000 {method 'isoformat' of 'datetime.datetime' objects}
    36033    0.059    0.000    0.258    0.000 traitlets.py:587(_validate)
    48050    0.030    0.000    0.247    0.000 training_type_plugin.py:171(lightning_module)
   815480    0.246    0.000    0.246    0.000 _weakrefset.py:70(__contains__)
  3000390    0.229    0.000    0.229    0.000 {method 'append' of 'list' objects}
   837866    0.223    0.000    0.223    0.000 traitlets.py:526(get)
    48050    0.039    0.000    0.218    0.000 base.py:104(unwrap_lightning_module)
   317130    0.137    0.000    0.193    0.000 enum.py:267(__call__)
     9610    0.025    0.000    0.188    0.000 model_checkpoint.py:280(on_train_batch_end)
    21880    0.022    0.000    0.175    0.000 session.py:271(msg_header)
     9610    0.010    0.000    0.162    0.000 trainer.py:2147(progress_bar_metrics)
    43760    0.073    0.000    0.158    0.000 traitlets.py:1439(trait_metadata)
     9610    0.011    0.000    0.151    0.000 logger_connector.py:349(progress_bar_metrics)
     9610    0.048    0.000    0.151    0.000 model_checkpoint.py:406(_should_skip_saving_checkpoint)
    48050    0.076    0.000    0.145    0.000 inspect.py:485(unwrap)
    36033    0.070    0.000    0.144    0.000 traitlets.py:596(_cross_validate)
   365180    0.108    0.000    0.142    0.000 inspect.py:2781(<genexpr>)
     9610    0.012    0.000    0.140    0.000 trainer.py:2151(_results)
    21880    0.047    0.000    0.140    0.000 widget.py:724(_should_send_property)
    93687    0.136    0.000    0.136    0.000 {method 'format' of 'str' objects}
    21880    0.029    0.000    0.133    0.000 session.py:199(utcnow)
    28830    0.056    0.000    0.118    0.000 enums.py:30(__eq__)
    21880    0.114    0.000    0.114    0.000 {method 'sort' of 'list' objects}
    21880    0.060    0.000    0.103    0.000 session.py:597(msg_id)
    87520    0.026    0.000    0.101    0.000 hmac.py:90(update)
    19220    0.027    0.000    0.100    0.000 trainer.py:1957(training)
    21880    0.020    0.000    0.093    0.000 hmac.py:127(hexdigest)
   615470    0.086    0.000    0.086    0.000 {method 'get' of 'dict' objects}
    21880    0.018    0.000    0.083    0.000 widget.py:138(_remove_buffers)
     9610    0.010    0.000    0.082    0.000 trainer.py:2126(_active_loop)
    24022    0.034    0.000    0.082    0.000 std.py:288(format_interval)
    21880    0.040    0.000    0.081    0.000 hmac.py:95(copy)
     9610    0.081    0.000    0.081    0.000 {method 'item' of 'torch._C._TensorBase' objects}
    21880    0.080    0.000    0.080    0.000 {method 'replace' of 'datetime.datetime' objects}
    21880    0.037    0.000    0.080    0.000 threading.py:1104(is_alive)
   109400    0.079    0.000    0.079    0.000 {method 'update' of '_hashlib.HASH' objects}
    12011    0.036    0.000    0.079    0.000 notebook.py:200(colour)
    12011    0.025    0.000    0.077    0.000 utils.py:296(<listcomp>)
     9610    0.021    0.000    0.077    0.000 tqdm_progress.py:41(format_num)
    12011    0.059    0.000    0.072    0.000 {built-in method fcntl.ioctl}
   195101    0.070    0.000    0.070    0.000 {method 'replace' of 'str' objects}
    12011    0.013    0.000    0.068    0.000 re.py:204(split)
    21880    0.044    0.000    0.066    0.000 widget.py:93(_separate_buffers)
    87520    0.065    0.000    0.065    0.000 encoder.py:104(__init__)
     9610    0.015    0.000    0.060    0.000 trainer.py:2016(sanity_checking)
    45643    0.016    0.000    0.059    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
   121411    0.058    0.000    0.058    0.000 {method 'encode' of 'str' objects}
   586210    0.056    0.000    0.056    0.000 inspect.py:2502(name)
   317130    0.056    0.000    0.056    0.000 enum.py:517(__new__)
    21880    0.023    0.000    0.055    0.000 hmac.py:108(_current)
     9610    0.025    0.000    0.053    0.000 std.py:310(format_num)
    97130    0.031    0.000    0.052    0.000 {method 'join' of 'str' objects}
    12011    0.030    0.000    0.052    0.000 os.py:664(__getitem__)
    48050    0.018    0.000    0.052    0.000 inspect.py:505(_is_wrapper)
    12011    0.013    0.000    0.050    0.000 traitlets.py:904(__call__)
    12011    0.022    0.000    0.049    0.000 std.py:104(acquire)
    24022    0.022    0.000    0.048    0.000 __init__.py:12(escape)
   420010    0.047    0.000    0.047    0.000 {built-in method builtins.len}
     9610    0.013    0.000    0.047    0.000 fit_loop.py:142(_results)
    12011    0.046    0.000    0.046    0.000 {built-in method now}
    43760    0.043    0.000    0.043    0.000 {built-in method posix.getpid}
    21880    0.030    0.000    0.043    0.000 session.py:844(<listcomp>)
    57660    0.029    0.000    0.039    0.000 types.py:135(__get__)
   317130    0.039    0.000    0.039    0.000 {method 'isidentifier' of 'str' objects}
     9610    0.039    0.000    0.039    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
    65640    0.038    0.000    0.038    0.000 {method 'copy' of '_hashlib.HASH' objects}
    12011    0.038    0.000    0.038    0.000 {method 'split' of '_sre.SRE_Pattern' objects}
    96100    0.028    0.000    0.036    0.000 inspect.py:159(isfunction)
    21880    0.015    0.000    0.036    0.000 threading.py:1062(_wait_for_tstate_lock)
    19220    0.017    0.000    0.035    0.000 trainer.py:2031(global_step)
    12011    0.024    0.000    0.034    0.000 std.py:108(release)
   365180    0.033    0.000    0.033    0.000 inspect.py:2514(kind)
    12011    0.018    0.000    0.032    0.000 widget_float.py:33(_validate_value)
     9610    0.006    0.000    0.032    0.000 contextlib.py:85(__exit__)
    12011    0.017    0.000    0.029    0.000 traitlets.py:1983(validate)
    43760    0.020    0.000    0.027    0.000 bunch.py:11(__getattr__)
    21880    0.019    0.000    0.027    0.000 tz.py:218(utcoffset)
     9610    0.004    0.000    0.026    0.000 {built-in method builtins.next}
   269080    0.024    0.000    0.024    0.000 inspect.py:2506(default)
    21880    0.023    0.000    0.023    0.000 {built-in method utcnow}
    57660    0.023    0.000    0.023    0.000 trainer.py:1611(accelerator)
     9610    0.008    0.000    0.023    0.000 base.py:68(profile)
    21880    0.022    0.000    0.022    0.000 {method 'digest' of '_hashlib.HASH' objects}
    12011    0.010    0.000    0.022    0.000 os.py:742(encode)
    28830    0.018    0.000    0.021    0.000 std.py:1442(<genexpr>)
    12011    0.021    0.000    0.021    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
     9610    0.010    0.000    0.021    0.000 tqdm_progress.py:321(_should_update)
    21880    0.020    0.000    0.020    0.000 {method 'acquire' of '_thread.lock' objects}
    21880    0.019    0.000    0.019    0.000 {built-in method builtins.locals}
    24281    0.019    0.000    0.019    0.000 {built-in method builtins.max}
    21880    0.014    0.000    0.018    0.000 session.py:278(extract_header)
    45902    0.018    0.000    0.018    0.000 {method 'update' of 'dict' objects}
    38440    0.018    0.000    0.018    0.000 trainer.py:2059(fit_loop)
    21880    0.017    0.000    0.017    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
    48050    0.017    0.000    0.017    0.000 {method 'values' of 'mappingproxy' objects}
    12011    0.017    0.000    0.017    0.000 re.py:286(_compile)
   131280    0.017    0.000    0.017    0.000 {method 'extend' of 'list' objects}
    24022    0.013    0.000    0.017    0.000 traitlets.py:2045(validate)
    43760    0.016    0.000    0.016    0.000 jsonutil.py:39(_ensure_tzinfo)
    21880    0.015    0.000    0.015    0.000 iostream.py:91(_event_pipe)
     9610    0.010    0.000    0.015    0.000 advanced.py:66(stop)
   115320    0.014    0.000    0.014    0.000 {built-in method builtins.callable}
   109400    0.014    0.000    0.014    0.000 {method 'items' of 'dict' objects}
    94470    0.013    0.000    0.013    0.000 traitlets.py:911(__get__)
    12011    0.006    0.000    0.013    0.000 utils.py:88(__getattr__)
    12011    0.012    0.000    0.012    0.000 traitlets.py:1832(_validate_bounds)
    96100    0.012    0.000    0.012    0.000 inspect.py:2817(parameters)
     9610    0.011    0.000    0.011    0.000 {built-in method builtins.sorted}
    12011    0.011    0.000    0.011    0.000 std.py:233(__call__)
    57660    0.011    0.000    0.011    0.000 {method 'lower' of 'str' objects}
    12011    0.011    0.000    0.011    0.000 utils.py:57(__init__)
    57660    0.010    0.000    0.010    0.000 enum.py:599(value)
    48044    0.010    0.000    0.010    0.000 {built-in method builtins.divmod}
     9610    0.008    0.000    0.010    0.000 tqdm_progress.py:129(is_enabled)
    48050    0.009    0.000    0.009    0.000 {built-in method sys.getrecursionlimit}
    21880    0.008    0.000    0.008    0.000 {built-in method __new__ of type object at 0x9d12c0}
    48050    0.008    0.000    0.008    0.000 {built-in method builtins.id}
    21880    0.008    0.000    0.008    0.000 tz.py:262(_isdst)
     9610    0.004    0.000    0.007    0.000 trainer.py:1615(training_type_plugin)
     9610    0.007    0.000    0.007    0.000 fit_loop.py:123(running_loss)
    21880    0.007    0.000    0.007    0.000 threading.py:506(is_set)
     9610    0.007    0.000    0.007    0.000 base.py:164(on_train_batch_end)
    43760    0.007    0.000    0.007    0.000 {method '__getitem__' of 'dict' objects}
    19220    0.006    0.000    0.006    0.000 fit_loop.py:65(global_step)
    12011    0.006    0.000    0.006    0.000 {method 'acquire' of '_thread.RLock' objects}
     9610    0.006    0.000    0.006    0.000 {built-in method builtins.min}
    16816    0.006    0.000    0.006    0.000 {built-in method time.time}
    19220    0.006    0.000    0.006    0.000 tensorboard.py:281(version)
    21880    0.006    0.000    0.006    0.000 {method 'copy' of 'dict' objects}
    12011    0.006    0.000    0.006    0.000 {method 'release' of '_thread.RLock' objects}
    21880    0.005    0.000    0.005    0.000 jsonutil.py:131(<listcomp>)
    28830    0.005    0.000    0.005    0.000 base.py:110(on_train_batch_end)
    28830    0.005    0.000    0.005    0.000 {method 'keys' of 'dict' objects}
    28830    0.004    0.000    0.004    0.000 tqdm_progress.py:121(refresh_rate)
    12011    0.004    0.000    0.004    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
     9610    0.004    0.000    0.004    0.000 {built-in method time.monotonic}
    21880    0.004    0.000    0.004    0.000 widget.py:779(_trait_to_json)
     9610    0.004    0.000    0.004    0.000 lightning.py:265(truncated_bptt_steps)
    21880    0.004    0.000    0.004    0.000 {method 'append' of 'collections.deque' objects}
    19220    0.003    0.000    0.003    0.000 {method 'strip' of 'str' objects}
     9610    0.003    0.000    0.003    0.000 {built-in method math.isnan}
     9610    0.003    0.000    0.003    0.000 base.py:54(trainer)
    19220    0.003    0.000    0.003    0.000 {method 'keys' of 'collections.OrderedDict' objects}
     9610    0.002    0.000    0.002    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     9610    0.002    0.000    0.002    0.000 base.py:61(train_batch_idx)
     9610    0.002    0.000    0.002    0.000 {built-in method math.isinf}
     9610    0.002    0.000    0.002    0.000 hooks.py:93(on_train_batch_end)



Profile stats for: on_batch_end
         682310 function calls in 0.324 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     9610    0.046    0.000    0.236    0.000 callback_hook.py:160(on_batch_end)
    48050    0.027    0.000    0.186    0.000 trainer.py:1686(lightning_module)
    48050    0.020    0.000    0.151    0.000 accelerator.py:172(lightning_module)
    48050    0.016    0.000    0.131    0.000 training_type_plugin.py:171(lightning_module)
    48050    0.023    0.000    0.116    0.000 base.py:104(unwrap_lightning_module)
    96100    0.032    0.000    0.093    0.000 {built-in method builtins.isinstance}
    48050    0.038    0.000    0.061    0.000 abc.py:180(__instancecheck__)
    19220    0.020    0.000    0.052    0.000 {built-in method builtins.getattr}
     9610    0.021    0.000    0.032    0.000 module.py:1164(__getattr__)
    96100    0.023    0.000    0.023    0.000 _weakrefset.py:70(__contains__)
     9610    0.004    0.000    0.019    0.000 contextlib.py:85(__exit__)
     9610    0.002    0.000    0.016    0.000 {built-in method builtins.next}
     9610    0.004    0.000    0.013    0.000 base.py:68(profile)
     9610    0.011    0.000    0.011    0.000 {method 'format' of 'str' objects}
    57660    0.009    0.000    0.009    0.000 trainer.py:1611(accelerator)
     9610    0.009    0.000    0.009    0.000 {built-in method builtins.hasattr}
     9610    0.006    0.000    0.009    0.000 advanced.py:66(stop)
     9610    0.004    0.000    0.005    0.000 trainer.py:1615(training_type_plugin)
    48050    0.005    0.000    0.005    0.000 base.py:226(on_batch_end)
    19220    0.002    0.000    0.002    0.000 {built-in method builtins.callable}
     9610    0.002    0.000    0.002    0.000 {method 'get' of 'dict' objects}
     9610    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: optimizer_step_with_closure_0
         89454 function calls in 29.850 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     2170    0.005    0.000   29.850    0.014 accelerator.py:321(optimizer_step)
     2170    0.010    0.000   29.831    0.014 precision_plugin.py:152(optimizer_step)
     2170    0.017    0.000   29.818    0.014 optimizer.py:83(wrapper)
     2170    0.008    0.000   29.728    0.014 grad_mode.py:25(decorate_context)
     2170    0.007    0.000   29.702    0.014 adam.py:81(step)
     2170    0.002    0.000   29.691    0.014 precision_plugin.py:135(_wrap_closure)
     2170    0.002    0.000   29.688    0.014 optimizer_loop.py:159(__call__)
     2170    0.004    0.000   29.686    0.014 optimizer_loop.py:140(closure)
     2170    0.001    0.000   29.675    0.014 contextlib.py:79(__enter__)
     2170    0.001    0.000   29.674    0.014 {built-in method builtins.next}
     2170    0.002    0.000   29.673    0.014 base.py:68(profile)
     2170    0.002    0.000   29.671    0.014 advanced.py:61(start)
     2170   29.669    0.014   29.669    0.014 {method 'enable' of '_lsprof.Profiler' objects}
      484    0.003    0.000    6.659    0.014 lr_scheduler.py:60(wrapper)
     2170    0.008    0.000    0.039    0.000 profiler.py:434(__enter__)
     2170    0.004    0.000    0.031    0.000 profiler.py:426(__init__)
     2170    0.031    0.000    0.031    0.000 {built-in method torch._ops.profiler._record_function_enter}
     2170    0.027    0.000    0.027    0.000 {built-in method zeros}
     2170    0.002    0.000    0.014    0.000 accelerator.py:172(lightning_module)
     2170    0.002    0.000    0.012    0.000 training_type_plugin.py:171(lightning_module)
     2170    0.005    0.000    0.011    0.000 grad_mode.py:124(__enter__)
     2170    0.002    0.000    0.010    0.000 base.py:104(unwrap_lightning_module)
     6510    0.003    0.000    0.009    0.000 {built-in method builtins.isinstance}
     2170    0.002    0.000    0.007    0.000 contextlib.py:157(helper)
     2170    0.007    0.000    0.007    0.000 grad_mode.py:119(__init__)
     2170    0.004    0.000    0.006    0.000 abc.py:180(__instancecheck__)
     2170    0.004    0.000    0.005    0.000 contextlib.py:59(__init__)
     2170    0.003    0.000    0.004    0.000 grad_mode.py:213(__init__)
     2170    0.003    0.000    0.004    0.000 grad_mode.py:167(__enter__)
     2170    0.003    0.000    0.003    0.000 {method 'format' of 'str' objects}
     6510    0.002    0.000    0.002    0.000 {built-in method torch._C.is_grad_enabled}
     4340    0.002    0.000    0.002    0.000 _weakrefset.py:70(__contains__)
     4340    0.001    0.000    0.001    0.000 {built-in method torch._C._set_grad_enabled}
     2170    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     2170    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
     2170    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)



Profile stats for: on_before_optimizer_step
         151900 function calls in 0.065 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     2170    0.012    0.000    0.055    0.000 callback_hook.py:304(on_before_optimizer_step)
    10850    0.006    0.000    0.041    0.000 trainer.py:1686(lightning_module)
    10850    0.005    0.000    0.033    0.000 accelerator.py:172(lightning_module)
    10850    0.004    0.000    0.029    0.000 training_type_plugin.py:171(lightning_module)
    10850    0.005    0.000    0.025    0.000 base.py:104(unwrap_lightning_module)
    21700    0.007    0.000    0.020    0.000 {built-in method builtins.isinstance}
    10850    0.008    0.000    0.013    0.000 abc.py:180(__instancecheck__)
    21700    0.005    0.000    0.005    0.000 _weakrefset.py:70(__contains__)
     2170    0.001    0.000    0.004    0.000 contextlib.py:85(__exit__)
     2170    0.001    0.000    0.004    0.000 {built-in method builtins.next}
     2170    0.001    0.000    0.003    0.000 base.py:68(profile)
     4340    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
     2170    0.001    0.000    0.002    0.000 advanced.py:66(stop)
    13020    0.002    0.000    0.002    0.000 trainer.py:1611(accelerator)
     2170    0.002    0.000    0.002    0.000 {built-in method builtins.hasattr}
    10850    0.001    0.000    0.001    0.000 base.py:323(on_before_optimizer_step)
     2170    0.001    0.000    0.001    0.000 trainer.py:1615(training_type_plugin)
     4340    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
     2170    0.000    0.000    0.000    0.000 hooks.py:256(on_before_optimizer_step)
     2170    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
     2170    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_epoch_end
         27855 function calls (27793 primitive calls) in 5.226 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    5.226    0.523 callback_hook.py:90(on_train_epoch_end)
       10    0.000    0.000    5.220    0.522 model_checkpoint.py:311(on_train_epoch_end)
       10    0.000    0.000    5.220    0.522 model_checkpoint.py:376(save_checkpoint)
       10    0.000    0.000    5.219    0.522 model_checkpoint.py:689(_save_none_monitor_checkpoint)
       10    0.000    0.000    5.068    0.507 trainer.py:1912(save_checkpoint)
       10    0.000    0.000    5.068    0.507 checkpoint_connector.py:470(save_checkpoint)
       10    0.000    0.000    5.064    0.506 training_type_plugin.py:286(save_checkpoint)
       10    0.045    0.004    5.063    0.506 torch_plugin.py:32(save_checkpoint)
       10    0.001    0.000    5.017    0.502 cloud_io.py:50(atomic_save)
       10    0.001    0.000    3.865    0.387 serialization.py:333(save)
       10    2.771    0.277    3.864    0.386 serialization.py:457(_save)
       10    0.000    0.000    1.144    0.114 local.py:316(write)
       10    1.144    0.114    1.144    0.114 {method 'write' of '_io.BufferedWriter' objects}
      150    0.001    0.000    1.086    0.007 storage.py:70(cpu)
      150    0.001    0.000    1.085    0.007 __init__.py:613(type)
      150    0.002    0.000    1.081    0.007 _utils.py:10(_type)
      150    1.079    0.007    1.079    0.007 {method 'copy_' of 'torch._C.FloatStorageBase' objects}
        9    0.000    0.000    0.149    0.017 training_type_plugin.py:296(remove_checkpoint)
        9    0.000    0.000    0.149    0.017 torch_plugin.py:70(remove_checkpoint)
        9    0.000    0.000    0.147    0.016 local.py:137(rm)
        9    0.147    0.016    0.147    0.016 {built-in method posix.remove}
       10    0.002    0.000    0.007    0.001 {method 'dump' of '_pickle.Pickler' objects}
       10    0.000    0.000    0.005    0.001 tqdm_progress.py:239(on_train_epoch_end)
       10    0.000    0.000    0.004    0.000 checkpoint_connector.py:341(dump_checkpoint)
       10    0.000    0.000    0.003    0.000 core.py:406(open)
       10    0.000    0.000    0.003    0.000 core.py:219(open_files)
     4438    0.001    0.000    0.003    0.000 serialization.py:461(persistent_id)
       10    0.000    0.000    0.003    0.000 std.py:1416(set_postfix)
       10    0.000    0.000    0.002    0.000 std.py:1339(refresh)
       10    0.000    0.000    0.002    0.000 checkpoint_connector.py:480(_get_lightning_module_state_dict)
       10    0.000    0.000    0.002    0.000 notebook.py:149(display)
       10    0.000    0.000    0.002    0.000 training_type_plugin.py:281(lightning_module_state_dict)
       10    0.000    0.000    0.002    0.000 base.py:185(get_metrics)
    20/10    0.000    0.000    0.002    0.000 module.py:1286(state_dict)
       10    0.000    0.000    0.002    0.000 lightning.py:1791(get_progress_bar_dict)
       10    0.000    0.000    0.002    0.000 base.py:217(get_standard_metrics)
      160    0.000    0.000    0.002    0.000 _tensor.py:131(__reduce_ex__)
      160    0.001    0.000    0.002    0.000 _tensor.py:152(_reduce_ex_internal)
       10    0.000    0.000    0.002    0.000 model_checkpoint.py:648(_get_metric_interpolated_filepath_name)
       10    0.000    0.000    0.002    0.000 core.py:561(get_fs_token_paths)
       19    0.000    0.000    0.002    0.000 spec.py:553(exists)
       28    0.000    0.000    0.002    0.000 local.py:65(info)
       20    0.000    0.000    0.002    0.000 local.py:45(makedirs)
       10    0.000    0.000    0.002    0.000 core.py:100(__enter__)
       68    0.002    0.000    0.002    0.000 {built-in method posix.stat}
       29    0.001    0.000    0.001    0.000 spec.py:53(__call__)
       10    0.000    0.000    0.001    0.000 spec.py:954(open)
      150    0.000    0.000    0.001    0.000 __init__.py:269(__enter__)
       10    0.000    0.000    0.001    0.000 supporters.py:93(mean)
       10    0.000    0.000    0.001    0.000 supporters.py:105(_agg_memory)
       20    0.000    0.000    0.001    0.000 os.py:195(makedirs)
       10    0.001    0.000    0.001    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
      150    0.000    0.000    0.001    0.000 __init__.py:265(__init__)
       19    0.000    0.000    0.001    0.000 cloud_io.py:41(get_filesystem)
       30    0.000    0.000    0.001    0.000 traitlets.py:576(__set__)
       10    0.000    0.000    0.001    0.000 local.py:151(_open)
       10    0.001    0.000    0.001    0.000 version.py:261(__init__)
       30    0.000    0.000    0.001    0.000 traitlets.py:558(set)
       10    0.000    0.000    0.001    0.000 model_checkpoint.py:754(file_exists)
       10    0.000    0.000    0.001    0.000 local.py:240(__init__)
     2778    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
      150    0.001    0.000    0.001    0.000 _utils.py:7(_get_device_index)
       20    0.000    0.000    0.001    0.000 module.py:1249(_save_to_state_dict)
       10    0.000    0.000    0.001    0.000 local.py:252(_open)
        2    0.000    0.000    0.001    0.000 traitlets.py:1133(_notify_trait)
        2    0.000    0.000    0.001    0.000 widget.py:676(notify_change)
      150    0.000    0.000    0.001    0.000 __init__.py:477(current_device)
       10    0.001    0.000    0.001    0.000 {built-in method io.open}
        2    0.000    0.000    0.001    0.000 widget.py:538(send_state)
       50    0.001    0.000    0.001    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.001    0.000 core.py:299(<listcomp>)
       10    0.000    0.000    0.001    0.000 __init__.py:328(state_dict_hook)
     4438    0.001    0.000    0.001    0.000 __init__.py:291(is_storage)
    20/10    0.000    0.000    0.001    0.000 __init__.py:355(_recurse_update_dict)
       10    0.000    0.000    0.001    0.000 core.py:121(__exit__)
       10    0.000    0.000    0.001    0.000 core.py:153(close)
       10    0.000    0.000    0.001    0.000 core.py:211(_close)
       29    0.000    0.000    0.001    0.000 utils.py:271(tokenize)
       10    0.000    0.000    0.001    0.000 callback_hook.py:258(on_save_checkpoint)
      110    0.000    0.000    0.001    0.000 trainer.py:1686(lightning_module)
       97    0.000    0.000    0.001    0.000 local.py:182(_strip_protocol)
      714    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
        2    0.000    0.000    0.001    0.000 widget.py:814(_send)
        2    0.000    0.000    0.000    0.000 comm.py:120(send)
        2    0.000    0.000    0.000    0.000 comm.py:61(_publish_msg)
       10    0.000    0.000    0.000    0.000 serialization.py:263(_open_zipfile_writer)
      160    0.000    0.000    0.000    0.000 serialization.py:164(location_tag)
      110    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:550(format_checkpoint_name)
      300    0.000    0.000    0.000    0.000 __init__.py:188(_lazy_init)
      120    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       20    0.000    0.000    0.000    0.000 genericpath.py:16(exists)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:660(_monitor_candidates)
       10    0.000    0.000    0.000    0.000 serialization.py:254(__init__)
       10    0.000    0.000    0.000    0.000 std.py:355(format_meter)
       10    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
      120    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 widget.py:557(get_state)
      150    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_getDevice}
        2    0.000    0.000    0.000    0.000 traitlets.py:1407(traits)
       10    0.000    0.000    0.000    0.000 accelerator.py:388(optimizer_state)
        2    0.000    0.000    0.000    0.000 session.py:749(send)
       30    0.000    0.000    0.000    0.000 trainer.py:2151(_results)
       10    0.000    0.000    0.000    0.000 accelerator.py:393(<lambda>)
       20    0.000    0.000    0.000    0.000 {built-in method posix.mkdir}
       10    0.000    0.000    0.000    0.000 optimizer.py:96(state_dict)
        2    0.000    0.000    0.000    0.000 traitlets.py:224(getmembers)
    20/10    0.000    0.000    0.000    0.000 core.py:318(_un_chain)
       10    0.000    0.000    0.000    0.000 {method 'item' of 'torch._C._TensorBase' objects}
      172    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      300    0.000    0.000    0.000    0.000 __init__.py:146(is_initialized)
       10    0.000    0.000    0.000    0.000 version.py:444(_cmpkey)
       10    0.000    0.000    0.000    0.000 serialization.py:228(_open_file_like)
       10    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
       60    0.000    0.000    0.000    0.000 trainer.py:1957(training)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:520(_format_checkpoint_name)
       10    0.000    0.000    0.000    0.000 copy.py:132(deepcopy)
       70    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
      150    0.000    0.000    0.000    0.000 _utils.py:476(_get_device_index)
      150    0.000    0.000    0.000    0.000 serialization.py:121(_cuda_tag)
       10    0.000    0.000    0.000    0.000 {method 'flush' of '_io._IOBase' objects}
       30    0.000    0.000    0.000    0.000 traitlets.py:587(_validate)
       10    0.000    0.000    0.000    0.000 core.py:320(<listcomp>)
       20    0.000    0.000    0.000    0.000 genericpath.py:39(isdir)
       20    0.000    0.000    0.000    0.000 trainer.py:2139(callback_metrics)
       10    0.000    0.000    0.000    0.000 serialization.py:258(__exit__)
       10    0.000    0.000    0.000    0.000 local.py:334(close)
        2    0.000    0.000    0.000    0.000 session.py:685(serialize)
       10    0.000    0.000    0.000    0.000 {method 'close' of '_io.BufferedWriter' objects}
        9    0.000    0.000    0.000    0.000 __init__.py:1286(debug)
       30    0.000    0.000    0.000    0.000 trainer.py:2126(_active_loop)
       20    0.000    0.000    0.000    0.000 logger_connector.py:335(callback_metrics)
       29    0.000    0.000    0.000    0.000 config.py:66(apply_config)
       29    0.000    0.000    0.000    0.000 {built-in method _hashlib.openssl_md5}
       10    0.000    0.000    0.000    0.000 trainer.py:2147(progress_bar_metrics)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:633(_validate_monitor_key)
       10    0.000    0.000    0.000    0.000 logger_connector.py:349(progress_bar_metrics)
       10    0.000    0.000    0.000    0.000 optimizer.py:118(<listcomp>)
      300    0.000    0.000    0.000    0.000 {method 'get_device' of 'torch._C.CudaFloatStorageBase' objects}
       20    0.000    0.000    0.000    0.000 imports.py:138(_fault_tolerant_training)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:254(state_key)
       30    0.000    0.000    0.000    0.000 re.py:286(_compile)
      160    0.000    0.000    0.000    0.000 _namedtensor_internals.py:10(check_serializing_named_tensor)
       10    0.000    0.000    0.000    0.000 core.py:302(<listcomp>)
       97    0.000    0.000    0.000    0.000 local.py:200(make_path_posix)
       20    0.000    0.000    0.000    0.000 posixpath.py:104(split)
       10    0.000    0.000    0.000    0.000 registry.py:199(get_filesystem_class)
       10    0.000    0.000    0.000    0.000 optimizer.py:110(pack_group)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.dir}
      160    0.000    0.000    0.000    0.000 {method 'storage' of 'torch._C._TensorBase' objects}
       20    0.000    0.000    0.000    0.000 serialization.py:193(_is_path)
        8    0.000    0.000    0.000    0.000 session.py:95(json_packer)
        9    0.000    0.000    0.000    0.000 __init__.py:1544(isEnabledFor)
       10    0.000    0.000    0.000    0.000 core.py:298(<setcomp>)
       30    0.000    0.000    0.000    0.000 traitlets.py:596(_cross_validate)
       10    0.000    0.000    0.000    0.000 local.py:348(__getattr__)
        9    0.000    0.000    0.000    0.000 spec.py:622(isdir)
      160    0.000    0.000    0.000    0.000 serialization.py:183(normalize_storage_type)
       20    0.000    0.000    0.000    0.000 os.py:760(getenv)
       10    0.000    0.000    0.000    0.000 version.py:432(_parse_local_version)
      196    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       30    0.000    0.000    0.000    0.000 os.py:664(__getitem__)
       10    0.000    0.000    0.000    0.000 re.py:214(findall)
        8    0.000    0.000    0.000    0.000 __init__.py:183(dumps)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:406(_should_skip_saving_checkpoint)
       30    0.000    0.000    0.000    0.000 fit_loop.py:142(_results)
     16/4    0.000    0.000    0.000    0.000 jsonutil.py:73(json_clean)
       10    0.000    0.000    0.000    0.000 re.py:231(compile)
       90    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
       10    0.000    0.000    0.000    0.000 posixpath.py:75(join)
       20    0.000    0.000    0.000    0.000 _collections_abc.py:657(get)
      300    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.CudaFloatStorageBase' objects}
       10    0.000    0.000    0.000    0.000 core.py:628(<listcomp>)
      300    0.000    0.000    0.000    0.000 {built-in method torch._C._cuda_isInBadFork}
       10    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
      334    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
      176    0.000    0.000    0.000    0.000 traitlets.py:545(__get__)
      150    0.000    0.000    0.000    0.000 __init__.py:278(__exit__)
       10    0.000    0.000    0.000    0.000 trainer.py:1777(is_global_zero)
       20    0.000    0.000    0.000    0.000 {method 'getvalue' of '_io.BytesIO' objects}
       10    0.000    0.000    0.000    0.000 core.py:524(expand_paths_if_needed)
      170    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C.FloatStorageBase' objects}
        8    0.000    0.000    0.000    0.000 encoder.py:182(encode)
       10    0.000    0.000    0.000    0.000 {method 'search' of '_sre.SRE_Pattern' objects}
       10    0.000    0.000    0.000    0.000 {method 'cpu' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.000    0.000 core.py:60(__init__)
       10    0.000    0.000    0.000    0.000 base.py:51(_generate_state_key)
      160    0.000    0.000    0.000    0.000 serialization.py:116(_cpu_tag)
       59    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       10    0.000    0.000    0.000    0.000 local.py:174(_parent)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
      100    0.000    0.000    0.000    0.000 {method 'group' of '_sre.SRE_Match' objects}
    70/50    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        8    0.000    0.000    0.000    0.000 encoder.py:204(iterencode)
       10    0.000    0.000    0.000    0.000 utils.py:98(update_storage_options)
       10    0.000    0.000    0.000    0.000 posixpath.py:154(dirname)
       10    0.000    0.000    0.000    0.000 tqdm_progress.py:41(format_num)
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       10    0.000    0.000    0.000    0.000 utils.py:296(<listcomp>)
      160    0.000    0.000    0.000    0.000 {method 'data_ptr' of 'torch._C.FloatStorageBase' objects}
      117    0.000    0.000    0.000    0.000 utils.py:291(stringify_path)
       10    0.000    0.000    0.000    0.000 stochastic_weight_avg.py:224(on_train_epoch_end)
      160    0.000    0.000    0.000    0.000 {method 'size' of 'torch._C._TensorBase' objects}
      300    0.000    0.000    0.000    0.000 _jit_internal.py:957(is_scripting)
       10    0.000    0.000    0.000    0.000 std.py:104(acquire)
       20    0.000    0.000    0.000    0.000 std.py:288(format_interval)
      209    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.repr}
      160    0.000    0.000    0.000    0.000 {method 'element_size' of 'torch._C.FloatStorageBase' objects}
      140    0.000    0.000    0.000    0.000 types.py:135(__get__)
      174    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
       10    0.000    0.000    0.000    0.000 {method 'findall' of '_sre.SRE_Pattern' objects}
      160    0.000    0.000    0.000    0.000 hooks.py:54(warn_if_has_hooks)
      160    0.000    0.000    0.000    0.000 {method 'has_names' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:351(on_save_checkpoint)
       10    0.000    0.000    0.000    0.000 notebook.py:200(colour)
       69    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
      160    0.000    0.000    0.000    0.000 {method 'stride' of 'torch._C._TensorBase' objects}
       33    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
       31    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
       19    0.000    0.000    0.000    0.000 training_type_plugin.py:326(should_rank_save_checkpoint)
       10    0.000    0.000    0.000    0.000 std.py:310(format_num)
      150    0.000    0.000    0.000    0.000 storage.py:13(__init__)
       10    0.000    0.000    0.000    0.000 serialization.py:314(_check_dill_version)
        2    0.000    0.000    0.000    0.000 traitlets.py:1421(<listcomp>)
       30    0.000    0.000    0.000    0.000 os.py:742(encode)
       10    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
       10    0.000    0.000    0.000    0.000 trainer.py:2016(sanity_checking)
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 iostream.py:260(send_multipart)
       40    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
      160    0.000    0.000    0.000    0.000 {method 'setdefault' of 'dict' objects}
       10    0.000    0.000    0.000    0.000 core.py:170(__init__)
        2    0.000    0.000    0.000    0.000 session.py:644(msg)
       10    0.000    0.000    0.000    0.000 re.py:204(split)
       20    0.000    0.000    0.000    0.000 version.py:438(<genexpr>)
        2    0.000    0.000    0.000    0.000 iostream.py:207(send_multipart)
      146    0.000    0.000    0.000    0.000 {method 'rstrip' of 'str' objects}
      204    0.000    0.000    0.000    0.000 {method 'startswith' of 'str' objects}
        2    0.000    0.000    0.000    0.000 iostream.py:195(schedule)
      150    0.000    0.000    0.000    0.000 _utils.py:82(_get_async_or_non_blocking)
      314    0.000    0.000    0.000    0.000 {built-in method builtins.len}
       10    0.000    0.000    0.000    0.000 optimizer.py:120(<dictcomp>)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.all}
       20    0.000    0.000    0.000    0.000 hparams_mixin.py:127(hparams)
       30    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
       30    0.000    0.000    0.000    0.000 version.py:393(_parse_letter_version)
        2    0.000    0.000    0.000    0.000 session.py:670(sign)
       81    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
       18    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
       50    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
       10    0.000    0.000    0.000    0.000 copy.py:252(_keep_alive)
       40    0.000    0.000    0.000    0.000 posixpath.py:41(_get_sep)
       20    0.000    0.000    0.000    0.000 {method 'split' of '_sre.SRE_Pattern' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.sorted}
       10    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
       10    0.000    0.000    0.000    0.000 traitlets.py:904(__call__)
       52    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       40    0.000    0.000    0.000    0.000 version.py:271(<genexpr>)
        2    0.000    0.000    0.000    0.000 session.py:641(msg_header)
       20    0.000    0.000    0.000    0.000 __init__.py:12(escape)
      130    0.000    0.000    0.000    0.000 traitlets.py:526(get)
        9    0.000    0.000    0.000    0.000 __init__.py:1530(getEffectiveLevel)
       10    0.000    0.000    0.000    0.000 {built-in method now}
      140    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
      150    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
       20    0.000    0.000    0.000    0.000 local.py:337(closed)
       10    0.000    0.000    0.000    0.000 optimizer.py:113(<dictcomp>)
        4    0.000    0.000    0.000    0.000 jsonutil.py:108(json_default)
       10    0.000    0.000    0.000    0.000 core.py:595(<listcomp>)
       10    0.000    0.000    0.000    0.000 <string>:12(__new__)
       20    0.000    0.000    0.000    0.000 serialization.py:199(__init__)
       20    0.000    0.000    0.000    0.000 serialization.py:202(__enter__)
       10    0.000    0.000    0.000    0.000 std.py:108(release)
       10    0.000    0.000    0.000    0.000 copy.py:236(_deepcopy_dict)
       40    0.000    0.000    0.000    0.000 {built-in method posix.fspath}
       10    0.000    0.000    0.000    0.000 trainer.py:1623(global_rank)
       10    0.000    0.000    0.000    0.000 registry.py:36(__contains__)
       10    0.000    0.000    0.000    0.000 widget_float.py:33(_validate_value)
        2    0.000    0.000    0.000    0.000 traitlets.py:1142(notify_change)
       19    0.000    0.000    0.000    0.000 single_device.py:73(is_global_zero)
       30    0.000    0.000    0.000    0.000 trainer.py:2031(global_step)
       10    0.000    0.000    0.000    0.000 {method 'rsplit' of 'str' objects}
       20    0.000    0.000    0.000    0.000 version.py:501(<genexpr>)
       20    0.000    0.000    0.000    0.000 base.py:126(on_train_epoch_end)
        2    0.000    0.000    0.000    0.000 socket.py:480(send)
       29    0.000    0.000    0.000    0.000 {built-in method _thread.get_ident}
      160    0.000    0.000    0.000    0.000 {method 'storage_offset' of 'torch._C._TensorBase' objects}
       10    0.000    0.000    0.000    0.000 tqdm_progress.py:324(_update_bar)
       30    0.000    0.000    0.000    0.000 {method 'rfind' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'isoformat' of 'datetime.datetime' objects}
       30    0.000    0.000    0.000    0.000 std.py:1442(<genexpr>)
        2    0.000    0.000    0.000    0.000 session.py:271(msg_header)
       19    0.000    0.000    0.000    0.000 training_type_plugin.py:42(checkpoint_io)
       10    0.000    0.000    0.000    0.000 spec.py:143(_fs_token)
       10    0.000    0.000    0.000    0.000 optimizer.py:115(<listcomp>)
       10    0.000    0.000    0.000    0.000 traitlets.py:1983(validate)
      264    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
       10    0.000    0.000    0.000    0.000 core.py:124(__del__)
      140    0.000    0.000    0.000    0.000 enum.py:599(value)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:676(_save_top_k_checkpoint)
       10    0.000    0.000    0.000    0.000 fit_loop.py:135(_skip_backward)
      240    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       10    0.000    0.000    0.000    0.000 trainer.py:2047(max_steps)
       10    0.000    0.000    0.000    0.000 model_checkpoint.py:665(_save_last_checkpoint)
       10    0.000    0.000    0.000    0.000 core.py:506(split_protocol)
       10    0.000    0.000    0.000    0.000 version.py:326(release)
       10    0.000    0.000    0.000    0.000 optimizer.py:112(<dictcomp>)
        2    0.000    0.000    0.000    0.000 session.py:199(utcnow)
       20    0.000    0.000    0.000    0.000 traitlets.py:2045(validate)
       10    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
       20    0.000    0.000    0.000    0.000 core.py:498(get_compression)
       10    0.000    0.000    0.000    0.000 version.py:459(<lambda>)
        4    0.000    0.000    0.000    0.000 lr_scheduler.py:79(state_dict)
       20    0.000    0.000    0.000    0.000 fit_loop.py:70(global_step)
        4    0.000    0.000    0.000    0.000 traitlets.py:1439(trait_metadata)
        2    0.000    0.000    0.000    0.000 widget.py:724(_should_send_property)
       30    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
       10    0.000    0.000    0.000    0.000 {method 'split' of 'str' objects}
       12    0.000    0.000    0.000    0.000 {built-in method builtins.max}
       10    0.000    0.000    0.000    0.000 spec.py:178(_get_kwargs_from_urls)
       10    0.000    0.000    0.000    0.000 serialization.py:224(__exit__)
       38    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISDIR}
       18    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISLNK}
       10    0.000    0.000    0.000    0.000 {method 'endswith' of 'str' objects}
       40    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
       10    0.000    0.000    0.000    0.000 single_device.py:80(broadcast)
       10    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
       10    0.000    0.000    0.000    0.000 std.py:233(__call__)
       10    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        8    0.000    0.000    0.000    0.000 hmac.py:90(update)
        2    0.000    0.000    0.000    0.000 hmac.py:95(copy)
       10    0.000    0.000    0.000    0.000 traitlets.py:1832(_validate_bounds)
       39    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
       64    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}
       10    0.000    0.000    0.000    0.000 base.py:75(after_save_checkpoint)
       10    0.000    0.000    0.000    0.000 trainer.py:1703(lr_schedulers)
       10    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        2    0.000    0.000    0.000    0.000 hmac.py:127(hexdigest)
        2    0.000    0.000    0.000    0.000 session.py:597(msg_id)
       10    0.000    0.000    0.000    0.000 {method 'update' of '_hashlib.HASH' objects}
        2    0.000    0.000    0.000    0.000 threading.py:1104(is_alive)
       20    0.000    0.000    0.000    0.000 {method 'clear' of 'list' objects}
       10    0.000    0.000    0.000    0.000 trainer.py:1619(precision_plugin)
       10    0.000    0.000    0.000    0.000 trainer.py:1690(optimizers)
       10    0.000    0.000    0.000    0.000 core.py:541(<listcomp>)
       20    0.000    0.000    0.000    0.000 core.py:621(<genexpr>)
        2    0.000    0.000    0.000    0.000 widget.py:138(_remove_buffers)
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
       40    0.000    0.000    0.000    0.000 {method 'keys' of 'dict' objects}
       20    0.000    0.000    0.000    0.000 {method 'flush' of '_io.BytesIO' objects}
        2    0.000    0.000    0.000    0.000 {method 'replace' of 'datetime.datetime' objects}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.min}
       20    0.000    0.000    0.000    0.000 tensorboard.py:281(version)
       29    0.000    0.000    0.000    0.000 spec.py:56(<genexpr>)
       20    0.000    0.000    0.000    0.000 core.py:630(<genexpr>)
       90    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
       10    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        4    0.000    0.000    0.000    0.000 lr_scheduler.py:85(<dictcomp>)
        2    0.000    0.000    0.000    0.000 hmac.py:108(_current)
        4    0.000    0.000    0.000    0.000 bunch.py:11(__getattr__)
       30    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
       10    0.000    0.000    0.000    0.000 {built-in method time.time}
       10    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
       12    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
       10    0.000    0.000    0.000    0.000 lightning.py:265(truncated_bptt_steps)
       20    0.000    0.000    0.000    0.000 hooks.py:802(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 widget.py:93(_separate_buffers)
       30    0.000    0.000    0.000    0.000 base.py:54(trainer)
       10    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        8    0.000    0.000    0.000    0.000 encoder.py:104(__init__)
       10    0.000    0.000    0.000    0.000 {method 'isdigit' of 'str' objects}
       20    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
       10    0.000    0.000    0.000    0.000 registry.py:24(__getitem__)
       40    0.000    0.000    0.000    0.000 base.py:283(on_save_checkpoint)
        2    0.000    0.000    0.000    0.000 session.py:844(<listcomp>)
        6    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
        2    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
       20    0.000    0.000    0.000    0.000 {method 'keys' of 'collections.OrderedDict' objects}
       20    0.000    0.000    0.000    0.000 {method 'values' of 'collections.OrderedDict' objects}
       20    0.000    0.000    0.000    0.000 {method 'strip' of 'str' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 hooks.py:193(on_train_epoch_end)
       10    0.000    0.000    0.000    0.000 fit_loop.py:123(running_loss)
        2    0.000    0.000    0.000    0.000 tz.py:218(utcoffset)
        4    0.000    0.000    0.000    0.000 jsonutil.py:39(_ensure_tzinfo)
        2    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
       12    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method utcnow}
       10    0.000    0.000    0.000    0.000 utilities.py:173(_is_max_limit_reached)
        2    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
        2    0.000    0.000    0.000    0.000 session.py:278(extract_header)
        2    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.locals}
        2    0.000    0.000    0.000    0.000 widget.py:779(_trait_to_json)
       10    0.000    0.000    0.000    0.000 fit_loop.py:102(max_steps)
        2    0.000    0.000    0.000    0.000 jsonutil.py:131(<listcomp>)
        2    0.000    0.000    0.000    0.000 threading.py:506(is_set)
        4    0.000    0.000    0.000    0.000 {method '__getitem__' of 'dict' objects}
       18    0.000    0.000    0.000    0.000 {built-in method _stat.S_ISREG}
        2    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        2    0.000    0.000    0.000    0.000 tz.py:262(_isdst)
        6    0.000    0.000    0.000    0.000 traitlets.py:911(__get__)



Profile stats for: on_epoch_end
         700 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       10    0.000    0.000    0.000    0.000 callback_hook.py:130(on_epoch_end)
       50    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
       50    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
       50    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
       50    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
      100    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
       50    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
      100    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
       10    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       10    0.000    0.000    0.000    0.000 {built-in method builtins.next}
       10    0.000    0.000    0.000    0.000 base.py:68(profile)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       10    0.000    0.000    0.000    0.000 advanced.py:66(stop)
       60    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
       10    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
       50    0.000    0.000    0.000    0.000 base.py:164(on_epoch_end)
       10    0.000    0.000    0.000    0.000 hooks.py:187(on_epoch_end)
       10    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
       20    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
       10    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_train_end
         1883 function calls (1867 primitive calls) in 0.028 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.028    0.028 callback_hook.py:140(on_train_end)
        1    0.000    0.000    0.026    0.026 stochastic_weight_avg.py:227(on_train_end)
        1    0.000    0.000    0.026    0.026 stochastic_weight_avg.py:238(transfer_weights)
        5    0.026    0.005    0.026    0.005 {method 'to' of 'torch._C._TensorBase' objects}
        1    0.000    0.000    0.002    0.002 tqdm_progress.py:244(on_train_end)
        1    0.000    0.000    0.002    0.002 notebook.py:279(close)
        1    0.000    0.000    0.002    0.002 notebook.py:149(display)
        4    0.000    0.000    0.001    0.000 traitlets.py:576(__set__)
        4    0.000    0.000    0.001    0.000 traitlets.py:558(set)
        2    0.000    0.000    0.001    0.001 traitlets.py:1133(_notify_trait)
        2    0.000    0.000    0.001    0.001 widget.py:676(notify_change)
        2    0.000    0.000    0.001    0.001 widget.py:538(send_state)
        2    0.000    0.000    0.001    0.000 widget.py:814(_send)
        2    0.000    0.000    0.001    0.000 comm.py:120(send)
        2    0.000    0.000    0.001    0.000 comm.py:61(_publish_msg)
        2    0.000    0.000    0.000    0.000 widget.py:557(get_state)
        2    0.000    0.000    0.000    0.000 traitlets.py:1407(traits)
        2    0.000    0.000    0.000    0.000 session.py:749(send)
        2    0.000    0.000    0.000    0.000 traitlets.py:224(getmembers)
        2    0.000    0.000    0.000    0.000 session.py:685(serialize)
        8    0.000    0.000    0.000    0.000 session.py:95(json_packer)
        8    0.000    0.000    0.000    0.000 __init__.py:183(dumps)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.dir}
      255    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
      400    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 {method 'copy_' of 'torch._C._TensorBase' objects}
        8    0.000    0.000    0.000    0.000 encoder.py:182(encode)
     16/4    0.000    0.000    0.000    0.000 jsonutil.py:73(json_clean)
       12    0.000    0.000    0.000    0.000 module.py:1499(parameters)
        8    0.000    0.000    0.000    0.000 encoder.py:204(iterencode)
        1    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
       12    0.000    0.000    0.000    0.000 module.py:1523(named_parameters)
       12    0.000    0.000    0.000    0.000 module.py:1486(_named_members)
        2    0.000    0.000    0.000    0.000 iostream.py:260(send_multipart)
        2    0.000    0.000    0.000    0.000 iostream.py:207(send_multipart)
        2    0.000    0.000    0.000    0.000 iostream.py:195(schedule)
        1    0.000    0.000    0.000    0.000 std.py:355(format_meter)
        1    0.000    0.000    0.000    0.000 std.py:1279(close)
      126    0.000    0.000    0.000    0.000 traitlets.py:545(__get__)
        1    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
        4    0.000    0.000    0.000    0.000 traitlets.py:587(_validate)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        2    0.000    0.000    0.000    0.000 session.py:670(sign)
        2    0.000    0.000    0.000    0.000 session.py:644(msg)
        2    0.000    0.000    0.000    0.000 traitlets.py:1421(<listcomp>)
       37    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 std.py:583(_decr_instances)
        4    0.000    0.000    0.000    0.000 jsonutil.py:108(json_default)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        2    0.000    0.000    0.000    0.000 socket.py:480(send)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        2    0.000    0.000    0.000    0.000 session.py:641(msg_header)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 traitlets.py:1142(notify_change)
        5    0.000    0.000    0.000    0.000 {method 'detach' of 'torch._C._TensorBase' objects}
        4    0.000    0.000    0.000    0.000 {method 'isoformat' of 'datetime.datetime' objects}
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:335(on_train_end)
       42    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       77    0.000    0.000    0.000    0.000 traitlets.py:526(get)
        1    0.000    0.000    0.000    0.000 model_checkpoint.py:406(_should_skip_saving_checkpoint)
        1    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        4    0.000    0.000    0.000    0.000 traitlets.py:596(_cross_validate)
        2    0.000    0.000    0.000    0.000 session.py:271(msg_header)
       74    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
     10/6    0.000    0.000    0.000    0.000 module.py:1653(named_modules)
        1    0.000    0.000    0.000    0.000 notebook.py:200(colour)
        2    0.000    0.000    0.000    0.000 widget.py:138(_remove_buffers)
      246    0.000    0.000    0.000    0.000 {method 'append' of 'list' objects}
        7    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        2    0.000    0.000    0.000    0.000 widget.py:93(_separate_buffers)
       20    0.000    0.000    0.000    0.000 _tensor.py:650(__hash__)
        2    0.000    0.000    0.000    0.000 widget.py:724(_should_send_property)
        1    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        2    0.000    0.000    0.000    0.000 hmac.py:95(copy)
        4    0.000    0.000    0.000    0.000 traitlets.py:1439(trait_metadata)
        2    0.000    0.000    0.000    0.000 session.py:199(utcnow)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
        1    0.000    0.000    0.000    0.000 traitlets.py:2154(validate)
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        1    0.000    0.000    0.000    0.000 utils.py:296(<listcomp>)
        8    0.000    0.000    0.000    0.000 hmac.py:90(update)
       12    0.000    0.000    0.000    0.000 {method 'extend' of 'list' objects}
        2    0.000    0.000    0.000    0.000 hmac.py:127(hexdigest)
        2    0.000    0.000    0.000    0.000 session.py:597(msg_id)
        1    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 tz.py:218(utcoffset)
        1    0.000    0.000    0.000    0.000 os.py:664(__getitem__)
       14    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:2016(sanity_checking)
        2    0.000    0.000    0.000    0.000 threading.py:1104(is_alive)
        1    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
       15    0.000    0.000    0.000    0.000 {method 'replace' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method now}
        1    0.000    0.000    0.000    0.000 std.py:115(__exit__)
       10    0.000    0.000    0.000    0.000 {method 'update' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 re.py:204(split)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        2    0.000    0.000    0.000    0.000 {method 'sort' of 'list' objects}
        1    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 traitlets.py:904(__call__)
        2    0.000    0.000    0.000    0.000 tz.py:262(_isdst)
        2    0.000    0.000    0.000    0.000 {method 'replace' of 'datetime.datetime' objects}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        2    0.000    0.000    0.000    0.000 hmac.py:108(_current)
        2    0.000    0.000    0.000    0.000 __init__.py:12(escape)
        8    0.000    0.000    0.000    0.000 encoder.py:104(__init__)
        4    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:997(_handle_fromlist)
       11    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 {method 'copy' of '_hashlib.HASH' objects}
       23    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:2031(global_step)
        1    0.000    0.000    0.000    0.000 {method 'split' of '_sre.SRE_Pattern' objects}
       34    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 widget_float.py:33(_validate_value)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        4    0.000    0.000    0.000    0.000 bunch.py:11(__getattr__)
        2    0.000    0.000    0.000    0.000 threading.py:1062(_wait_for_tstate_lock)
        1    0.000    0.000    0.000    0.000 os.py:742(encode)
        4    0.000    0.000    0.000    0.000 module.py:1544(<lambda>)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 iostream.py:91(_event_pipe)
        2    0.000    0.000    0.000    0.000 session.py:844(<listcomp>)
        1    0.000    0.000    0.000    0.000 traitlets.py:1983(validate)
        2    0.000    0.000    0.000    0.000 types.py:135(__get__)
       10    0.000    0.000    0.000    0.000 {method 'items' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {built-in method posix.getpid}
        2    0.000    0.000    0.000    0.000 {built-in method utcnow}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.locals}
        7    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'digest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 re.py:286(_compile)
        4    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
       21    0.000    0.000    0.000    0.000 {built-in method builtins.id}
       20    0.000    0.000    0.000    0.000 {built-in method torch._C._has_torch_function_unary}
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
        2    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 std.py:233(__call__)
        2    0.000    0.000    0.000    0.000 std.py:1167(_comparable)
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 stochastic_weight_avg.py:131(swa_end)
        4    0.000    0.000    0.000    0.000 jsonutil.py:39(_ensure_tzinfo)
        2    0.000    0.000    0.000    0.000 session.py:278(extract_header)
        2    0.000    0.000    0.000    0.000 traitlets.py:2045(validate)
        2    0.000    0.000    0.000    0.000 threading.py:506(is_set)
        2    0.000    0.000    0.000    0.000 enum.py:599(value)
        7    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        2    0.000    0.000    0.000    0.000 {method 'copy' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {built-in method time.time}
        1    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.lock' objects}
        2    0.000    0.000    0.000    0.000 {method 'append' of 'collections.deque' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        2    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x9d12c0}
        1    0.000    0.000    0.000    0.000 hooks.py:43(on_train_end)
        2    0.000    0.000    0.000    0.000 base.py:234(on_train_end)
        2    0.000    0.000    0.000    0.000 widget.py:779(_trait_to_json)
        1    0.000    0.000    0.000    0.000 fit_loop.py:65(global_step)
        2    0.000    0.000    0.000    0.000 jsonutil.py:131(<listcomp>)
        2    0.000    0.000    0.000    0.000 {method 'hexdigest' of '_hashlib.HASH' objects}
        1    0.000    0.000    0.000    0.000 py3compat.py:12(no_code)
        9    0.000    0.000    0.000    0.000 traitlets.py:911(__get__)
        1    0.000    0.000    0.000    0.000 traitlets.py:1832(_validate_bounds)
        4    0.000    0.000    0.000    0.000 {method '__getitem__' of 'dict' objects}
        8    0.000    0.000    0.000    0.000 {method 'join' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:347(on_train_end)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        1    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}



Profile stats for: on_fit_end
         70 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:70(on_fit_end)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:34(on_fit_end)
        5    0.000    0.000    0.000    0.000 base.py:87(on_fit_end)
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: teardown
         67 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:50(teardown)
        5    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        5    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        5    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        5    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       10    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        5    0.000    0.000    0.000    0.000 abc.py:180(__instancecheck__)
        1    0.000    0.000    0.000    0.000 contextlib.py:85(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
       10    0.000    0.000    0.000    0.000 _weakrefset.py:70(__contains__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        5    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:399(teardown)
        5    0.000    0.000    0.000    0.000 base.py:71(teardown)
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}


FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  6.7956         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  6.2163         	|1              	|  6.2163         	|  91.476         	|
run_training_batch                 	|  0.022825       	|200            	|  4.565          	|  67.176         	|
training_step_and_backward         	|  0.012867       	|200            	|  2.5733         	|  37.868         	|
model_forward                      	|  0.010698       	|200            	|  2.1396         	|  31.486         	|
training_step                      	|  0.010523       	|200            	|  2.1047         	|  30.971         	|
get_train_batch                    	|  0.0068617      	|201            	|  1.3792         	|  20.296         	|
fetch_next_train_batch             	|  0.0068435      	|201            	|  1.3755         	|  20.242         	|
optimizer_step_with_closure_0      	|  0.013457       	|100            	|  1.3457         	|  19.803         	|
backward                           	|  0.0020811      	|200            	|  0.41623        	|  6.125          	|
on_train_batch_end                 	|  0.00037959     	|200            	|  0.075918       	|  1.1172         	|
training_batch_to_device           	|  0.00032445     	|200            	|  0.06489        	|  0.95489        	|
on_batch_start                     	|  0.00012498     	|200            	|  0.024995       	|  0.36782        	|
on_train_batch_start               	|  7.011e-05      	|200            	|  0.014022       	|  0.20634        	|
zero_grad                          	|  0.00012411     	|100            	|  0.012411       	|  0.18264        	|
on_batch_end                       	|  1.1852e-05     	|200            	|  0.0023703      	|  0.034881       	|
on_after_backward                  	|  1.1177e-05     	|200            	|  0.0022354      	|  0.032895       	|
on_before_backward                 	|  8.4172e-06     	|200            	|  0.0016834      	|  0.024773       	|
training_step_end                  	|  6.9663e-06     	|200            	|  0.0013933      	|  0.020503       	|
on_before_zero_grad                	|  8.8803e-06     	|100            	|  0.00088803     	|  0.013068       	|
on_before_optimizer_step           	|  7.798e-06      	|100            	|  0.0007798      	|  0.011475       	|
train_dataloader                   	|  0.00028878     	|1              	|  0.00028878     	|  0.0042495      	|
configure_optimizers               	|  0.00014447     	|1              	|  0.00014447     	|  0.0021259      	|
on_train_start                     	|  2.4347e-05     	|1              	|  2.4347e-05     	|  0.00035828     	|
on_before_accelerator_backend_setup	|  2.0965e-05     	|1              	|  2.0965e-05     	|  0.00030851     	|
configure_callbacks                	|  1.7539e-05     	|1              	|  1.7539e-05     	|  0.00025809     	|
on_train_epoch_end                 	|  1.6965e-05     	|1              	|  1.6965e-05     	|  0.00024965     	|
on_pretrain_routine_start          	|  1.5656e-05     	|1              	|  1.5656e-05     	|  0.00023039     	|
on_configure_sharded_model         	|  1.4479e-05     	|1              	|  1.4479e-05     	|  0.00021307     	|
on_epoch_start                     	|  1.4173e-05     	|1              	|  1.4173e-05     	|  0.00020856     	|
on_epoch_end                       	|  1.2993e-05     	|1              	|  1.2993e-05     	|  0.0001912      	|
on_train_end                       	|  1.149e-05      	|1              	|  1.149e-05      	|  0.00016908     	|
teardown                           	|  1.0889e-05     	|1              	|  1.0889e-05     	|  0.00016024     	|
setup                              	|  1.015e-05      	|1              	|  1.015e-05      	|  0.00014936     	|
prepare_data                       	|  9.598e-06      	|1              	|  9.598e-06      	|  0.00014124     	|
on_pretrain_routine_end            	|  8.239e-06      	|1              	|  8.239e-06      	|  0.00012124     	|
on_train_epoch_start               	|  8.216e-06      	|1              	|  8.216e-06      	|  0.0001209      	|
on_train_dataloader                	|  7.64e-06       	|1              	|  7.64e-06       	|  0.00011243     	|
configure_sharded_model            	|  7.174e-06      	|1              	|  7.174e-06      	|  0.00010557     	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  311.7          	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  28.255         	|11             	|  310.81         	|  99.713         	|
run_training_batch                 	|  0.02175        	|9810           	|  213.37         	|  68.452         	|
training_step_and_backward         	|  0.012924       	|9810           	|  126.78         	|  40.674         	|
model_forward                      	|  0.010685       	|9810           	|  104.82         	|  33.627         	|
training_step                      	|  0.010509       	|9810           	|  103.09         	|  33.073         	|
get_train_batch                    	|  0.0069774      	|9821           	|  68.525         	|  21.984         	|
fetch_next_train_batch             	|  0.0069591      	|9821           	|  68.346         	|  21.926         	|
optimizer_step_with_closure_0      	|  0.013658       	|2270           	|  31.004         	|  9.9465         	|
backward                           	|  0.0021824      	|9810           	|  21.409         	|  6.8684         	|
on_train_batch_end                 	|  0.0012803      	|9810           	|  12.56          	|  4.0293         	|
on_train_epoch_end                 	|  0.4804         	|11             	|  5.2844         	|  1.6953         	|
training_batch_to_device           	|  0.0003376      	|9810           	|  3.3119         	|  1.0625         	|
on_train_batch_start               	|  0.00026536     	|9810           	|  2.6032         	|  0.83515        	|
on_batch_start                     	|  3.6137e-05     	|9810           	|  0.3545         	|  0.11373        	|
zero_grad                          	|  0.00014645     	|2270           	|  0.33245        	|  0.10665        	|
on_train_epoch_start               	|  0.027897       	|11             	|  0.30687        	|  0.09845        	|
on_batch_end                       	|  2.1997e-05     	|9810           	|  0.21579        	|  0.069228       	|
on_after_backward                  	|  1.9852e-05     	|9810           	|  0.19475        	|  0.06248        	|
on_before_backward                 	|  1.8811e-05     	|9810           	|  0.18453        	|  0.059202       	|
training_step_end                  	|  7.2677e-06     	|9810           	|  0.071297       	|  0.022873       	|
on_before_zero_grad                	|  1.9892e-05     	|2270           	|  0.045154       	|  0.014486       	|
on_before_optimizer_step           	|  1.768e-05      	|2270           	|  0.040134       	|  0.012876       	|
on_train_end                       	|  0.013381       	|2              	|  0.026763       	|  0.008586       	|
on_before_accelerator_backend_setup	|  0.010481       	|2              	|  0.020961       	|  0.0067248      	|
on_train_start                     	|  0.010195       	|2              	|  0.020391       	|  0.0065418      	|
on_pretrain_routine_start          	|  0.0012701      	|2              	|  0.0025402      	|  0.00081495     	|
train_dataloader                   	|  0.00045821     	|2              	|  0.00091642     	|  0.000294       	|
on_epoch_end                       	|  2.6101e-05     	|11             	|  0.00028711     	|  9.2111e-05     	|
configure_optimizers               	|  0.00012759     	|2              	|  0.00025518     	|  8.1867e-05     	|
on_epoch_start                     	|  1.9627e-05     	|11             	|  0.0002159      	|  6.9264e-05     	|
on_fit_start                       	|  8.0789e-05     	|1              	|  8.0789e-05     	|  2.5918e-05     	|
on_configure_sharded_model         	|  1.9097e-05     	|2              	|  3.8194e-05     	|  1.2253e-05     	|
setup                              	|  1.6256e-05     	|2              	|  3.2511e-05     	|  1.043e-05      	|
teardown                           	|  1.5056e-05     	|2              	|  3.0111e-05     	|  9.6601e-06     	|
on_pretrain_routine_end            	|  1.4915e-05     	|2              	|  2.9829e-05     	|  9.5696e-06     	|
configure_callbacks                	|  1.3686e-05     	|2              	|  2.7372e-05     	|  8.7814e-06     	|
on_fit_end                         	|  2.5704e-05     	|1              	|  2.5704e-05     	|  8.2463e-06     	|
prepare_data                       	|  7.884e-06      	|2              	|  1.5768e-05     	|  5.0586e-06     	|
configure_sharded_model            	|  7.356e-06      	|2              	|  1.4712e-05     	|  4.7199e-06     	|
on_train_dataloader                	|  7.322e-06      	|2              	|  1.4644e-05     	|  4.698e-06      	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  6.7295         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  6.1209         	|1              	|  6.1209         	|  90.956         	|
run_training_batch                 	|  0.022778       	|200            	|  4.5556         	|  67.696         	|
training_step_and_backward         	|  0.012942       	|200            	|  2.5883         	|  38.462         	|
model_forward                      	|  0.010637       	|200            	|  2.1274         	|  31.613         	|
training_step                      	|  0.010473       	|200            	|  2.0946         	|  31.126         	|
optimizer_step_with_closure_0      	|  0.013543       	|100            	|  1.3543         	|  20.125         	|
get_train_batch                    	|  0.0065099      	|201            	|  1.3085         	|  19.444         	|
fetch_next_train_batch             	|  0.0064927      	|201            	|  1.305          	|  19.393         	|
backward                           	|  0.0022204      	|200            	|  0.44409        	|  6.5991         	|
on_train_batch_end                 	|  0.00035911     	|200            	|  0.071823       	|  1.0673         	|
training_batch_to_device           	|  0.00030514     	|200            	|  0.061029       	|  0.90688        	|
on_batch_start                     	|  0.00011353     	|200            	|  0.022706       	|  0.33741        	|
on_train_batch_start               	|  6.4297e-05     	|200            	|  0.012859       	|  0.19109        	|
zero_grad                          	|  0.00012045     	|100            	|  0.012045       	|  0.17899        	|
on_batch_end                       	|  1.159e-05      	|200            	|  0.0023179      	|  0.034444       	|
on_after_backward                  	|  1.1245e-05     	|200            	|  0.0022489      	|  0.033419       	|
on_before_backward                 	|  8.4479e-06     	|200            	|  0.0016896      	|  0.025107       	|
training_step_end                  	|  6.7304e-06     	|200            	|  0.0013461      	|  0.020003       	|
on_before_zero_grad                	|  9.0478e-06     	|100            	|  0.00090478     	|  0.013445       	|
on_before_optimizer_step           	|  7.5848e-06     	|100            	|  0.00075848     	|  0.011271       	|
train_dataloader                   	|  0.00023298     	|1              	|  0.00023298     	|  0.003462       	|
configure_optimizers               	|  0.00013219     	|1              	|  0.00013219     	|  0.0019643      	|
on_before_accelerator_backend_setup	|  1.8681e-05     	|1              	|  1.8681e-05     	|  0.0002776      	|
on_train_start                     	|  1.811e-05      	|1              	|  1.811e-05      	|  0.00026911     	|
on_configure_sharded_model         	|  1.3581e-05     	|1              	|  1.3581e-05     	|  0.00020181     	|
on_pretrain_routine_start          	|  1.3277e-05     	|1              	|  1.3277e-05     	|  0.0001973      	|
configure_callbacks                	|  1.1702e-05     	|1              	|  1.1702e-05     	|  0.00017389     	|
on_train_epoch_end                 	|  1.0525e-05     	|1              	|  1.0525e-05     	|  0.0001564      	|
on_epoch_start                     	|  1.0454e-05     	|1              	|  1.0454e-05     	|  0.00015535     	|
teardown                           	|  1.0155e-05     	|1              	|  1.0155e-05     	|  0.0001509      	|
setup                              	|  9.745e-06      	|1              	|  9.745e-06      	|  0.00014481     	|
on_train_end                       	|  9.664e-06      	|1              	|  9.664e-06      	|  0.00014361     	|
on_pretrain_routine_end            	|  8.504e-06      	|1              	|  8.504e-06      	|  0.00012637     	|
on_epoch_end                       	|  8.327e-06      	|1              	|  8.327e-06      	|  0.00012374     	|
on_train_epoch_start               	|  7.658e-06      	|1              	|  7.658e-06      	|  0.0001138      	|
prepare_data                       	|  6.506e-06      	|1              	|  6.506e-06      	|  9.6679e-05     	|
on_train_dataloader                	|  6.493e-06      	|1              	|  6.493e-06      	|  9.6485e-05     	|
configure_sharded_model            	|  6.389e-06      	|1              	|  6.389e-06      	|  9.494e-05      	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  38.326         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  18.69          	|2              	|  37.379         	|  97.531         	|
run_training_batch                 	|  0.022829       	|1161           	|  26.504         	|  69.155         	|
training_step_and_backward         	|  0.012977       	|1161           	|  15.067         	|  39.312         	|
model_forward                      	|  0.010668       	|1161           	|  12.385         	|  32.317         	|
training_step                      	|  0.010497       	|1161           	|  12.187         	|  31.799         	|
optimizer_step_with_closure_0      	|  0.013609       	|581            	|  7.9066         	|  20.63          	|
get_train_batch                    	|  0.0067115      	|1163           	|  7.8055         	|  20.366         	|
fetch_next_train_batch             	|  0.0066933      	|1163           	|  7.7844         	|  20.311         	|
backward                           	|  0.0022157      	|1161           	|  2.5724         	|  6.7121         	|
on_train_batch_end                 	|  0.0011204      	|1161           	|  1.3008         	|  3.3941         	|
on_train_epoch_end                 	|  0.24744        	|2              	|  0.49488        	|  1.2912         	|
training_batch_to_device           	|  0.0003222      	|1161           	|  0.37408        	|  0.97605        	|
on_train_batch_start               	|  0.0002254      	|1161           	|  0.26168        	|  0.6828         	|
zero_grad                          	|  0.0001375      	|581            	|  0.079885       	|  0.20844        	|
on_batch_start                     	|  4.7147e-05     	|1161           	|  0.054737       	|  0.14282        	|
on_train_epoch_start               	|  0.026486       	|2              	|  0.052971       	|  0.13821        	|
on_train_end                       	|  0.018228       	|2              	|  0.036457       	|  0.095124       	|
on_train_start                     	|  0.016197       	|2              	|  0.032395       	|  0.084525       	|
on_batch_end                       	|  2.0329e-05     	|1161           	|  0.023602       	|  0.061584       	|
on_after_backward                  	|  1.8249e-05     	|1161           	|  0.021187       	|  0.055281       	|
on_before_accelerator_backend_setup	|  0.010493       	|2              	|  0.020987       	|  0.054759       	|
on_before_backward                 	|  1.6906e-05     	|1161           	|  0.019628       	|  0.051214       	|
on_before_zero_grad                	|  1.8449e-05     	|581            	|  0.010719       	|  0.027967       	|
on_before_optimizer_step           	|  1.5721e-05     	|581            	|  0.0091338      	|  0.023832       	|
training_step_end                  	|  6.9175e-06     	|1161           	|  0.0080312      	|  0.020955       	|
on_pretrain_routine_start          	|  0.0013344      	|2              	|  0.0026688      	|  0.0069634      	|
train_dataloader                   	|  0.00034505     	|2              	|  0.00069009     	|  0.0018006      	|
configure_optimizers               	|  0.00011839     	|2              	|  0.00023677     	|  0.00061779     	|
on_fit_start                       	|  6.1619e-05     	|1              	|  6.1619e-05     	|  0.00016078     	|
on_pretrain_routine_end            	|  2.9002e-05     	|2              	|  5.8003e-05     	|  0.00015134     	|
on_epoch_start                     	|  1.9471e-05     	|2              	|  3.8941e-05     	|  0.00010161     	|
on_configure_sharded_model         	|  1.8912e-05     	|2              	|  3.7824e-05     	|  9.8691e-05     	|
on_epoch_end                       	|  1.8315e-05     	|2              	|  3.6629e-05     	|  9.5573e-05     	|
setup                              	|  1.5776e-05     	|2              	|  3.1552e-05     	|  8.2326e-05     	|
teardown                           	|  1.5445e-05     	|2              	|  3.0889e-05     	|  8.0596e-05     	|
on_fit_end                         	|  2.4399e-05     	|1              	|  2.4399e-05     	|  6.3663e-05     	|
configure_callbacks                	|  1.0443e-05     	|2              	|  2.0886e-05     	|  5.4496e-05     	|
on_train_dataloader                	|  9.011e-06      	|2              	|  1.8022e-05     	|  4.7023e-05     	|
configure_sharded_model            	|  6.4745e-06     	|2              	|  1.2949e-05     	|  3.3787e-05     	|
prepare_data                       	|  6.171e-06      	|2              	|  1.2342e-05     	|  3.2203e-05     	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  23.97          	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  16.947         	|1              	|  16.947         	|  70.701         	|
run_training_batch                 	|  0.15051        	|100            	|  15.051         	|  62.79          	|
training_step_and_backward         	|  0.092057       	|100            	|  9.2057         	|  38.405         	|
model_forward                      	|  0.088645       	|100            	|  8.8645         	|  36.982         	|
training_step                      	|  0.088458       	|100            	|  8.8458         	|  36.904         	|
optimizer_step_with_closure_0      	|  0.09246        	|50             	|  4.623          	|  19.287         	|
get_train_batch                    	|  0.016577       	|101            	|  1.6743         	|  6.9848         	|
fetch_next_train_batch             	|  0.016552       	|101            	|  1.6718         	|  6.9744         	|
backward                           	|  0.0033142      	|100            	|  0.33142        	|  1.3827         	|
on_train_batch_end                 	|  0.00078204     	|100            	|  0.078204       	|  0.32626        	|
training_batch_to_device           	|  0.00059719     	|100            	|  0.059719       	|  0.24914        	|
on_batch_start                     	|  0.0002183      	|100            	|  0.02183        	|  0.091073       	|
on_train_batch_start               	|  8.0749e-05     	|100            	|  0.0080749      	|  0.033688       	|
zero_grad                          	|  0.00013977     	|50             	|  0.0069884      	|  0.029155       	|
on_batch_end                       	|  1.3258e-05     	|100            	|  0.0013258      	|  0.005531       	|
on_after_backward                  	|  1.081e-05      	|100            	|  0.001081       	|  0.0045096      	|
on_before_backward                 	|  8.9641e-06     	|100            	|  0.00089641     	|  0.0037397      	|
training_step_end                  	|  7.8154e-06     	|100            	|  0.00078154     	|  0.0032605      	|
on_before_zero_grad                	|  9.747e-06      	|50             	|  0.00048735     	|  0.0020332      	|
on_before_optimizer_step           	|  9.6887e-06     	|50             	|  0.00048443     	|  0.002021       	|
train_dataloader                   	|  0.00032436     	|1              	|  0.00032436     	|  0.0013532      	|
configure_optimizers               	|  0.00020061     	|1              	|  0.00020061     	|  0.00083692     	|
on_train_start                     	|  2.5051e-05     	|1              	|  2.5051e-05     	|  0.00010451     	|
on_before_accelerator_backend_setup	|  2.4397e-05     	|1              	|  2.4397e-05     	|  0.00010178     	|
on_pretrain_routine_start          	|  2.0923e-05     	|1              	|  2.0923e-05     	|  8.7288e-05     	|
on_configure_sharded_model         	|  1.7066e-05     	|1              	|  1.7066e-05     	|  7.1197e-05     	|
on_train_epoch_end                 	|  1.5785e-05     	|1              	|  1.5785e-05     	|  6.5853e-05     	|
teardown                           	|  1.3045e-05     	|1              	|  1.3045e-05     	|  5.4422e-05     	|
on_pretrain_routine_end            	|  1.2495e-05     	|1              	|  1.2495e-05     	|  5.2128e-05     	|
setup                              	|  1.211e-05      	|1              	|  1.211e-05      	|  5.0522e-05     	|
configure_callbacks                	|  1.2045e-05     	|1              	|  1.2045e-05     	|  5.025e-05      	|
on_train_end                       	|  1.1303e-05     	|1              	|  1.1303e-05     	|  4.7155e-05     	|
on_epoch_start                     	|  1.0921e-05     	|1              	|  1.0921e-05     	|  4.5561e-05     	|
on_epoch_end                       	|  9.608e-06      	|1              	|  9.608e-06      	|  4.0083e-05     	|
on_train_epoch_start               	|  7.105e-06      	|1              	|  7.105e-06      	|  2.9641e-05     	|
prepare_data                       	|  7.011e-06      	|1              	|  7.011e-06      	|  2.9249e-05     	|
configure_sharded_model            	|  7.005e-06      	|1              	|  7.005e-06      	|  2.9224e-05     	|
on_train_dataloader                	|  6.807e-06      	|1              	|  6.807e-06      	|  2.8398e-05     	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  41.86          	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  17.222         	|2              	|  34.445         	|  82.286         	|
run_training_batch                 	|  0.15044        	|200            	|  30.089         	|  71.88          	|
training_step_and_backward         	|  0.091792       	|200            	|  18.358         	|  43.856         	|
model_forward                      	|  0.088602       	|200            	|  17.72          	|  42.333         	|
training_step                      	|  0.088416       	|200            	|  17.683         	|  42.244         	|
optimizer_step_with_closure_0      	|  0.092281       	|100            	|  9.2281         	|  22.045         	|
get_train_batch                    	|  0.016137       	|202            	|  3.2597         	|  7.7871         	|
fetch_next_train_batch             	|  0.016113       	|202            	|  3.2548         	|  7.7755         	|
backward                           	|  0.0030894      	|200            	|  0.61788        	|  1.4761         	|
on_train_epoch_end                 	|  0.24641        	|2              	|  0.49281        	|  1.1773         	|
on_train_batch_end                 	|  0.0013532      	|200            	|  0.27064        	|  0.64654        	|
training_batch_to_device           	|  0.00059475     	|200            	|  0.11895        	|  0.28416        	|
on_train_epoch_start               	|  0.021242       	|2              	|  0.042484       	|  0.10149        	|
on_train_batch_start               	|  0.00019908     	|200            	|  0.039816       	|  0.095118       	|
on_batch_start                     	|  0.00013036     	|200            	|  0.026072       	|  0.062284       	|
on_train_start                     	|  0.012469       	|2              	|  0.024939       	|  0.059577       	|
on_before_accelerator_backend_setup	|  0.01029        	|2              	|  0.02058        	|  0.049165       	|
zero_grad                          	|  0.00014592     	|100            	|  0.014592       	|  0.034859       	|
on_train_end                       	|  0.0048801      	|2              	|  0.0097603      	|  0.023316       	|
on_batch_end                       	|  1.7667e-05     	|200            	|  0.0035334      	|  0.008441       	|
on_after_backward                  	|  1.5268e-05     	|200            	|  0.0030537      	|  0.0072949      	|
on_before_backward                 	|  1.3937e-05     	|200            	|  0.0027875      	|  0.0066591      	|
on_pretrain_routine_start          	|  0.00098702     	|2              	|  0.001974       	|  0.0047158      	|
on_before_zero_grad                	|  1.5521e-05     	|100            	|  0.0015521      	|  0.0037079      	|
training_step_end                  	|  7.6657e-06     	|200            	|  0.0015331      	|  0.0036625      	|
on_before_optimizer_step           	|  1.4101e-05     	|100            	|  0.0014101      	|  0.0033686      	|
train_dataloader                   	|  0.0006461      	|2              	|  0.0012922      	|  0.003087       	|
configure_optimizers               	|  0.00015941     	|2              	|  0.00031883     	|  0.00076165     	|
on_fit_start                       	|  7.4669e-05     	|1              	|  7.4669e-05     	|  0.00017838     	|
on_pretrain_routine_end            	|  3.2725e-05     	|2              	|  6.5451e-05     	|  0.00015636     	|
on_configure_sharded_model         	|  2.0796e-05     	|2              	|  4.1592e-05     	|  9.936e-05      	|
setup                              	|  1.9315e-05     	|2              	|  3.8629e-05     	|  9.2281e-05     	|
on_epoch_end                       	|  1.7859e-05     	|2              	|  3.5718e-05     	|  8.5327e-05     	|
on_epoch_start                     	|  1.6313e-05     	|2              	|  3.2626e-05     	|  7.7941e-05     	|
teardown                           	|  1.5498e-05     	|2              	|  3.0996e-05     	|  7.4047e-05     	|
on_train_dataloader                	|  1.4258e-05     	|2              	|  2.8517e-05     	|  6.8125e-05     	|
on_fit_end                         	|  2.6433e-05     	|1              	|  2.6433e-05     	|  6.3146e-05     	|
configure_callbacks                	|  1.0883e-05     	|2              	|  2.1766e-05     	|  5.1997e-05     	|
configure_sharded_model            	|  7.3685e-06     	|2              	|  1.4737e-05     	|  3.5205e-05     	|
prepare_data                       	|  6.5105e-06     	|2              	|  1.3021e-05     	|  3.1106e-05     	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  35.471         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  17.384         	|2              	|  34.767         	|  98.017         	|
run_training_batch                 	|  0.15033        	|200            	|  30.066         	|  84.764         	|
training_step_and_backward         	|  0.091083       	|200            	|  18.217         	|  51.357         	|
model_forward                      	|  0.088662       	|200            	|  17.732         	|  49.992         	|
training_step                      	|  0.088462       	|200            	|  17.692         	|  49.879         	|
optimizer_step_with_closure_0      	|  0.091738       	|100            	|  9.1738         	|  25.863         	|
get_train_batch                    	|  0.021043       	|202            	|  4.2507         	|  11.984         	|
fetch_next_train_batch             	|  0.021017       	|202            	|  4.2455         	|  11.969         	|
backward                           	|  0.0023163      	|200            	|  0.46325        	|  1.306          	|
on_train_batch_end                 	|  0.00083055     	|200            	|  0.16611        	|  0.46831        	|
training_batch_to_device           	|  0.00063312     	|200            	|  0.12662        	|  0.35699        	|
on_batch_start                     	|  0.00012872     	|200            	|  0.025744       	|  0.07258        	|
on_train_batch_start               	|  8.4133e-05     	|200            	|  0.016827       	|  0.047438       	|
zero_grad                          	|  0.00015096     	|100            	|  0.015096       	|  0.04256        	|
on_batch_end                       	|  1.3662e-05     	|200            	|  0.0027323      	|  0.0077031      	|
on_after_backward                  	|  1.1934e-05     	|200            	|  0.0023869      	|  0.0067292      	|
on_before_backward                 	|  9.8985e-06     	|200            	|  0.0019797      	|  0.0055812      	|
training_step_end                  	|  8.266e-06      	|200            	|  0.0016532      	|  0.0046608      	|
train_dataloader                   	|  0.0013368      	|1              	|  0.0013368      	|  0.0037686      	|
on_before_zero_grad                	|  1.084e-05      	|100            	|  0.001084       	|  0.0030561      	|
on_before_optimizer_step           	|  9.6116e-06     	|100            	|  0.00096116     	|  0.0027097      	|
configure_optimizers               	|  0.00014236     	|1              	|  0.00014236     	|  0.00040134     	|
on_train_epoch_end                 	|  1.4513e-05     	|2              	|  2.9027e-05     	|  8.1834e-05     	|
on_train_start                     	|  2.1853e-05     	|1              	|  2.1853e-05     	|  6.1609e-05     	|
on_before_accelerator_backend_setup	|  2.1464e-05     	|1              	|  2.1464e-05     	|  6.0512e-05     	|
on_epoch_start                     	|  1.04e-05       	|2              	|  2.08e-05       	|  5.864e-05      	|
on_epoch_end                       	|  9.9515e-06     	|2              	|  1.9903e-05     	|  5.6111e-05     	|
configure_callbacks                	|  1.8877e-05     	|1              	|  1.8877e-05     	|  5.3219e-05     	|
on_pretrain_routine_start          	|  1.6133e-05     	|1              	|  1.6133e-05     	|  4.5483e-05     	|
on_train_epoch_start               	|  7.2355e-06     	|2              	|  1.4471e-05     	|  4.0797e-05     	|
teardown                           	|  1.3779e-05     	|1              	|  1.3779e-05     	|  3.8846e-05     	|
on_configure_sharded_model         	|  1.3204e-05     	|1              	|  1.3204e-05     	|  3.7225e-05     	|
on_train_end                       	|  1.22e-05       	|1              	|  1.22e-05       	|  3.4395e-05     	|
setup                              	|  9.84e-06       	|1              	|  9.84e-06       	|  2.7741e-05     	|
on_pretrain_routine_end            	|  8.625e-06      	|1              	|  8.625e-06      	|  2.4316e-05     	|
prepare_data                       	|  8.311e-06      	|1              	|  8.311e-06      	|  2.3431e-05     	|
configure_sharded_model            	|  6.939e-06      	|1              	|  6.939e-06      	|  1.9563e-05     	|
on_train_dataloader                	|  6.538e-06      	|1              	|  6.538e-06      	|  1.8432e-05     	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  218.02         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  18.072         	|12             	|  216.86         	|  99.469         	|
run_training_batch                 	|  0.14948        	|1200           	|  179.37         	|  82.275         	|
training_step_and_backward         	|  0.091          	|1200           	|  109.2          	|  50.088         	|
model_forward                      	|  0.088656       	|1200           	|  106.39         	|  48.798         	|
training_step                      	|  0.088456       	|1200           	|  106.15         	|  48.688         	|
optimizer_step_with_closure_0      	|  0.091806       	|328            	|  30.112         	|  13.812         	|
get_train_batch                    	|  0.022868       	|1212           	|  27.716         	|  12.713         	|
fetch_next_train_batch             	|  0.022843       	|1212           	|  27.685         	|  12.699         	|
on_train_epoch_end                 	|  0.44413        	|12             	|  5.3295         	|  2.4446         	|
backward                           	|  0.002272       	|1200           	|  2.7264         	|  1.2506         	|
on_train_batch_end                 	|  0.0018459      	|1200           	|  2.2151         	|  1.016          	|
training_batch_to_device           	|  0.00063952     	|1200           	|  0.76742        	|  0.352          	|
on_train_epoch_start               	|  0.031666       	|12             	|  0.38           	|  0.1743         	|
on_train_batch_start               	|  0.00028863     	|1200           	|  0.34636        	|  0.15887        	|
on_batch_start                     	|  5.8757e-05     	|1200           	|  0.070508       	|  0.032341       	|
zero_grad                          	|  0.00016274     	|328            	|  0.053379       	|  0.024484       	|
on_train_start                     	|  0.021942       	|2              	|  0.043884       	|  0.020129       	|
on_before_accelerator_backend_setup	|  0.018699       	|2              	|  0.037399       	|  0.017154       	|
on_batch_end                       	|  2.1927e-05     	|1200           	|  0.026312       	|  0.012069       	|
on_after_backward                  	|  2.0707e-05     	|1200           	|  0.024849       	|  0.011398       	|
on_before_backward                 	|  1.8861e-05     	|1200           	|  0.022633       	|  0.010381       	|
on_train_end                       	|  0.0052194      	|2              	|  0.010439       	|  0.0047881      	|
training_step_end                  	|  8.31e-06       	|1200           	|  0.009972       	|  0.004574       	|
on_before_zero_grad                	|  1.8348e-05     	|328            	|  0.006018       	|  0.0027604      	|
on_before_optimizer_step           	|  1.7015e-05     	|328            	|  0.0055808      	|  0.0025598      	|
on_pretrain_routine_start          	|  0.0014605      	|2              	|  0.002921       	|  0.0013398      	|
train_dataloader                   	|  0.00092072     	|2              	|  0.0018414      	|  0.00084463     	|
configure_optimizers               	|  0.00017272     	|2              	|  0.00034544     	|  0.00015845     	|
on_epoch_end                       	|  2.4408e-05     	|12             	|  0.0002929      	|  0.00013435     	|
on_epoch_start                     	|  2.0258e-05     	|12             	|  0.00024309     	|  0.0001115      	|
on_fit_start                       	|  0.0001251      	|1              	|  0.0001251      	|  5.738e-05      	|
on_pretrain_routine_end            	|  2.482e-05      	|2              	|  4.9639e-05     	|  2.2768e-05     	|
on_configure_sharded_model         	|  2.2687e-05     	|2              	|  4.5374e-05     	|  2.0812e-05     	|
setup                              	|  2.242e-05      	|2              	|  4.484e-05      	|  2.0567e-05     	|
teardown                           	|  1.8216e-05     	|2              	|  3.6431e-05     	|  1.671e-05      	|
on_fit_end                         	|  3.1525e-05     	|1              	|  3.1525e-05     	|  1.446e-05      	|
configure_callbacks                	|  1.5673e-05     	|2              	|  3.1345e-05     	|  1.4377e-05     	|
on_train_dataloader                	|  9.9785e-06     	|2              	|  1.9957e-05     	|  9.1539e-06     	|
configure_sharded_model            	|  8.899e-06      	|2              	|  1.7798e-05     	|  8.1636e-06     	|
prepare_data                       	|  8.5215e-06     	|2              	|  1.7043e-05     	|  7.8173e-06     	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  34.465         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  16.978         	|2              	|  33.956         	|  98.524         	|
run_training_batch                 	|  0.15048        	|200            	|  30.096         	|  87.324         	|
training_step_and_backward         	|  0.091474       	|200            	|  18.295         	|  53.083         	|
model_forward                      	|  0.088662       	|200            	|  17.732         	|  51.451         	|
training_step                      	|  0.088449       	|200            	|  17.69          	|  51.328         	|
optimizer_step_with_closure_0      	|  0.092217       	|100            	|  9.2217         	|  26.757         	|
get_train_batch                    	|  0.016839       	|202            	|  3.4015         	|  9.8696         	|
fetch_next_train_batch             	|  0.016815       	|202            	|  3.3966         	|  9.8552         	|
backward                           	|  0.0026993      	|200            	|  0.53985        	|  1.5664         	|
on_train_batch_end                 	|  0.0008679      	|200            	|  0.17358        	|  0.50364        	|
training_batch_to_device           	|  0.00064543     	|200            	|  0.12909        	|  0.37454        	|
setup                              	|  0.11203        	|1              	|  0.11203        	|  0.32507        	|
on_batch_start                     	|  0.00013439     	|200            	|  0.026878       	|  0.077987       	|
zero_grad                          	|  0.00016825     	|100            	|  0.016825       	|  0.048818       	|
on_train_batch_start               	|  7.672e-05      	|200            	|  0.015344       	|  0.044521       	|
on_batch_end                       	|  1.2919e-05     	|200            	|  0.0025839      	|  0.0074972      	|
on_before_backward                 	|  1.1227e-05     	|200            	|  0.0022454      	|  0.0065151      	|
on_after_backward                  	|  1.1068e-05     	|200            	|  0.0022136      	|  0.0064227      	|
training_step_end                  	|  8.1169e-06     	|200            	|  0.0016234      	|  0.0047103      	|
on_before_zero_grad                	|  1.1105e-05     	|100            	|  0.0011105      	|  0.0032221      	|
on_before_optimizer_step           	|  9.3549e-06     	|100            	|  0.00093549     	|  0.0027144      	|
train_dataloader                   	|  0.00028055     	|1              	|  0.00028055     	|  0.00081403     	|
configure_optimizers               	|  0.00010591     	|1              	|  0.00010591     	|  0.00030731     	|
on_train_start                     	|  4.0924e-05     	|1              	|  4.0924e-05     	|  0.00011874     	|
on_train_epoch_end                 	|  1.3646e-05     	|2              	|  2.7292e-05     	|  7.9188e-05     	|
on_epoch_end                       	|  1.2337e-05     	|2              	|  2.4674e-05     	|  7.1592e-05     	|
on_epoch_start                     	|  1.0246e-05     	|2              	|  2.0492e-05     	|  5.9458e-05     	|
on_configure_sharded_model         	|  1.7883e-05     	|1              	|  1.7883e-05     	|  5.1888e-05     	|
teardown                           	|  1.6314e-05     	|1              	|  1.6314e-05     	|  4.7335e-05     	|
on_pretrain_routine_start          	|  1.5874e-05     	|1              	|  1.5874e-05     	|  4.6059e-05     	|
on_train_epoch_start               	|  7.6085e-06     	|2              	|  1.5217e-05     	|  4.4153e-05     	|
on_before_accelerator_backend_setup	|  1.4137e-05     	|1              	|  1.4137e-05     	|  4.1019e-05     	|
on_train_end                       	|  1.2495e-05     	|1              	|  1.2495e-05     	|  3.6255e-05     	|
configure_sharded_model            	|  1.0279e-05     	|1              	|  1.0279e-05     	|  2.9825e-05     	|
configure_callbacks                	|  9.349e-06      	|1              	|  9.349e-06      	|  2.7126e-05     	|
on_pretrain_routine_end            	|  8.546e-06      	|1              	|  8.546e-06      	|  2.4796e-05     	|
on_train_dataloader                	|  6.754e-06      	|1              	|  6.754e-06      	|  1.9597e-05     	|
prepare_data                       	|  6.095e-06      	|1              	|  6.095e-06      	|  1.7685e-05     	|
FIT Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  34.371         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  16.852         	|2              	|  33.705         	|  98.061         	|
run_training_batch                 	|  0.15021        	|200            	|  30.042         	|  87.405         	|
training_step_and_backward         	|  0.091115       	|200            	|  18.223         	|  53.018         	|
model_forward                      	|  0.088464       	|200            	|  17.693         	|  51.476         	|
training_step                      	|  0.08827        	|200            	|  17.654         	|  51.363         	|
optimizer_step_with_closure_0      	|  0.091727       	|100            	|  9.1727         	|  26.687         	|
get_train_batch                    	|  0.01597        	|202            	|  3.226          	|  9.3857         	|
fetch_next_train_batch             	|  0.015946       	|202            	|  3.2211         	|  9.3714         	|
backward                           	|  0.0025519      	|200            	|  0.51038        	|  1.4849         	|
on_train_batch_end                 	|  0.00081995     	|200            	|  0.16399        	|  0.47712        	|
training_batch_to_device           	|  0.00060852     	|200            	|  0.1217         	|  0.35409        	|
on_batch_start                     	|  0.00012361     	|200            	|  0.024722       	|  0.071928       	|
on_train_batch_start               	|  7.851e-05      	|200            	|  0.015702       	|  0.045684       	|
zero_grad                          	|  0.00014421     	|100            	|  0.014421       	|  0.041956       	|
on_batch_end                       	|  1.2565e-05     	|200            	|  0.0025129      	|  0.0073112      	|
on_after_backward                  	|  1.1036e-05     	|200            	|  0.0022072      	|  0.0064216      	|
on_before_backward                 	|  9.7973e-06     	|200            	|  0.0019595      	|  0.0057009      	|
training_step_end                  	|  8.0026e-06     	|200            	|  0.0016005      	|  0.0046566      	|
on_before_zero_grad                	|  1.0811e-05     	|100            	|  0.0010811      	|  0.0031452      	|
on_before_optimizer_step           	|  9.1355e-06     	|100            	|  0.00091355     	|  0.0026579      	|
train_dataloader                   	|  0.00027743     	|1              	|  0.00027743     	|  0.00080715     	|
configure_optimizers               	|  0.00010097     	|1              	|  0.00010097     	|  0.00029377     	|
on_train_epoch_end                 	|  1.3099e-05     	|2              	|  2.6198e-05     	|  7.6221e-05     	|
on_train_start                     	|  2.172e-05      	|1              	|  2.172e-05      	|  6.3193e-05     	|
on_epoch_end                       	|  1.0027e-05     	|2              	|  2.0054e-05     	|  5.8346e-05     	|
on_epoch_start                     	|  9.6015e-06     	|2              	|  1.9203e-05     	|  5.587e-05      	|
on_before_accelerator_backend_setup	|  1.7653e-05     	|1              	|  1.7653e-05     	|  5.136e-05      	|
on_configure_sharded_model         	|  1.6081e-05     	|1              	|  1.6081e-05     	|  4.6787e-05     	|
teardown                           	|  1.4753e-05     	|1              	|  1.4753e-05     	|  4.2923e-05     	|
on_pretrain_routine_start          	|  1.4749e-05     	|1              	|  1.4749e-05     	|  4.2911e-05     	|
on_train_epoch_start               	|  7.1605e-06     	|2              	|  1.4321e-05     	|  4.1666e-05     	|
configure_callbacks                	|  1.3384e-05     	|1              	|  1.3384e-05     	|  3.894e-05      	|
on_train_end                       	|  1.242e-05      	|1              	|  1.242e-05      	|  3.6135e-05     	|
setup                              	|  9.02e-06       	|1              	|  9.02e-06       	|  2.6243e-05     	|
on_pretrain_routine_end            	|  8.28e-06       	|1              	|  8.28e-06       	|  2.409e-05      	|
configure_sharded_model            	|  7.073e-06      	|1              	|  7.073e-06      	|  2.0578e-05     	|
prepare_data                       	|  6.522e-06      	|1              	|  6.522e-06      	|  1.8975e-05     	|
on_train_dataloader                	|  6.18e-06       	|1              	|  6.18e-06       	|  1.798e-05      	|
